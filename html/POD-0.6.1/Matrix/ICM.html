<head>
<!-- Generated by perlmod2www.pl -->
<title>
ICM documentation.
</title>
<link rel="stylesheet" type="text/css" href="../perl.css">
</head>
<body bgcolor="white">
<span id="modRootPath">TFBS::Matrix</span>
<span id="modName">ICM</span>
<div id="sep"></div>
<a name="TOP" id="TOP"></a>
<table id="daArea" width="100%"><tr><td id="daEntry" ><a href="#SUMMARY">Summary</a></td><td id="daEntry" ><a href="#libs">Included libraries</a></td><td id="daEntry" ><a href="#vardefs">Package variables</a></td><td id="daEntry" ><a href="#SYNOPSIS">Synopsis</a></td><td id="daEntry" ><a href="#DESCRIPTION">Description</a></td><td id="daEntry" ><a href="#General">General documentation</a></td><td id="daEntry" ><a href="#Methods">Methods</a></td></tr></table>
<div id="sep"></div>
<div id="descTitle">Summary</div>
<div id="descArea"><pre id="podParagraph">    
<B>TFBS::Matrix::ICM</B> - class for information content matrices of nucleotide
patterns</pre></div>
<div id="sep"></div>
<a name="vardefs" id="vardefs"></a><div id="descTitle">Package variables</div>
<div id="descArea"><div id="libEntry">No package variables defined.</div>
</div>
<div id="sep"></div>
<div id="descTitle">Included modules</div>
<div id="descArea"><div id="libEntry"><span id="use">Bio::Root::Root</span> </div>
<div id="libEntry"><span id="use">Bio::SeqIO</span> </div>
<div id="libEntry"><span id="use">File::Temp</span> qw /:POSIX/ </div>
<div id="libEntry"><span id="use">PDL</span></div>
<div id="libEntry"><span id="use"><a href="../Matrix.html">TFBS::Matrix</a></span> </div>
<div id="libEntry"><span id="use">strict</span></div>
</div>
<div id="sep"></div>
<a name="libs" id="libs"></a>
<div id="descTitle">Inherit</div>
<div id="descArea"><span id="isa">Bio::Root::Root</span> <span id="isa"><a href="../Matrix.html">TFBS::Matrix</a></span> </div>
<div id="sep"></div>
<a name="SYNOPSIS" id="SYNOPSIS"></a>
<div id="descTitle">Synopsis</div>
<div id="descArea"><div id="podItem">&nbsp;&nbsp;&nbsp;&nbsp;* creating a <B>TFBS::Matrix::ICM</B> object manually:</div>&nbsp;&nbsp;&nbsp;&nbsp;<div id="podItemEntry">    my $matrixref = [ [ 0.00, 0.30, 0.00, 0.00, 0.24, 0.00 ],<br />		      [ 0.00, 0.00, 0.00, 1.45, 0.42, 0.00 ],<br />		      [ 0.00, 0.89, 2.00, 0.00, 0.00, 0.00 ],<br />		      [ 0.00, 0.00, 0.00, 0.13, 0.06, 2.00 ]<br />		    ];	<br />    my $icm = <B>TFBS::Matrix::ICM</B>-&gt;new(-matrix =&gt; $matrixref,<br />				     -name   =&gt; &quot;MyProfile&quot;,<br />				     -ID     =&gt; &quot;M0001&quot;<br />				    );<br /> <br />    # or<br /> <br />    my $matrixstring = &lt;&lt;ENDMATRIX<br />    2.00   0.30   0.00   0.00   0.24   0.00<br />    0.00   0.00   0.00   1.45   0.42   0.00<br />    0.00   0.89   2.00   0.00   0.00   0.00<br />    0.00   0.00   0.00   0.13   0.06   2.00<br />    ENDMATRIX<br />    ;<br />    my $icm = <B>TFBS::Matrix::ICM</B>-&gt;new(-matrixstring =&gt; $matrixstring,<br />				     -name   	   =&gt; &quot;MyProfile&quot;,<br />				     -ID           =&gt; &quot;M0001&quot;<br />				    );<br /></div><br /><div id="podItem">&nbsp;&nbsp;&nbsp;&nbsp;* retrieving a TFBS::Matix::ICM object from a database:</div>&nbsp;&nbsp;&nbsp;&nbsp;(See documentation of individual TFBS::DB::* modules to learn<br />how to connect to different types of pattern databases and retrieve<br />TFBS::Matrix::* objects from them.)<br />    <br />    my $db_obj = TFBS::DB::JASPAR2-&gt;new<br />		    (-connect =&gt; [&quot;dbi:mysql:JASPAR2:myhost&quot;,<br />				  &quot;myusername&quot;, &quot;mypassword&quot;]);<br />    my $pfm = $db_obj-&gt;get_Matrix_by_ID(&quot;M0001&quot;, &quot;ICM&quot;);<br />    # or<br />    my $pfm = $db_obj-&gt;get_Matrix_by_name(&quot;MyProfile&quot;, &quot;ICM&quot;);<br /><div id="podItem">&nbsp;&nbsp;&nbsp;&nbsp;* retrieving list of individual <B>TFBS::Matrix::ICM</B> objects</div>&nbsp;&nbsp;&nbsp;&nbsp;(see decumentation of TFBS::MatrixSet to learn how to create <br />objects for storage and manipulation of multiple matrices)<br /><pre id="podParagraph">    my @icm_list = $matrixset->all_patterns(-sort_by=>"name");
</pre>&nbsp;&nbsp;&nbsp;&nbsp;* drawing a sequence logo<br />          <br />    $icm-&gt;draw_logo(-file=&gt;&quot;logo.png&quot;, <br />		    -full_scale =&gt;2.25,<br />		    -xsize=&gt;500,<br />		    -ysize =&gt;250, <br />		    -graph_title=&gt;&quot;C/EBPalpha binding site logo&quot;, <br />		    -x_title=&gt;&quot;position&quot;, <br />		    -y_title=&gt;&quot;bits&quot;);<br />
</div>
<div id="sep"></div>
<a name="DESCRIPTION" id="DESCRIPTION"></a>
<div id="descTitle">Description</div>
<div id="descArea"><B>TFBS::Matrix::ICM</B> is a class whose instances are objects representing<br />position weight matrices (PFMs). An ICM is normally calculated from a<br />raw position frequency matrix (see <a href="PFM.html" target="urlWin" id="podUrl"><b>TFBS::Matrix::PFM</b></a><br />for the explanation of position frequency matrices). For example, given<br />the following position frequency matrix,<br /><pre id="podParagraph">    A:[ 12     3     0     0     4     0  ]
    C:[  0     0     0    11     7     0  ]
    G:[  0     9    12     0     0     0  ]
    T:[  0     0     0     1     1    12  ]
</pre>the standard computational procedure is applied to convert it into the<br />following information content matrix:<br /><pre id="podParagraph">    A:[2.00  0.30  0.00  0.00  0.24  0.00]
    C:[0.00  0.00  0.00  1.45  0.42  0.00]
    G:[0.00  0.89  2.00  0.00  0.00  0.00]
    T:[0.00  0.00  0.00  0.13  0.06  2.00]
</pre>which contains the &quot;weights&quot; associated with the occurence of each<br />nucleotide at the given position in a pattern.<br />A TFBS::Matrix::PWM object is equipped with methods to search nucleotide<br />sequences and pairwise alignments of nucleotide sequences with the<br />pattern they represent, and return a set of sites in nucleotide<br />sequence (a TFBS::SiteSet object for single sequence search, and a<br />TFBS::SitePairSet for the alignment search).
</div>
<div id="sep"></div>
<a name="Methods" id="Methods"></a>
<div id="descTitle">Methods</div>
<table id="methIndArea" width="100%" cellspacing="0"><tr><td id="methIndEntry">BEGIN</td><td id="methIndEntry">&nbsp;</td><td id="methIndEntry"><a href="#BEGIN1">Code</a></td>
</tr>
<tr><td id="methIndEntry">DESTROY</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE1">Code</a></td></tr>
<tr><td id="methIndEntry">_check_ic_validity</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE2">Code</a></td></tr>
<tr><td id="methIndEntry">_draw_ps_logo</td><td id="methIndEntry"><a href="#POD1">Description</a></td><td id="methIndEntry"><a href="#CODE3">Code</a></td></tr>
<tr><td id="methIndEntry">_draw_svg_logo</td><td id="methIndEntry"><a href="#POD2">Description</a></td><td id="methIndEntry"><a href="#CODE4">Code</a></td></tr>
<tr><td id="methIndEntry">_png_draw_A</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE5">Code</a></td></tr>
<tr><td id="methIndEntry">_png_draw_C</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE6">Code</a></td></tr>
<tr><td id="methIndEntry">_png_draw_G</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE7">Code</a></td></tr>
<tr><td id="methIndEntry">_png_draw_T</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE8">Code</a></td></tr>
<tr><td id="methIndEntry">_svg_draw_A</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE9">Code</a></td></tr>
<tr><td id="methIndEntry">_svg_draw_C</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE10">Code</a></td></tr>
<tr><td id="methIndEntry">_svg_draw_G</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE11">Code</a></td></tr>
<tr><td id="methIndEntry">_svg_draw_T</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE12">Code</a></td></tr>
<tr><td id="methIndEntry">draw_logo</td><td id="methIndEntry"><a href="#POD3">Description</a></td><td id="methIndEntry"><a href="#CODE13">Code</a></td></tr>
<tr><td id="methIndEntry">new</td><td id="methIndEntry"><a href="#POD4">Description</a></td><td id="methIndEntry"><a href="#CODE14">Code</a></td></tr>
<tr><td id="methIndEntry">to_PWM</td><td id="methIndEntry"><a href="#POD5">Description</a></td><td id="methIndEntry"><a href="#CODE15">Code</a></td></tr>
<tr><td id="methIndEntry">total_ic</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE16">Code</a></td></tr>
</table>
<div id="sep"></div>
<a name="MethDesc" id="MethDesc"></a>
<div id="mainTitle">Methods description</div>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod__draw_ps_logo" id="_pod__draw_ps_logo"></a><a name="POD1" id="POD1"></a>_draw_ps_logo</td><td ><a href="#CODE3">code</a></td><td >&nbsp;&nbsp;&nbsp;&nbsp;</td><td ><a href="#POD2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : _draw_ps_logo 
 Usage   : my $postscript_string = $icm->_draw_ps_logo(%args)
           Internal method, should be accessed using draw_logo()
 Function: Draws a "sequence logo", a graphical representation
	   of a possibly degenerate fixed-width nucleotide
	   sequence pattern, from the information content matrix
 Returns : a postscript string;
	   if you only need the image file you can ignore it
 Args    : -file,       # the name of the output PNG image file
		        # OPTIONAL: default none
	   -xsize       # width of the image in pixels
		        # OPTIONAL: default 600
	   -ysize       # height of the image in pixels
		        # OPTIONAL: default 5/8 of -x_size
	   -full_scale  # the maximum value on the y-axis, in bits
		        # OPTIONAL: default 2.25
	   -graph_title,# the graph title
			# OPTIONAL: default none
	   -x_title,    # x-axis title; OPTIONAL: default none
	   -y_title     # y-axis title; OPTIONAL: default none</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod__draw_svg_logo " id="_pod__draw_svg_logo "></a><a name="POD2" id="POD2"></a>_draw_svg_logo </td><td ><a href="#CODE4">code</a></td><td ><a href="#POD1">prev</a></td><td ><a href="#POD3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_draw_logo" id="_pod_draw_logo"></a><a name="POD3" id="POD3"></a>draw_logo</td><td ><a href="#CODE13">code</a></td><td ><a href="#POD2">prev</a></td><td ><a href="#POD4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : draw_logo
 Usage   : my $gdImageObj = $icm->draw_logo(%args)
 Function: Draws a "sequence logo", a graphical representation
	   of a possibly degenerate fixed-width nucleotide
	   sequence pattern, from the information content matrix
 Returns : a GD::Image object;
	   if you only need the image file you can ignore it
 Args    : -file,       # the name of the output PNG image file
		        # OPTIONAL: default none
	   -xsize       # width of the image in pixels
		        # OPTIONAL: default 600
	   -ysize       # height of the image in pixels
		        # OPTIONAL: default 5/8 of -x_size
           -startpos    # start position in the logo for x axis
                        # OPTIONAL: default is 1
	   -margin      # size of image margins in pixels
		        # OPTIONAL: default 15% of -y_size
	   -full_scale  # the maximum value on the y-axis, in bits
		        # OPTIONAL: default 2.25
	   -graph_title,# the graph title
			# OPTIONAL: default none
	   -x_title,    # x-axis title; OPTIONAL: default none
	   -y_title     # y-axis title; OPTIONAL: default none
           -error_bars  # reference to an array of S.D. values for each column; OPTIONAL
           -ps          # if true, produces a postscript string instead of a GD::Image object
            -pdf          # if true AND the -file argumant is used, produces an output pdf file</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_new" id="_pod_new"></a><a name="POD4" id="POD4"></a>new</td><td ><a href="#CODE14">code</a></td><td ><a href="#POD3">prev</a></td><td ><a href="#POD5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : new
 Usage   : my $icm = <B>TFBS::Matrix::ICM</B>->new(%args)
 Function: constructor for the <B>TFBS::Matrix::ICM</B> object
 Returns : a new <B>TFBS::Matrix::ICM</B> object
 Args    : # you must specify either one of the following three:
 
	   -matrix,      # reference to an array of arrays of integers
	      #or
	   -matrixstring,# a string containing four lines
	                 # of tab- or space-delimited integers
	      #or
	   -matrixfile,  # the name of a file containing four lines
	                 # of tab- or space-delimited integers
	   #######
 
           -name,        # string, OPTIONAL
           -ID,          # string, OPTIONAL
           -class,       # string, OPTIONAL
           -tags         # an array reference, OPTIONAL</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_to_PWM" id="_pod_to_PWM"></a><a name="POD5" id="POD5"></a>to_PWM</td><td ><a href="#CODE15">code</a></td><td ><a href="#POD4">prev</a></td><td ><a href="#POD6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : to_PWM
 Usage   : my $pwm = $icm->to_PWM()
 Function: converts an  information content matrix (a <B>TFBS::Matrix::ICM</B> object)
	   to position weight matrix. At present it assumes uniform
	   background distribution of nucleotide frequencies.
 Returns : a new TFBS::Matrix::PWM object
 Args    : none; in the future releases, it should be able to accept
	   a user defined background probability of the four
	   nucleotides</pre></td></tr></table>
<div id="sep"></div>
<a name="MethCode" id="MethCode"></a>
<div id="mainTitle">Methods code</div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="BEGIN1" id="BEGIN1"></a>BEGIN</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="begin">BEGIN</span> {<pre>	<span id="comment"># this will not fail if the modules are nit available</span><br />	<span id="comment"># but only if the user tries to actually draw a logo</span><br />	<span id="perlKey">eval</span> <span id="dqStr">"use SVG"</span>;
	<span id="perlKey">eval</span> <span id="dqStr">"use GD"</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE1" id="CODE1"></a>DESTROY</td><td >description</td><td >prev</td><td ><a href="#CODE2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">DESTROY</span>
{<pre>    <span id="comment"># nothing</span><br /></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE2" id="CODE2"></a>_check_ic_validity</td><td >description</td><td ><a href="#CODE1">prev</a></td><td ><a href="#CODE3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_check_ic_validity</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="comment"># to do</span><br /></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE3" id="CODE3"></a>_draw_ps_logo</td><td ><a href="#POD1">description</a></td><td ><a href="#CODE2">prev</a></td><td ><a href="#CODE4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_draw_ps_logo</span>
{<pre> <span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">shift</span>;
 <span id="perlKey">my</span> <span id="var">%args</span> = <span id="braces">(</span>-xsize      =&gt; 600,
	     -full_scale =&gt; 2.25,
	     -graph_title=&gt; <span id="dqStr">""</span>,
	     -x_title    =&gt; <span id="dqStr">""</span>,
	     -y_title    =&gt; <span id="dqStr">""</span>,
	     <span id="var">@_</span><span id="braces">)</span>;   
    
    <span id="perlKey">my</span> <span id="var">$xsize</span>= <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-xsize'</span><span id="braces">}</span>;
    <span id="perlKey">my</span> <span id="var">$max_ysize</span>= <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-ysize'</span><span id="braces">}</span> ||<span id="perlFunc">int</span>  5* <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-xsize'</span><span id="braces">}</span>/8;<br />    <span id="perlKey">my</span> <span id="var">$ysize</span>=  <span id="var">$max_ysize</span>*<span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-full_scale'</span><span id="braces">}</span>-<span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-full_scale'</span><span id="braces">}</span>-2<span id="braces">)</span><span id="braces">)</span><span id="regExp">/</span><span id="var">$args</span>{'-full_scale'};<br />   
    <span id="perlKey">my</span> <span id="var">$x</span>=100; <span id="comment"># nternal, for placement on 'paper'</span><br />    <span id="perlKey">my</span> <span id="var">$y</span>=100; 
   
    <span id="perlKey">my</span> <span id="var">$out</span>= <span id="dqStr">"%!PS-Adobe-2.0 
%%Orientation: Portrait
%%Pages: 1
%%BoundingBox: 0 0 "</span>.<span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-xsize'</span><span id="braces">}</span>*1.2<span id="braces">)</span>.<span id="dqStr">" "</span>.<span id="braces">(</span> <span id="var">$max_ysize</span>*1.5<span id="braces">)</span>.<span id="dqStr">"
%%BeginSetup
%%EndSetup
%%Magnification: 1.0000
%%EndProlog
%%end
%%save
gsave\n"</span>;

    <span id="comment">#colors and correction definitions</span><br />    <span id="perlKey">my</span> <span id="var">%color</span>;
    <span id="var">$color</span><span id="braces">{</span><span id="sqStr">'black'</span><span id="braces">}</span>=<span id="dqStr">"0.000 0.000 0.000 setrgbcolor"</span>;
    <span id="var">$color</span><span id="braces">{</span><span id="sqStr">'A'</span><span id="braces">}</span>=<span id="dqStr">"0.000 1.000 0.000 setrgbcolor"</span>;
    <span id="var">$color</span><span id="braces">{</span><span id="sqStr">'C'</span><span id="braces">}</span>=<span id="dqStr">"0.000 0.000 1.000 setrgbcolor"</span>;
    <span id="var">$color</span><span id="braces">{</span><span id="sqStr">'G'</span><span id="braces">}</span>=<span id="dqStr">"1.000 0.860 0.000 setrgbcolor"</span>;
    <span id="var">$color</span><span id="braces">{</span><span id="sqStr">'T'</span><span id="braces">}</span>=<span id="dqStr">"1.000 0.000 0.000 setrgbcolor"</span>;

    <span id="perlKey">my</span> <span id="var">$fontsize</span>= <span id="perlFunc">int</span> <span id="var">$ysize</span>*0.68;
    <span id="perlKey">my</span> <span id="var">$fontwidth</span>=<span id="method">1</span><span id="method">.5*</span><span id="braces">(</span><span id="var">$xsize</span><span id="regExp">/</span><span id="var">$self</span>-&gt;length());<br />    <span id="perlKey">my</span> <span id="var">%w_correct</span>; <span id="comment"># correction of font widths</span><br />    <span id="var">$w_correct</span><span id="braces">{</span><span id="sqStr">'A'</span><span id="braces">}</span>=0.95;
    <span id="var">$w_correct</span><span id="braces">{</span><span id="sqStr">'T'</span><span id="braces">}</span>=1.05;
    <span id="var">$w_correct</span><span id="braces">{</span><span id="sqStr">'C'</span><span id="braces">}</span>=0.90;
    <span id="var">$w_correct</span><span id="braces">{</span><span id="sqStr">'G'</span><span id="braces">}</span>=0.90;
    
    <span id="perlKey">my</span> <span id="var">%y_next</span>;<span id="comment">#correction of font heights</span><br />    <span id="var">$y_next</span><span id="braces">{</span><span id="sqStr">'A'</span><span id="braces">}</span>=1;
    <span id="var">$y_next</span><span id="braces">{</span><span id="sqStr">'T'</span><span id="braces">}</span>=1;           
    <span id="var">$y_next</span><span id="braces">{</span><span id="sqStr">'C'</span><span id="braces">}</span>=0.94;
    <span id="var">$y_next</span><span id="braces">{</span><span id="sqStr">'G'</span><span id="braces">}</span>=0.94;

    <span id="perlKey">my</span> <span id="var">%y_correct</span>; <span id="comment">#correction of font bounding boxes</span><br />    <span id="var">$y_correct</span><span id="braces">{</span><span id="sqStr">'A'</span><span id="braces">}</span>=0;
    <span id="var">$y_correct</span><span id="braces">{</span><span id="sqStr">'C'</span><span id="braces">}</span>=0.035*<span id="var">$fontsize</span>;
    <span id="var">$y_correct</span><span id="braces">{</span><span id="sqStr">'G'</span><span id="braces">}</span>=0.035*<span id="var">$fontsize</span>;
    <span id="var">$y_correct</span><span id="braces">{</span><span id="sqStr">'T'</span><span id="braces">}</span>=0;
 
 
    <span id="comment">#define y axis,tickmarks and scaling</span><br /> 
    <span id="perlKey">my</span> <span id="var">$font</span>= <span id="var">$fontwidth</span>/5;  <br />    <span id="var">$out</span>.=<span id="dqStr">"newpath\n "</span>. <span id="braces">(</span><span id="var">$x</span>-10<span id="braces">)</span>.<span id="dqStr">" "</span>. <span id="braces">(</span><span id="var">$y</span>+2*<span id="var">$ysize</span><span id="regExp">/4 ).&quot; moveto\n&quot;. &quot;</span><span id="var">$x</span><span id="regExp"> &quot;. (</span><span id="var">$y</span><span id="regExp">+2*</span><span id="var">$ysize</span><span id="regExp">/</span>4 <span id="braces">)</span> .<span id="dqStr">" lineto\n stroke\n"</span>;
    <span id="var">$out</span>.= <span id="dqStr">"gsave\n/Times-Bold findfont <span id="var">$color</span>{black} [<span id="var">$font</span> 0 0 <span id="var">$font</span> 0 0] makefont setfont\n"</span>.<span id="braces">(</span><span id="var">$x</span>-20<span id="braces">)</span>. <span id="dqStr">" "</span>.<span id="braces">(</span> <span id="var">$y</span>+<span id="var">$ysize</span>/2).&quot;  moveto\n&quot;;<br />    <span id="var">$out</span>.=<span id="dqStr">" (1) show\n grestore\n"</span> ;
    <span id="var">$out</span>.=<span id="dqStr">"newpath\n "</span>. <span id="braces">(</span><span id="var">$x</span>-10<span id="braces">)</span>.<span id="dqStr">" "</span>. <span id="braces">(</span><span id="var">$y</span>+<span id="var">$ysize</span> <span id="braces">)</span>.<span id="dqStr">" moveto\n"</span>. <span id="dqStr">"<span id="var">$x</span> "</span>. <span id="braces">(</span><span id="var">$y</span>+<span id="var">$ysize</span><span id="braces">)</span> .<span id="dqStr">" lineto\n stroke\n"</span>;
    <span id="var">$out</span>.=<span id="dqStr">"newpath\n "</span>. <span id="braces">(</span><span id="var">$x</span>-10<span id="braces">)</span>.<span id="dqStr">" "</span>. <span id="braces">(</span><span id="var">$y</span>+<span id="var">$max_ysize</span> <span id="braces">)</span>.<span id="dqStr">" moveto\n"</span>. <span id="dqStr">"<span id="var">$x</span> "</span>. <span id="braces">(</span><span id="var">$y</span>+<span id="var">$max_ysize</span><span id="braces">)</span> .<span id="dqStr">" lineto\n stroke\n"</span>;
    <span id="var">$out</span>.= <span id="dqStr">"gsave\n/Times-Bold findfont <span id="var">$color</span>{black} [<span id="var">$font</span> 0 0 <span id="var">$font</span> 0 0] makefont setfont\n"</span>.<span id="braces">(</span><span id="var">$x</span>-20<span id="braces">)</span>. <span id="dqStr">" "</span>.<span id="braces">(</span> <span id="var">$y</span>+<span id="var">$ysize</span><span id="braces">)</span>.<span id="dqStr">"  moveto\n"</span>;
    <span id="var">$out</span>.=<span id="dqStr">" (2) show\n grestore\n"</span> ;
    <span id="var">$out</span>.=<span id="dqStr">"newpath\n <span id="var">$x</span> <span id="var">$y</span>  moveto\n"</span>. <span id="braces">(</span><span id="var">$x</span><span id="braces">)</span>. <span id="dqStr">" "</span>.<span id="braces">(</span><span id="var">$y</span>+<span id="var">$max_ysize</span><span id="braces">)</span> .<span id="dqStr">" lineto\n stroke\n"</span>;
    <span id="var">$out</span>.=<span id="dqStr">"newpath\n <span id="var">$x</span> <span id="var">$y</span>  moveto\n"</span>. <span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="braces">)</span>. <span id="dqStr">" "</span>.<span id="braces">(</span><span id="var">$y</span><span id="braces">)</span> .<span id="dqStr">" lineto\n stroke\n"</span>;
    
    
    <span id="comment"># draw titles if requested</span><br />    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-y_title'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
        <span id="var">$out</span>.= <span id="dqStr">"gsave\n/Times-Italic findfont <span id="var">$color</span>{black} [<span id="var">$font</span> 0 0 <span id="var">$font</span> 0 0] makefont setfont\n"</span>.<span id="braces">(</span><span id="var">$x</span>-40<span id="braces">)</span>. <span id="dqStr">" "</span>.<span id="braces">(</span> <span id="var">$y</span>+<span id="var">$ysize</span>/2).&quot;  moveto\n&quot;;<br />        <span id="var">$out</span>.=<span id="dqStr">" 90 rotate (<span id="var">$args</span>{'-y_title'}) show\n grestore\n"</span> ;
        <span id="braces">}</span>
    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-x_title'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
        <span id="var">$out</span>.= <span id="dqStr">"gsave\n/Times-Italic findfont <span id="var">$color</span>{black} [<span id="var">$font</span> 0 0 <span id="var">$font</span> 0 0] makefont setfont\n"</span>.<span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2.5). &quot; &quot;.( </span><span id="var">$y</span>*(0.60)).&quot;  moveto\n&quot;;<br />        <span id="var">$out</span>.=<span id="dqStr">" (<span id="var">$args</span>{'-x_title'}) show\n grestore\n"</span> ;
        <span id="braces">}</span>
    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-title'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
        <span id="var">$out</span>.= <span id="dqStr">"gsave\n/Times-Roman findfont <span id="var">$color</span>{black} ["</span>.<span id="braces">(</span><span id="var">$font</span>*2<span id="braces">)</span>.<span id="dqStr">" 0 0 <span id="var">$font</span> 0 0] makefont setfont\n"</span>.<span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/3). &quot; &quot;.( </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$max_ysize</span>*1.1).&quot;  moveto\n&quot;;<br />         
        <span id="var">$out</span>.=<span id="dqStr">" (<span id="var">$args</span>{'-title'}) show\n grestore\n"</span> ;
    <span id="braces">}</span>
    

    <span id="comment"># define x axis and x tickmarks</span><br />    <span id="perlKey">my</span> <span id="var">$col_width</span>=<span id="braces">(</span><span id="var">$xsize</span><span id="regExp">/</span><span id="var">$self</span><span id="regExp">-&gt;length()) -0.006*</span><span id="var">$xsize</span>;<br />    <span id="perlKey">my</span> <span id="var">$x_now</span>;

    <span id="perlKey">for</span><span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span>=1; <span id="var">$i</span>&lt;=<span id="var">$self</span>-&gt;<span id="perlFunc">length</span><span id="braces">(</span><span id="braces">)</span>; <span id="var">$i</span>++<span id="braces">)</span><span id="braces">{</span>
        <span id="var">$x_now</span>=<span id="var">$x</span>+<span id="var">$col_width</span>*<span id="var">$i</span>;    
        <span id="var">$out</span>.=<span id="dqStr">"newpath\n "</span>. <span id="braces">(</span><span id="var">$x_now</span><span id="braces">)</span>.<span id="dqStr">" "</span>. <span id="braces">(</span><span id="var">$y</span><span id="braces">)</span>.<span id="dqStr">" moveto\n"</span>. <span id="braces">(</span><span id="var">$x_now</span><span id="braces">)</span>.<span id="dqStr">" "</span>. <span id="braces">(</span><span id="var">$y</span>-<span id="var">$ysize</span>/20 ) .&quot; lineto\n stroke\n&quot;;<br />        <span id="var">$out</span>.= <span id="dqStr">"gsave\n/Times-Bold findfont <span id="var">$color</span>{black} [<span id="var">$font</span> 0 0 <span id="var">$font</span> 0 0] makefont setfont\n"</span>.<span id="braces">(</span><span id="var">$x_now</span>-<span id="var">$col_width</span><span id="regExp">/2). &quot; &quot;.( </span><span id="var">$y</span>-20).&quot;  moveto\n&quot;;<br />        <span id="var">$out</span>.=<span id="dqStr">" (<span id="var">$i</span>) show\n grestore\n"</span> ;
    <span id="braces">}</span>
    
    <span id="comment"># draw the logo</span><br />    <span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$i</span> <span id="braces">(</span>0..<span id="var">$self</span>-&gt;<span id="perlFunc">length</span><span id="braces">(</span><span id="braces">)</span>-1 <span id="braces">)</span>  <span id="braces">{</span> <span id="comment"># get the $i-th column of matrix</span><br />        
        <span id="perlKey">my</span> <span id="var">%ic</span>; 
	<span id="braces">(</span><span id="var">$ic</span><span id="braces">{</span>A<span id="braces">}</span>, <span id="var">$ic</span><span id="braces">{</span>C<span id="braces">}</span>, <span id="var">$ic</span><span id="braces">{</span>G<span id="braces">}</span>, <span id="var">$ic</span><span id="braces">{</span>T<span id="braces">}</span><span id="braces">)</span> = list <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">slice</span><span id="braces">(</span><span id="var">$i</span><span id="braces">)</span>;  
        <span id="perlKey">my</span> <span id="var">@draw_order</span> = <span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$ic</span><span id="braces">{</span><span id="var">$a</span><span id="braces">}</span>&lt;=&gt;<span id="var">$ic</span><span id="braces">{</span><span id="var">$b</span><span id="braces">}</span><span id="braces">}</span> <span id="perlFunc">qw</span><span id="braces">(</span>A C G T<span id="braces">)</span>;

        <span id="comment">#draw this position</span><br />        
        <span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$letter</span> <span id="braces">(</span><span id="var">@draw_order</span><span id="braces">)</span><span id="braces">{</span>
	    <span id="var">$ic</span><span id="braces">{</span><span id="var">$letter</span><span id="braces">}</span>=0.0000001 <span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$ic</span><span id="braces">{</span><span id="var">$letter</span><span id="braces">}</span>==0<span id="braces">)</span>; <span id="comment"># some interpretors do not uderstand size 0</span><br />            <span id="var">$out</span>.= <span id="dqStr">"gsave\n/Helvetica-Bold findfont   <span id="var">$color</span>{<span id="var">$letter</span>} ["</span>.<span id="var">$fontwidth</span>*<span id="var">$w_correct</span><span id="braces">{</span><span id="var">$letter</span><span id="braces">}</span>.<span id="dqStr">" 0 0 "</span>;
            <span id="var">$out</span>.= <span id="var">$ic</span><span id="braces">{</span><span id="var">$letter</span><span id="braces">}</span>*<span id="var">$fontsize</span>*<span id="var">$y_next</span><span id="braces">{</span><span id="var">$letter</span><span id="braces">}</span> ;
            <span id="var">$y</span>+=<span id="var">$y_correct</span><span id="braces">{</span><span id="var">$letter</span><span id="braces">}</span>*<span id="var">$ic</span><span id="braces">{</span><span id="var">$letter</span><span id="braces">}</span>; <span id="comment">#movement that isletter specific, due to bounding boxes</span><br />            <span id="var">$out</span>.= <span id="dqStr">" 0 0] makefont setfont\n<span id="var">$x</span>  <span id="var">$y</span>  moveto\n"</span>;       
            <span id="var">$out</span>.= <span id="dqStr">" (<span id="var">$letter</span>) show\n grestore\n"</span>  ;    
            <span id="var">$y</span>+=<span id="var">$fontsize</span>*<span id="var">$ic</span><span id="braces">{</span><span id="var">$letter</span><span id="braces">}</span>*0.75; <span id="comment">#ic content move</span><br />        <span id="braces">}</span>
        <span id="var">$x</span>+=<span id="var">$fontwidth</span>/1.6;<br />        <span id="var">$y</span>=100;

  <span id="braces">}</span>
    <span id="comment"># save as file if requested </span><br />    <span id="perlKey">if</span>  <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>  
	<span id="perlFunc">open</span> <span id="braces">(</span>PSFILE, <span id="dqStr">"&gt;"</span>.<span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span>
	    or <span id="var">$self</span>-&gt;<span id="method">throw</span><span id="braces">(</span><span id="dqStr">"Could not write to "</span>.<span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span>;
        <span id="perlFunc">print</span> PSFILE <span id="var">$out</span>;
	<span id="perlFunc">close</span> PSFILE;
    <span id="braces">}</span>
    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-pdf<span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
       
	<span id="perlFunc">system</span> <span id="dqStr">"ps2pdf <span id="var">$args</span>{-file} "</span>.<span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span>.<span id="dqStr">".pdf "</span>; 
        <span id="perlFunc">system</span> <span id="dqStr">" mv <span id="var">$args</span>{-file}.pdf <span id="var">$args</span>{-file}"</span>; 
    <span id="braces">}</span>
    
    
    
    
    <span id="perlKey">return</span> <span id="var">$out</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE4" id="CODE4"></a>_draw_svg_logo</td><td ><a href="#POD2">description</a></td><td ><a href="#CODE3">prev</a></td><td ><a href="#CODE5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_draw_svg_logo</span>
{<pre>		<span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">shift</span>;
 	<span id="perlKey">my</span> <span id="var">%args</span> = <span id="braces">(</span>-xsize      =&gt; 800,
	     -full_scale =&gt; 2.25,
	     -graph_title=&gt; <span id="dqStr">""</span>,
	     -x_title    =&gt; <span id="dqStr">""</span>,
	     -y_title    =&gt; <span id="dqStr">""</span>,
	     <span id="var">@_</span><span id="braces">)</span>;   
    
    <span id="perlKey">my</span> <span id="var">$max_ysize</span>= <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-ysize'</span><span id="braces">}</span> ||<span id="perlFunc">int</span>  5* <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-xsize'</span><span id="braces">}</span>/8;<br />    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$xsize</span>,<span id="var">$FULL_SCALE</span>, <span id="var">$x_title</span>, <span id="var">$y_title</span><span id="braces">)</span>   
	= <span id="var">@args</span><span id="braces">{</span><span id="perlFunc">qw</span><span id="braces">(</span>-xsize -full_scale -x_title y_title<span id="braces">)</span><span id="braces">}</span> ;

    <span id="perlKey">my</span> <span id="var">$PER_PIXEL_LINE</span> = 200;
    
    <span id="comment"># calculate other parameters if not specified</span><br />
    <span id="perlKey">my</span> <span id="var">$ysize</span>      = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-ysize<span id="braces">}</span> or <span id="var">$xsize</span>/1.6); <br />    <span id="perlKey">my</span> <span id="var">$line_width</span> = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-line_width<span id="braces">}</span> or <span id="var">$ysize</span><span id="regExp">/</span><span id="var">$PER_PIXEL_LINE</span>);<br />    <span id="comment"># remark (the line above): 1.6 is a standard screen x:y ratio</span><br />    <span id="perlKey">my</span> <span id="var">$margin</span>     = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-margin<span id="braces">}</span> or <span id="var">$ysize</span>*0.15<span id="braces">)</span>;

    
    
    <span id="perlKey">my</span> <span id="var">$image</span> = <span id="method">SVG</span><span id="method">->new</span><span id="braces">(</span>width=&gt;<span id="var">$xsize</span>, height=&gt;<span id="var">$ysize</span><span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">$white</span> = <span id="sqStr">'rgb(255,255,255)'</span>;
    <span id="perlKey">my</span> <span id="var">$black</span> = <span id="sqStr">'rgb(0,0,0)'</span>;
    <span id="perlKey">my</span> <span id="var">$motif_size</span> = <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">getdim</span><span id="braces">(</span>0<span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">$fontsize</span> = <span id="perlFunc">int</span> <span id="braces">(</span><span id="var">$ysize</span>/25);<br />	<span id="perlKey">my</span> <span id="var">$title_font</span> = <span id="braces">{</span>width=&gt;<span id="var">$fontsize</span>*1.5, height=&gt;<span id="var">$fontsize</span>*1.5<span id="braces">}</span>;
	<span id="perlKey">my</span> <span id="var">$font</span> = <span id="braces">{</span>width=&gt;<span id="var">$fontsize</span>, height=&gt;<span id="var">$fontsize</span><span id="braces">}</span>;

    <span id="comment"># WRITE LABELS AND TITLE</span><br />
    <span id="comment"># graph title   </span><br />    <span id="var">$image</span>-&gt;<span id="method">text</span><span id="braces">(</span>id=&gt;<span id="dqStr">"Title"</span>, 
    			<span id="sqStr">'font-size'</span>=&gt;<span id="var">$title_font</span>-&gt;<span id="braces">{</span>width<span id="braces">}</span>,
    			 x =&gt; <span id="var">$xsize</span><span id="regExp">/2,<br />    			 y =&gt; 0.6*</span><span id="var">$margin</span><span id="regExp">,<br />    			'text-anchor'=&gt;'middle'<br />    			)-&gt;cdata(</span><span id="var">$args</span>{-graph_title});<br />    <span id="comment"># x title</span><br />
    <span id="var">$image</span>-&gt;<span id="method">text</span><span id="braces">(</span>id=&gt;<span id="dqStr">"X_title"</span>, 
    			<span id="sqStr">'font-size'</span>=&gt;<span id="var">$font</span>-&gt;<span id="braces">{</span>width<span id="braces">}</span>,
    			 x =&gt; <span id="var">$xsize</span><span id="regExp">/2,<br />    			 y =&gt; </span><span id="var">$ysize</span><span id="regExp"> -0.3*</span><span id="var">$margin</span><span id="regExp">,<br />    			'text-anchor'=&gt;'middle'<br />    	)-&gt;cdata(</span><span id="var">$args</span>{-x_title});<br />	
	<span id="comment"># y title</span><br />	
    <span id="perlKey">my</span> <span id="var">$g</span> = <span id="var">$image</span>-&gt;<span id="method">group</span>;
    <span id="var">$g</span>-&gt;<span id="method">text</span><span id="braces">(</span>id=&gt;<span id="dqStr">"Y_title"</span>, 
    			 <span id="sqStr">'font-size'</span>=&gt;<span id="var">$font</span>-&gt;<span id="braces">{</span>width<span id="braces">}</span>,
    			 x =&gt; 0 ,
    			 <span id="sqStr">'text-anchor'</span>=&gt;<span id="sqStr">'middle'</span>,
    			 y =&gt; 0,
                 transform =&gt; <span id="sqStr">'rotate(-90) translate(-'</span>.<span id="braces">(</span><span id="var">$ysize</span><span id="regExp">/2).','.(</span><span id="var">$margin</span><span id="regExp">/</span>2<span id="braces">)</span>.<span id="sqStr">')'</span><span id="braces">)</span>-&gt;<span id="method">cdata</span><span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-y_title<span id="braces">}</span><span id="braces">)</span>;
    

    <span id="comment"># DRAW AXES</span><br />
    <span id="comment"># vertical: (top left to bottom right)</span><br />    <span id="var">$image</span>-&gt;<span id="method">rectangle</span><span id="braces">(</span>id =&gt; <span id="dqStr">"y_axis"</span>,
    				  style =&gt; <span id="braces">{</span>
                        		<span id="comment">#stroke =&gt; $black,</span><br />                        		fill   =&gt; <span id="var">$black</span>
                      			<span id="braces">}</span>,
                      x =&gt; <span id="var">$margin</span>-<span id="var">$line_width</span>,
                      y =&gt; <span id="var">$margin</span>,
                      width =&gt; <span id="var">$line_width</span>,
                      height =&gt; <span id="var">$ysize</span> -2*<span id="var">$margin</span>
                    <span id="braces">)</span>;
    <span id="comment">#$image-&gt;filledRectangle($margin-$line_width, $margin-$line_width, </span><br />    <span id="comment">#			 $margin-1, $ysize-$margin+$line_width, #</span><br />	<span id="comment">#		 $black);</span><br />    <span id="comment"># horizontal: (ditto)</span><br />    <span id="var">$image</span>-&gt;<span id="method">rectangle</span><span id="braces">(</span>id =&gt; <span id="dqStr">"x_axis"</span>,
    				  style =&gt; <span id="braces">{</span>
                        		<span id="comment">#stroke =&gt; $black,</span><br />                        		fill   =&gt; <span id="var">$black</span>
                      			<span id="braces">}</span>,
                      x =&gt; <span id="var">$margin</span>-<span id="var">$line_width</span>,
                      y =&gt; <span id="var">$ysize</span>-<span id="var">$margin</span>,
                      width =&gt; <span id="var">$xsize</span>-2*<span id="var">$margin</span>+<span id="var">$line_width</span>,
                      height =&gt; <span id="var">$line_width</span>
                    <span id="braces">)</span>;
    <span id="comment">#$image-&gt;filledRectangle($margin-$line_width, $ysize-$margin+1, </span><br />	<span id="comment">#		 $xsize-$margin+$line_width,$ysize-$margin+$line_width,</span><br />	<span id="comment">#		 $black);</span><br />
    <span id="comment"># DRAW VERTICAL TICKS AND LABELS</span><br />
    <span id="comment"># vertical axis (IC 1 and 2) </span><br />    <span id="perlKey">my</span> <span id="var">$ic_1</span> = <span id="braces">(</span><span id="var">$ysize</span> - 2* <span id="var">$margin</span><span id="braces">)</span> <span id="regExp">/ </span><span id="var">$FULL_SCALE</span>;<br />    <span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$i</span> <span id="braces">(</span>1..<span id="var">$FULL_SCALE</span><span id="braces">)</span>  <span id="braces">{</span>
    	<span id="var">$image</span>-&gt;<span id="method">rectangle</span><span id="braces">(</span>x  =&gt; <span id="var">$margin</span>-3*<span id="var">$line_width</span>, 
    					  y  =&gt; <span id="var">$ysize</span>-<span id="var">$margin</span> - <span id="var">$i</span>*<span id="var">$ic_1</span>,
    					  width =&gt; 3*<span id="var">$line_width</span>,
    					  height =&gt; <span id="var">$line_width</span>
    					  <span id="braces">)</span>;
    	<span id="var">$image</span>-&gt;<span id="method">text</span><span id="braces">(</span>x  =&gt; <span id="var">$margin</span>-5*<span id="var">$line_width</span> - <span id="var">$font</span>-&gt;<span id="braces">{</span>width<span id="braces">}</span>,
    				 y  =&gt; <span id="var">$ysize</span> - <span id="var">$margin</span> - <span id="var">$i</span>*<span id="var">$ic_1</span> +<span id="var">$font</span>-&gt;<span id="braces">{</span>height<span id="braces">}</span><span id="regExp">/2,<br />    				 'font-size'=&gt;</span><span id="var">$font</span><span id="regExp">-&gt;{width},<br />    				 'text-anchor'=&gt;&quot;right&quot;<br />    				 )-&gt;cdata(</span><span id="var">$i</span>);<br />    				 
    <span id="braces">}</span>
    
    <span id="comment"># DRAW HORIZONTAL TICKS AND LABELS, AND THE LOGO ITSELF </span><br />
    <span id="comment"># define function refs as hash elements</span><br />
    <span id="perlKey">my</span> <span id="var">%draw_letter</span> = <span id="braces">(</span> A =&gt;\&amp; _svg_draw_A,
						C =&gt;\&amp; _svg_draw_C,
						G =&gt;\&amp; _svg_draw_G,
						T =&gt;\&amp; _svg_draw_T  <span id="braces">)</span>;

    <span id="perlKey">my</span> <span id="var">$horiz_step</span> = <span id="braces">(</span><span id="var">$xsize</span> -2*<span id="var">$margin</span><span id="braces">)</span> <span id="regExp">/ </span><span id="var">$motif_size</span>;<br />
    <span id="comment">#this is to avoid clutter on X axis:</span><br />
    <span id="perlKey">my</span> <span id="var">$longest_label_length</span> = <span id="perlFunc">length</span><span id="braces">(</span><span id="dqStr">"<span id="var">$motif_size</span>"</span><span id="braces">)</span>;
    <span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">length</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span><span id="braces">)</span> &gt; <span id="var">$longest_label_length</span><span id="braces">)</span> <span id="braces">{</span>
      	<span id="var">$longest_label_length</span> = <span id="perlFunc">length</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span><span id="braces">)</span>; 
    <span id="braces">}</span>
    <span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">length</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span>+<span id="var">$motif_size</span><span id="braces">)</span> &gt; <span id="var">$longest_label_length</span><span id="braces">)</span> <span id="braces">{</span>
       	<span id="var">$longest_label_length</span> = <span id="perlFunc">length</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span>+<span id="var">$motif_size</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">my</span> <span id="var">$draw_every_nth_label</span> = <span id="perlFunc">int</span><span id="braces">(</span><span id="braces">(</span><span id="var">$longest_label_length</span>+0.25<span id="braces">)</span>*<span id="var">$font</span>-&gt;<span id="braces">{</span>width<span id="braces">}</span><span id="braces">)</span> <span id="regExp">/ </span><span id="var">$horiz_step</span> + 1;<br />    
    <span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$i</span> <span id="braces">(</span>0..<span id="var">$motif_size</span><span id="braces">)</span>  <span id="braces">{</span>
    	<span id="perlKey">my</span> <span id="var">$height</span> = 3*<span id="var">$line_width</span>;
    	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$i</span> and <span id="var">$i</span>==<span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span>*-1<span id="braces">)</span><span id="braces">{</span>
    		<span id="var">$height</span> = 5*<span id="var">$line_width</span>;
    	<span id="braces">}</span>
		<span id="var">$image</span>-&gt;<span id="method">rectangle</span><span id="braces">(</span>x  =&gt; <span id="var">$margin</span> + <span id="var">$i</span>*<span id="var">$horiz_step</span> -<span id="var">$line_width</span><span id="regExp">/2, <br />						  y  =&gt; </span><span id="var">$ysize</span><span id="regExp">-</span><span id="var">$margin</span><span id="regExp">,<br />						  width =&gt; </span><span id="var">$line_width</span><span id="regExp">,<br />						  height =&gt; </span><span id="var">$height</span><br />						  );<br />		<span id="perlKey">last</span> <span id="perlKey">if</span> <span id="var">$i</span>==<span id="var">$motif_size</span>;
	
		<span id="comment"># get the $i-th column of matrix</span><br />		<span id="perlKey">my</span> <span id="var">%ic</span>; 
		<span id="braces">(</span><span id="var">$ic</span><span id="braces">{</span>A<span id="braces">}</span>, <span id="var">$ic</span><span id="braces">{</span>C<span id="braces">}</span>, <span id="var">$ic</span><span id="braces">{</span>G<span id="braces">}</span>, <span id="var">$ic</span><span id="braces">{</span>T<span id="braces">}</span><span id="braces">)</span> = list <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">slice</span><span id="braces">(</span><span id="var">$i</span><span id="braces">)</span>;
	
		<span id="comment"># sort nucleotides by increasing information content</span><br />		<span id="perlKey">my</span> <span id="var">@draw_order</span> = <span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$ic</span><span id="braces">{</span><span id="var">$a</span><span id="braces">}</span>&lt;=&gt;<span id="var">$ic</span><span id="braces">{</span><span id="var">$b</span><span id="braces">}</span><span id="braces">}</span> <span id="perlFunc">qw</span><span id="braces">(</span>A C G T<span id="braces">)</span>;
	
		<span id="comment"># draw logo column</span><br />		<span id="perlKey">my</span> <span id="var">$xlettersize</span> = <span id="var">$horiz_step</span>*0.95;
		<span id="perlKey">my</span> <span id="var">$ybottom</span> = <span id="var">$ysize</span> - <span id="var">$margin</span>;
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$base</span> <span id="braces">(</span><span id="var">@draw_order</span><span id="braces">)</span>  <span id="braces">{</span>
		    <span id="perlKey">my</span> <span id="var">$ylettersize</span> = <span id="var">$ic</span><span id="braces">{</span><span id="var">$base</span><span id="braces">}</span>*<span id="var">$ic_1</span>;
		    <span id="perlKey">next</span> <span id="perlKey">if</span> <span id="var">$ylettersize</span> ==0;
	
		    <span id="comment"># draw letter</span><br />		    <span id="var">$draw_letter</span><span id="braces">{</span><span id="var">$base</span><span id="braces">}</span>-&gt;<span id="braces">(</span><span id="var">$image</span>,
					  			  <span id="var">$margin</span> + <span id="var">$i</span>*<span id="var">$horiz_step</span> + 0.025* <span id="var">$horiz_step</span>,
					  			  <span id="var">$ybottom</span> - <span id="var">$ylettersize</span>,
				  				  <span id="var">$xlettersize</span>, <span id="var">$ylettersize</span>, <span id="var">$white</span><span id="braces">)</span>;
		    <span id="var">$ybottom</span> = <span id="var">$ybottom</span> - <span id="var">$ylettersize</span>;
		<span id="braces">}</span>	    
	    
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-error_bars'</span><span id="braces">}</span> and <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-error_bars'</span><span id="braces">}</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="dqStr">"ARRAY"</span><span id="braces">)</span>  <span id="braces">{</span>
		    <span id="perlKey">my</span> <span id="var">$sd_pix</span>   = <span id="perlFunc">int</span><span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-error_bars'</span><span id="braces">}</span>-&gt;<span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>*<span id="var">$ic_1</span><span id="braces">)</span>;
		    <span id="perlKey">my</span> <span id="var">$yt</span>     = <span id="var">$ybottom</span> - <span id="var">$sd_pix</span>+1; 
		    <span id="perlKey">my</span> <span id="var">$yb</span>  = <span id="var">$ybottom</span> + <span id="var">$sd_pix</span>-1;
		    <span id="perlKey">my</span> <span id="var">$xpos</span>     = <span id="var">$margin</span> + <span id="braces">(</span><span id="var">$i</span>+0.5<span id="braces">)</span>*<span id="var">$horiz_step</span>;
		    <span id="perlKey">my</span> <span id="var">$half_width</span>;
		    
		    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$yb</span> &gt; <span id="var">$ysize</span>-<span id="var">$margin</span>+<span id="var">$line_width</span><span id="braces">)</span>  <span id="braces">{</span>
				<span id="var">$yb</span> = <span id="var">$ysize</span>-<span id="var">$margin</span>+<span id="var">$line_width</span>
			<span id="braces">}</span>
		    <span id="perlKey">else</span> <span id="braces">{</span>
				<span id="var">$image</span>-&gt;<span id="method">line</span><span id="braces">(</span>x1=&gt;<span id="var">$xpos</span> - <span id="var">$xlettersize</span><span id="regExp">/8, y1=&gt; </span><span id="var">$yb</span><span id="regExp">, <br />					    x2=&gt; </span><span id="var">$xpos</span><span id="regExp"> + </span><span id="var">$xlettersize</span><span id="regExp">/</span>8, y2=&gt;<span id="var">$yb</span>, stroke=&gt;<span id="var">$black</span>,
					    <span id="sqStr">'stroke-width'</span>=&gt;<span id="var">$line_width</span><span id="braces">)</span>;
		    <span id="braces">}</span>
		   	
		    <span id="var">$image</span>-&gt;<span id="method">line</span><span id="braces">(</span>x1=&gt;<span id="var">$xpos</span>, y1=&gt;<span id="var">$yt</span>, x2=&gt;<span id="var">$xpos</span>, y2=&gt;<span id="var">$yb</span>, stroke=&gt;<span id="var">$black</span>,
					    <span id="sqStr">'stroke-width'</span>=&gt;<span id="var">$line_width</span><span id="braces">)</span>;
		    <span id="var">$image</span>-&gt;<span id="method">line</span><span id="braces">(</span>x1=&gt;<span id="var">$xpos</span> - <span id="var">$line_width</span> , y1=&gt;<span id="var">$ybottom</span>, x2=&gt;<span id="var">$xpos</span>+<span id="var">$line_width</span>, y2=&gt;<span id="var">$ybottom</span>, stroke=&gt;<span id="var">$black</span>,
					    <span id="sqStr">'stroke-width'</span>=&gt;<span id="var">$line_width</span><span id="braces">)</span>;
		    <span id="var">$image</span>-&gt;<span id="method">line</span><span id="braces">(</span>x1=&gt;<span id="var">$xpos</span> - <span id="var">$xlettersize</span><span id="regExp">/8, y1=&gt;</span><span id="var">$yt</span><span id="regExp">, <br />				 x2=&gt;</span><span id="var">$xpos</span><span id="regExp"> + </span><span id="var">$xlettersize</span><span id="regExp">/</span>8, y2=&gt;<span id="var">$yt</span>, stroke=&gt;<span id="var">$black</span>,
					    <span id="sqStr">'stroke-width'</span>=&gt;<span id="var">$line_width</span><span id="braces">)</span>;
	    
    
       <span id="braces">}</span>
	
		<span id="comment"># print position number on x axis</span><br />        <span id="perlKey">my</span> <span id="var">$xlabel</span> = <span id="var">$i</span>+ <span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span>;
        <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span>&lt;0 and <span id="var">$xlabel</span>&gt;=0<span id="braces">)</span> <span id="braces">{</span>
               <span id="var">$xlabel</span> ++;
        <span id="braces">}</span>
       <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$xlabel</span> % <span id="var">$draw_every_nth_label</span> == 0<span id="braces">)</span> <span id="braces">{</span>
		   <span id="var">$image</span>-&gt;<span id="method">text</span><span id="braces">(</span>x  =&gt; <span id="var">$margin</span> + <span id="braces">(</span><span id="var">$i</span>+0.5<span id="braces">)</span>*<span id="var">$horiz_step</span> - <span id="var">$font</span>-&gt;<span id="braces">{</span>width<span id="braces">}</span><span id="regExp">/2,<br />					 y  =&gt; </span><span id="var">$ysize</span><span id="regExp"> - </span><span id="var">$margin</span><span id="regExp"> +5*</span><span id="var">$line_width</span><span id="regExp"> + </span><span id="var">$font</span><span id="regExp">-&gt;{width}/</span>2,
					 <span id="sqStr">'font-size'</span>=&gt;<span id="var">$font</span>-&gt;<span id="braces">{</span>width<span id="braces">}</span>,
    				 <span id="sqStr">'text-anchor'</span>=&gt;<span id="dqStr">"bottom"</span>
					 
					 <span id="braces">)</span>-&gt;<span id="method">cdata</span><span id="braces">(</span><span id="var">$xlabel</span><span id="braces">)</span>;
       <span id="braces">}</span>
    <span id="braces">}</span>	
    
    <span id="comment"># print to $args{-file};</span><br />    <span id="perlKey">if</span>  <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>  
		<span id="perlFunc">open</span> <span id="braces">(</span>SVGFILE, <span id="dqStr">"&gt;"</span>.<span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span>
		    or <span id="var">$self</span>-&gt;<span id="method">throw</span><span id="braces">(</span><span id="dqStr">"Could not write to "</span>.<span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span>;
		<span id="perlKey">my</span> <span id="var">$xml</span> = <span id="var">$image</span>-&gt;<span id="method">xmlify</span>;
		<span id="var">$xml</span> =~ <span id="regExp">s/\s+&lt;\/text/&lt;\/text/gs</span>;
	    <span id="perlFunc">print</span> SVGFILE <span id="var">$xml</span>;
		<span id="perlFunc">close</span> SVGFILE;
    <span id="braces">}</span>
    <span id="perlKey">return</span> <span id="var">$image</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE5" id="CODE5"></a>_png_draw_A</td><td >description</td><td ><a href="#CODE4">prev</a></td><td ><a href="#CODE6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_png_draw_A</span>
{<pre>    
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$im</span>, <span id="var">$x</span>, <span id="var">$y</span>, <span id="var">$xsize</span>, <span id="var">$ysize</span>, <span id="var">$white</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$green</span> = <span id="var">$im</span>-&gt;<span id="method">colorAllocate</span><span id="braces">(</span>0,255,0<span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">$outPoly</span> = <span id="module">GD::Polygon</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">)</span>;
    <span id="var">$outPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>, <span id="var">$y</span>+<span id="var">$ysize</span><span id="braces">)</span>;
    <span id="var">$outPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*.42, <span id="var">$y</span><span id="braces">)</span>;
    <span id="var">$outPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*.58, <span id="var">$y</span><span id="braces">)</span>;
    <span id="var">$outPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span><span id="braces">)</span>;
    <span id="var">$outPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>+0.85*<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span><span id="braces">)</span>;
    <span id="var">$outPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>+0.725*<span id="var">$xsize</span>, <span id="var">$y</span>+0.75*<span id="var">$ysize</span><span id="braces">)</span>;
    <span id="var">$outPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>+0.275*<span id="var">$xsize</span>, <span id="var">$y</span>+0.75*<span id="var">$ysize</span><span id="braces">)</span>;
    <span id="var">$outPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>+0.15*<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span><span id="braces">)</span>;
    <span id="var">$im</span>-&gt;<span id="method">filledPolygon</span><span id="braces">(</span><span id="var">$outPoly</span>, <span id="var">$green</span><span id="braces">)</span>;
    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$ysize</span>&gt;8<span id="braces">)</span>  <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="var">$inPoly</span> = <span id="module">GD::Polygon</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="var">$inPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*.5, <span id="var">$y</span>+0.2*<span id="var">$ysize</span><span id="braces">)</span>;
	<span id="var">$inPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*.34, <span id="var">$y</span>+0.6*<span id="var">$ysize</span>-1<span id="braces">)</span>;
	<span id="var">$inPoly</span>-&gt;<span id="method">addPt</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*.64, <span id="var">$y</span>+0.6*<span id="var">$ysize</span>-1<span id="braces">)</span>;
	<span id="var">$im</span>-&gt;<span id="method">filledPolygon</span><span id="braces">(</span><span id="var">$inPoly</span>, <span id="var">$white</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">return</span> 1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE6" id="CODE6"></a>_png_draw_C</td><td >description</td><td ><a href="#CODE5">prev</a></td><td ><a href="#CODE7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_png_draw_C</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$im</span>, <span id="var">$x</span>, <span id="var">$y</span>, <span id="var">$xsize</span>, <span id="var">$ysize</span>, <span id="var">$white</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$blue</span> = <span id="var">$im</span>-&gt;<span id="method">colorAllocate</span><span id="braces">(</span>0,0,255<span id="braces">)</span>;
    <span id="var">$im</span>-&gt;<span id="method">arc</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*0.54, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2,1.08*</span><span id="var">$xsize</span><span id="regExp">,</span><span id="var">$ysize</span>,0,360<span id="regExp">,</span><span id="var">$blue</span>);<br />    <span id="var">$im</span>-&gt;<span id="method">fill</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2, </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>2, <span id="var">$blue</span><span id="braces">)</span>;
    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$ysize</span>&gt;12<span id="braces">)</span> <span id="braces">{</span>
	<span id="var">$im</span>-&gt;<span id="method">arc</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*0.53, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2, <br />		 0.75*</span><span id="var">$xsize</span><span id="regExp">, (0.725-0.725/</span><span id="var">$ysize</span><span id="braces">)</span>*<span id="var">$ysize</span>,
		 0,360,<span id="var">$white</span><span id="braces">)</span>;
	<span id="var">$im</span>-&gt;<span id="method">fill</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2, </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>2, <span id="var">$white</span><span id="braces">)</span>;
	<span id="var">$im</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2, </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>4+1, 
			     <span id="var">$x</span>+<span id="var">$xsize</span>*1.1, <span id="var">$y</span>+<span id="braces">(</span>3*<span id="var">$ysize</span><span id="regExp">/4)-1,<br />			     </span><span id="var">$white</span>);<br />    <span id="braces">}</span>
    <span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$ysize</span>&gt;3<span id="braces">)</span>  <span id="braces">{</span>
	<span id="var">$im</span>-&gt;<span id="method">arc</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*0.53, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2, <br />		 (0.75-0.75/</span><span id="var">$ysize</span><span id="braces">)</span>*<span id="var">$xsize</span>, <span id="braces">(</span>0.725-0.725<span id="regExp">/</span><span id="var">$ysize</span><span id="regExp">)*</span><span id="var">$ysize</span><span id="regExp">,<br />		 0,360,</span><span id="var">$white</span>);<br />	<span id="var">$im</span>-&gt;<span id="method">fill</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2, </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>2, <span id="var">$white</span><span id="braces">)</span>;
	<span id="var">$im</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*0.25, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2, <br />			     </span><span id="var">$x</span><span id="regExp">+</span><span id="var">$xsize</span><span id="regExp">*1.1, </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>2,
			     <span id="var">$white</span><span id="braces">)</span>;

    <span id="braces">}</span>
   <span id="perlKey">return</span> 1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE7" id="CODE7"></a>_png_draw_G</td><td >description</td><td ><a href="#CODE6">prev</a></td><td ><a href="#CODE8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_png_draw_G</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$im</span>, <span id="var">$x</span>, <span id="var">$y</span>, <span id="var">$xsize</span>, <span id="var">$ysize</span>, <span id="var">$white</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$yellow</span> = <span id="var">$im</span>-&gt;<span id="method">colorAllocate</span><span id="braces">(</span>200,200,0<span id="braces">)</span>;
    <span id="var">$im</span>-&gt;<span id="method">arc</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*0.54, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2,1.08*</span><span id="var">$xsize</span><span id="regExp">,</span><span id="var">$ysize</span>,0,360<span id="regExp">,</span><span id="var">$yellow</span>);<br />    <span id="var">$im</span>-&gt;<span id="method">fill</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2, </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>2, <span id="var">$yellow</span><span id="braces">)</span>;
    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$ysize</span>&gt;20<span id="braces">)</span> <span id="braces">{</span>
	<span id="var">$im</span>-&gt;<span id="method">arc</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*0.53, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2, <br />		 0.75*</span><span id="var">$xsize</span><span id="regExp">, (0.725-0.725/</span><span id="var">$ysize</span><span id="braces">)</span>*<span id="var">$ysize</span>,
		 0,360,<span id="var">$white</span><span id="braces">)</span>;
	<span id="var">$im</span>-&gt;<span id="method">fill</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2, </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>2, <span id="var">$white</span><span id="braces">)</span>;
	<span id="var">$im</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2, </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>4+1, 
			     <span id="var">$x</span>+<span id="var">$xsize</span>*1.1, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2-1,<br />			     </span><span id="var">$white</span>);<br />    <span id="braces">}</span>
    <span id="perlKey">elsif</span><span id="braces">(</span><span id="var">$ysize</span>&gt;3<span id="braces">)</span>  <span id="braces">{</span>
	<span id="var">$im</span>-&gt;<span id="method">arc</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*0.53, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2, <br />		 (0.75-0.75/</span><span id="var">$ysize</span><span id="braces">)</span>*<span id="var">$xsize</span>, <span id="braces">(</span>0.725-0.725<span id="regExp">/</span><span id="var">$ysize</span><span id="regExp">)*</span><span id="var">$ysize</span><span id="regExp">,<br />		 0,360,</span><span id="var">$white</span>);<br />	<span id="var">$im</span>-&gt;<span id="method">fill</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2, </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>2, <span id="var">$white</span><span id="braces">)</span>;
	<span id="var">$im</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$x</span>+<span id="var">$xsize</span>*0.25, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2, <br />			     </span><span id="var">$x</span><span id="regExp">+</span><span id="var">$xsize</span><span id="regExp">*1.1, </span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>2,
			     <span id="var">$white</span><span id="braces">)</span>;

    <span id="braces">}</span>
    <span id="var">$im</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$x</span>+0.85*<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2,<br />			 </span><span id="var">$x</span><span id="regExp">+</span><span id="var">$xsize</span><span id="regExp">,</span><span id="var">$y</span><span id="regExp">+(3*</span><span id="var">$ysize</span><span id="regExp">/</span>4<span id="braces">)</span>-1,
			  <span id="var">$yellow</span><span id="braces">)</span>;
    <span id="var">$im</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$x</span>+0.6*<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2,<br />			 </span><span id="var">$x</span><span id="regExp">+</span><span id="var">$xsize</span><span id="regExp">,</span><span id="var">$y</span><span id="regExp">+(5*</span><span id="var">$ysize</span><span id="regExp">/</span>8<span id="braces">)</span>-1,
			  <span id="var">$yellow</span><span id="braces">)</span>;
   <span id="perlKey">return</span> 1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE8" id="CODE8"></a>_png_draw_T</td><td >description</td><td ><a href="#CODE7">prev</a></td><td ><a href="#CODE9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_png_draw_T</span>
{<pre>    
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$im</span>, <span id="var">$x</span>, <span id="var">$y</span>, <span id="var">$xsize</span>, <span id="var">$ysize</span>, <span id="var">$white</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$red</span> = <span id="var">$im</span>-&gt;<span id="method">colorAllocate</span><span id="braces">(</span>255,0,0<span id="braces">)</span>;
    <span id="var">$im</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$x</span>, <span id="var">$y</span>, <span id="var">$x</span>+<span id="var">$xsize</span>, <span id="var">$y</span>+0.16*<span id="var">$ysize</span>, <span id="var">$red</span><span id="braces">)</span>;
    <span id="var">$im</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$x</span>+0.42*<span id="var">$xsize</span>, <span id="var">$y</span>, <span id="var">$x</span>+0.58*<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span>, <span id="var">$red</span><span id="braces">)</span>;
    <span id="perlKey">return</span> 1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE9" id="CODE9"></a>_svg_draw_A</td><td >description</td><td ><a href="#CODE8">prev</a></td><td ><a href="#CODE10">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_svg_draw_A</span>
{<pre>    
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$im</span>, <span id="var">$x</span>, <span id="var">$y</span>, <span id="var">$xsize</span>, <span id="var">$ysize</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="var">$im</span>-&gt;<span id="method">polygon</span><span id="braces">(</span> points =&gt; <span id="braces">[</span><span id="var">$x</span>, <span id="var">$y</span>+<span id="var">$ysize</span>, <span id="var">$x</span>+<span id="var">$xsize</span>*.42, <span id="var">$y</span>, <span id="var">$x</span>+<span id="var">$xsize</span>*.58, <span id="var">$y</span>, <span id="var">$x</span>+<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span>,
    			  			<span id="var">$x</span>+0.85*<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span>, <span id="var">$x</span>+0.725*<span id="var">$xsize</span>, <span id="var">$y</span>+0.75*<span id="var">$ysize</span>,  <span id="var">$x</span>+0.275*<span id="var">$xsize</span>, <span id="var">$y</span>+0.75*<span id="var">$ysize</span>, 
    			  			<span id="var">$x</span>+0.15*<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span>,  <span id="var">$x</span>, <span id="var">$y</span>+<span id="var">$ysize</span><span id="braces">]</span>,
    			  fill =&gt; <span id="sqStr">'rgb(0,255,0)'</span>
    			  <span id="braces">)</span>;
    <span id="var">$im</span>-&gt;<span id="method">polygon</span><span id="braces">(</span> points =&gt; <span id="braces">[</span><span id="var">$x</span>+<span id="var">$xsize</span>*.5, <span id="var">$y</span>+0.2*<span id="var">$ysize</span>, <span id="var">$x</span>+<span id="var">$xsize</span>*.34, <span id="var">$y</span>+0.6*<span id="var">$ysize</span>, <span id="var">$x</span>+<span id="var">$xsize</span>*.64, <span id="var">$y</span>+0.6*<span id="var">$ysize</span> <span id="braces">]</span>,
    			  fill =&gt; <span id="sqStr">'rgb(255,255,255)'</span><span id="braces">)</span>;
    <span id="perlKey">return</span> 1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE10" id="CODE10"></a>_svg_draw_C</td><td >description</td><td ><a href="#CODE9">prev</a></td><td ><a href="#CODE11">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_svg_draw_C</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$im</span>, <span id="var">$x</span>, <span id="var">$y</span>, <span id="var">$xsize</span>, <span id="var">$ysize</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="var">$im</span>-&gt;<span id="method">ellipse</span><span id="braces">(</span>cx=&gt;<span id="var">$x</span>+<span id="var">$xsize</span>*0.54, cy=&gt;<span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2, rx=&gt;</span><span id="var">$xsize</span><span id="regExp">*0.54, ry=&gt;</span><span id="var">$ysize</span><span id="regExp">/</span>2,
                 fill =&gt; <span id="sqStr">'rgb(0,0,255)'</span><span id="braces">)</span>;
    <span id="var">$im</span>-&gt;<span id="method">ellipse</span><span id="braces">(</span> cx=&gt;<span id="var">$x</span>+<span id="var">$xsize</span>*0.53, cy=&gt;<span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2, rx=&gt;</span><span id="var">$xsize</span><span id="regExp">*0.375, ry=&gt;</span><span id="var">$ysize</span>*0.375,<br />                 fill =&gt; 'rgb(255,255,255)');<br />	<span id="var">$im</span>-&gt;<span id="method">rectangle</span><span id="braces">(</span>x=&gt;<span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2, y=&gt;</span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>4,
					width =&gt;<span id="var">$xsize</span>*0.6, height =&gt;<span id="var">$ysize</span>/2,<br />					fill=&gt; 'rgb(255,255,255)');<br />    <span id="perlKey">return</span> 1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE11" id="CODE11"></a>_svg_draw_G</td><td >description</td><td ><a href="#CODE10">prev</a></td><td ><a href="#CODE12">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_svg_draw_G</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$im</span>, <span id="var">$x</span>, <span id="var">$y</span>, <span id="var">$xsize</span>, <span id="var">$ysize</span>, <span id="var">$white</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="var">$im</span>-&gt;<span id="method">ellipse</span><span id="braces">(</span>cx =&gt; <span id="var">$x</span>+<span id="var">$xsize</span>*0.54, cy =&gt; <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2,<br />    			 rx =&gt; 0.54*</span><span id="var">$xsize</span><span id="regExp">, ry =&gt; </span><span id="var">$ysize</span><span id="regExp">/</span>2,
    			 fill =&gt; <span id="sqStr">'rgb(200,200,0)'</span><span id="braces">)</span>;
    <span id="var">$im</span>-&gt;<span id="method">ellipse</span><span id="braces">(</span>cx =&gt; <span id="var">$x</span>+<span id="var">$xsize</span>*0.53, cy =&gt; <span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2,<br />    			 rx =&gt; 0.375*</span><span id="var">$xsize</span><span id="regExp">, ry =&gt; 0.375*</span><span id="var">$ysize</span>,<br />    			 fill =&gt; 'rgb(255,255,255)');<br />    
	<span id="var">$im</span>-&gt;<span id="method">rectangle</span><span id="braces">(</span>x=&gt;<span id="var">$x</span>+<span id="var">$xsize</span><span id="regExp">/2, y=&gt;</span><span id="var">$y</span><span id="regExp">+</span><span id="var">$ysize</span><span id="regExp">/</span>4,
					width =&gt;<span id="var">$xsize</span>*0.6, height =&gt;<span id="var">$ysize</span>/2,<br />					fill=&gt; 'rgb(255,255,255)');<br />	<span id="var">$im</span>-&gt;<span id="method">rectangle</span><span id="braces">(</span>x=&gt;<span id="var">$x</span>+0.80*<span id="var">$xsize</span>, y=&gt;<span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2,<br />					width =&gt;</span><span id="var">$xsize</span><span id="regExp">*0.208, height =&gt;</span><span id="var">$ysize</span><span id="regExp">/</span>4,
					fill=&gt; <span id="sqStr">'rgb(200,200,0)'</span><span id="braces">)</span>;
	<span id="var">$im</span>-&gt;<span id="method">rectangle</span><span id="braces">(</span>x=&gt;<span id="var">$x</span>+0.6*<span id="var">$xsize</span>, y=&gt;<span id="var">$y</span>+<span id="var">$ysize</span><span id="regExp">/2,<br />					width =&gt;</span><span id="var">$xsize</span><span id="regExp">*0.408, height =&gt;</span><span id="var">$ysize</span><span id="regExp">/</span>8,
					fill=&gt; <span id="sqStr">'rgb(200,200,0)'</span><span id="braces">)</span>;
    
    <span id="perlKey">return</span> 1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE12" id="CODE12"></a>_svg_draw_T</td><td >description</td><td ><a href="#CODE11">prev</a></td><td ><a href="#CODE13">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_svg_draw_T</span>
{<pre>    
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$im</span>, <span id="var">$x</span>, <span id="var">$y</span>, <span id="var">$xsize</span>, <span id="var">$ysize</span>, <span id="var">$white</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="var">$im</span>-&gt;<span id="method">polygon</span> <span id="braces">(</span>points =&gt;<span id="braces">[</span><span id="var">$x</span>, <span id="var">$y</span>, <span id="var">$x</span>+<span id="var">$xsize</span>, <span id="var">$y</span>, <span id="var">$x</span>+<span id="var">$xsize</span>, <span id="var">$y</span>+0.16*<span id="var">$ysize</span>, 
    						<span id="var">$x</span>+0.58*<span id="var">$xsize</span>, <span id="var">$y</span>+0.16*<span id="var">$ysize</span>, <span id="var">$x</span>+0.58*<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span>,
    						<span id="var">$x</span>+0.42*<span id="var">$xsize</span>, <span id="var">$y</span>+<span id="var">$ysize</span>, <span id="var">$x</span>+0.42*<span id="var">$xsize</span>, <span id="var">$y</span>+0.16*<span id="var">$ysize</span>, 
    						<span id="var">$x</span>, <span id="var">$y</span>+0.16*<span id="var">$ysize</span><span id="braces">]</span>,
    			  fill =&gt; <span id="sqStr">'rgb(255,0,0)'</span><span id="braces">)</span>;
    <span id="perlKey">return</span> 1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE13" id="CODE13"></a>draw_logo</td><td ><a href="#POD3">description</a></td><td ><a href="#CODE12">prev</a></td><td ><a href="#CODE14">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">draw_logo</span>
{<pre>    
    <span id="perlFunc">no</span> strict;
    <span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">shift</span>;
    <span id="perlKey">my</span> <span id="var">%args</span> = <span id="braces">(</span>-xsize      =&gt; 600,
		-full_scale =&gt; 2.25,
		-graph_title=&gt; <span id="dqStr">""</span>,
		-x_title    =&gt; <span id="dqStr">""</span>,
		-y_title    =&gt; <span id="dqStr">""</span>,
        -startpos   =&gt; 1,
 		<span id="var">@_</span><span id="braces">)</span>;
    <span id="comment"># Other parameters that can be specified:</span><br />    <span id="comment">#       -ysize -line_width -margin</span><br />    <span id="comment"># do not have a fixed default value </span><br />    <span id="comment">#   - they are calculated from xsize if not specified</span><br />    
        <span id="comment"># draw postscript logo if asked for</span><br />    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-ps'</span><span id="braces">}</span> || <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-pdf'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
      <span id="perlKey">return</span> <span id="method">_draw_ps_logo</span><span id="braces">(</span><span id="var">$self</span>, <span id="var">%args</span><span id="braces">)</span>;  
    <span id="braces">}</span>
    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-svg'</span><span id="braces">}</span> || <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-SVG'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
      <span id="perlKey">return</span> <span id="method">_draw_svg_logo</span><span id="braces">(</span><span id="var">$self</span>, <span id="var">%args</span><span id="braces">)</span>;  
    <span id="braces">}</span>

    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$xsize</span>,<span id="var">$FULL_SCALE</span>, <span id="var">$x_title</span>, <span id="var">$y_title</span><span id="braces">)</span>   
	= <span id="var">@args</span><span id="braces">{</span><span id="perlFunc">qw</span><span id="braces">(</span>-xsize -full_scale -x_title y_title<span id="braces">)</span><span id="braces">}</span> ;

    <span id="perlKey">my</span> <span id="var">$PER_PIXEL_LINE</span> = 300;
    
    <span id="comment"># calculate other parameters if not specified</span><br />
    <span id="perlKey">my</span> <span id="var">$line_width</span> = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-line_width<span id="braces">}</span> or <span id="perlFunc">int</span> <span id="braces">(</span><span id="var">$xsize</span><span id="regExp">/</span><span id="var">$PER_PIXEL_LINE</span>) or 1);<br />    <span id="perlKey">my</span> <span id="var">$ysize</span>      = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-ysize<span id="braces">}</span> or <span id="var">$xsize</span>/1.6); <br />    <span id="comment"># remark (the line above): 1.6 is a standard screen x:y ratio</span><br />    <span id="perlKey">my</span> <span id="var">$margin</span>     = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-margin<span id="braces">}</span> or <span id="var">$ysize</span>*0.15<span id="braces">)</span>;

    <span id="perlKey">my</span> <span id="var">$image</span> = <span id="module">GD::Image</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="var">$xsize</span>, <span id="var">$ysize</span><span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">$white</span> = <span id="var">$image</span>-&gt;<span id="method">colorAllocate</span><span id="braces">(</span>255,255,255<span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">$black</span> = <span id="var">$image</span>-&gt;<span id="method">colorAllocate</span><span id="braces">(</span>0,0,0<span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">$motif_size</span> = <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">getdim</span><span id="braces">(</span>0<span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">$font</span> = <span id="braces">(</span><span id="braces">(</span>&amp;<span id="module">GD</span>::<span id="method">gdTinyFont</span><span id="braces">(</span><span id="braces">)</span>, &amp;<span id="module">GD</span>::<span id="method">gdSmallFont</span><span id="braces">(</span><span id="braces">)</span>, &amp;<span id="module">GD</span>::<span id="method">gdMediumBoldFont</span><span id="braces">(</span><span id="braces">)</span>, 
		&amp;<span id="module">GD</span>::<span id="method">gdLargeFont</span><span id="braces">(</span><span id="braces">)</span>, &amp;<span id="module">GD</span>::<span id="method">gdGiantFont</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span><span id="braces">[</span><span id="perlFunc">int</span><span id="braces">(</span><span id="braces">(</span><span id="var">$ysize</span>-50<span id="braces">)</span>/100)]<br />	or &amp;GD::gdGiantFont());<br />    <span id="perlKey">my</span> <span id="var">$title_font</span> = <span id="braces">(</span><span id="braces">(</span>&amp;<span id="module">GD</span>::<span id="method">gdSmallFont</span><span id="braces">(</span><span id="braces">)</span>, &amp;<span id="module">GD</span>::<span id="method">gdMediumBoldFont</span><span id="braces">(</span><span id="braces">)</span>, 
		&amp;<span id="module">GD</span>::<span id="method">gdLargeFont</span><span id="braces">(</span><span id="braces">)</span>, &amp;<span id="module">GD</span>::<span id="method">gdGiantFont</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span><span id="braces">[</span><span id="perlFunc">int</span><span id="braces">(</span><span id="braces">(</span><span id="var">$ysize</span>-50<span id="braces">)</span>/100)]<br />	or &amp;GD::gdGiantFont());<br />

   <span id="comment"># WRITE LABELS AND TITLE</span><br />
    <span id="comment"># graph title   #&amp;GD::Font::MediumBold</span><br />    <span id="var">$image</span>-&gt;<span id="method">string</span><span id="braces">(</span><span id="var">$title_font</span>,
		   <span id="var">$xsize</span><span id="regExp">/2-length(</span><span id="var">$args</span><span id="regExp">{-graph_title})* </span><span id="var">$title_font</span><span id="regExp">-&gt;width() /</span>2,
		   <span id="var">$margin</span><span id="regExp">/2 - </span><span id="var">$title_font</span><span id="regExp">-&gt;height()/</span>2,
		   <span id="var">$args</span><span id="braces">{</span>-graph_title<span id="braces">}</span>, <span id="var">$black</span><span id="braces">)</span>;
    
    <span id="comment"># x_title</span><br />    <span id="var">$image</span>-&gt;<span id="method">string</span><span id="braces">(</span><span id="var">$font</span>,
		   <span id="var">$xsize</span><span id="regExp">/2-length(</span><span id="var">$args</span><span id="regExp">{-x_title})*</span><span id="var">$font</span><span id="regExp">-&gt;width()/</span>2,
		   <span id="var">$ysize</span>-<span id="braces">(</span> <span id="var">$margin</span> - <span id="var">$font</span>-&gt;<span id="method">height</span><span id="braces">(</span><span id="braces">)</span>*0  - 5*<span id="var">$line_width</span><span id="braces">)</span><span id="regExp">/2 <br />		     - </span><span id="var">$font</span><span id="regExp">-&gt;height()/</span>2*0,
		   <span id="var">$args</span><span id="braces">{</span>-x_title<span id="braces">}</span>, 
		   <span id="var">$black</span><span id="braces">)</span>;
    <span id="comment"># y_title</span><br />    <span id="var">$image</span>-&gt;<span id="method">stringUp</span><span id="braces">(</span><span id="var">$font</span>,
		     <span id="braces">(</span><span id="var">$margin</span> -<span id="var">$font</span>-&gt;<span id="method">width</span><span id="braces">(</span><span id="braces">)</span>- 5*<span id="var">$line_width</span><span id="braces">)</span><span id="regExp">/2 <br />		       - </span><span id="var">$font</span><span id="regExp">-&gt;height()/</span>2 ,
		     <span id="var">$ysize</span><span id="regExp">/2+length(</span><span id="var">$args</span><span id="regExp">{'-y_title'})*</span><span id="var">$font</span><span id="regExp">-&gt;width()/</span>2,
		     <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-y_title'</span><span id="braces">}</span>, <span id="var">$black</span><span id="braces">)</span>;
    

    <span id="comment"># DRAW AXES</span><br />
    <span id="comment"># vertical: (top left to bottom right)</span><br />    <span id="var">$image</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$margin</span>-<span id="var">$line_width</span>, <span id="var">$margin</span>-<span id="var">$line_width</span>, 
			 <span id="var">$margin</span>-1, <span id="var">$ysize</span>-<span id="var">$margin</span>+<span id="var">$line_width</span>, 
			 <span id="var">$black</span><span id="braces">)</span>;
    <span id="comment"># horizontal: (ditto)</span><br />    <span id="var">$image</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$margin</span>-<span id="var">$line_width</span>, <span id="var">$ysize</span>-<span id="var">$margin</span>+1, 
			 <span id="var">$xsize</span>-<span id="var">$margin</span>+<span id="var">$line_width</span>,<span id="var">$ysize</span>-<span id="var">$margin</span>+<span id="var">$line_width</span>,
			 <span id="var">$black</span><span id="braces">)</span>;

    <span id="comment"># DRAW VERTICAL TICKS AND LABELS</span><br />
    <span id="comment"># vertical axis (IC 1 and 2) </span><br />    <span id="perlKey">my</span> <span id="var">$ic_1</span> = <span id="braces">(</span><span id="var">$ysize</span> - 2* <span id="var">$margin</span><span id="braces">)</span> <span id="regExp">/ </span><span id="var">$FULL_SCALE</span>;<br />    <span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$i</span> <span id="braces">(</span>1..<span id="var">$FULL_SCALE</span><span id="braces">)</span>  <span id="braces">{</span>
		<span id="var">$image</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$margin</span>-3*<span id="var">$line_width</span>, 
				     <span id="var">$ysize</span>-<span id="var">$margin</span> - <span id="var">$i</span>*<span id="var">$ic_1</span>, 
				     <span id="var">$margin</span>-1, 
				     <span id="var">$ysize</span>-<span id="var">$margin</span>+<span id="var">$line_width</span> - <span id="var">$i</span>*<span id="var">$ic_1</span>, 
				     <span id="var">$black</span><span id="braces">)</span>;
		<span id="var">$image</span>-&gt;<span id="method">string</span><span id="braces">(</span><span id="var">$font</span>, 
			       <span id="var">$margin</span>-5*<span id="var">$line_width</span> - <span id="var">$font</span>-&gt;<span id="method">width</span>,
			       <span id="var">$ysize</span> - <span id="var">$margin</span> - <span id="var">$i</span>*<span id="var">$ic_1</span> - <span id="var">$font</span>-&gt;<span id="method">height</span><span id="braces">(</span><span id="braces">)</span><span id="regExp">/2,<br />			       </span><span id="var">$i</span><span id="regExp">,<br />		       </span><span id="var">$black</span>);<br />    <span id="braces">}</span>
    
    <span id="comment"># DRAW HORIZONTAL TICKS AND LABELS, AND THE LOGO ITSELF </span><br />
    <span id="comment"># define function refs as hash elements</span><br />    <span id="perlKey">my</span> <span id="var">%draw_letter</span> = <span id="braces">(</span> A =&gt;\&amp; _png_draw_A,
			C =&gt;\&amp; _png_draw_C,
			G =&gt;\&amp; _png_draw_G,
			T =&gt;\&amp; _png_draw_T <span id="braces">)</span>;

    <span id="perlKey">my</span> <span id="var">$horiz_step</span> = <span id="braces">(</span><span id="var">$xsize</span> -2*<span id="var">$margin</span><span id="braces">)</span> <span id="regExp">/ </span><span id="var">$motif_size</span>;<br />
    <span id="comment">#this is to avoid clutter on X axis:</span><br />    <span id="perlKey">my</span> <span id="var">$longest_label_length</span> = <span id="perlFunc">length</span><span id="braces">(</span><span id="dqStr">"<span id="var">$motif_size</span>"</span><span id="braces">)</span>;
    <span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">length</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span><span id="braces">)</span> &gt; <span id="var">$longest_label_length</span><span id="braces">)</span> <span id="braces">{</span>
      	<span id="var">$longest_label_length</span> = <span id="perlFunc">length</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span><span id="braces">)</span>; 
    <span id="braces">}</span>
    <span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">length</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span>+<span id="var">$motif_size</span><span id="braces">)</span> &gt; <span id="var">$longest_label_length</span><span id="braces">)</span> <span id="braces">{</span>
       	<span id="var">$longest_label_length</span> = <span id="perlFunc">length</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span>+<span id="var">$motif_size</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">my</span> <span id="var">$draw_every_nth_label</span> = <span id="perlFunc">int</span><span id="braces">(</span><span id="var">$longest_label_length</span>*<span id="var">$font</span>-&gt;<span id="method">width</span>+2<span id="braces">)</span> <span id="regExp">/ </span><span id="var">$horiz_step</span> + 1;<br />    <span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$i</span> <span id="braces">(</span>0..<span id="var">$motif_size</span><span id="braces">)</span>  <span id="braces">{</span>
	
		<span id="var">$image</span>-&gt;<span id="method">filledRectangle</span><span id="braces">(</span><span id="var">$margin</span> + <span id="var">$i</span>*<span id="var">$horiz_step</span>, 
				     <span id="var">$ysize</span>-<span id="var">$margin</span>+1, 
				     <span id="var">$margin</span> + <span id="var">$i</span>*<span id="var">$horiz_step</span>+ <span id="var">$line_width</span>, 
				     <span id="var">$ysize</span>-<span id="var">$margin</span>+3*<span id="var">$line_width</span>, 
				     <span id="var">$black</span><span id="braces">)</span>;
		<span id="perlKey">last</span> <span id="perlKey">if</span> <span id="var">$i</span>==<span id="var">$motif_size</span>;
	
		<span id="comment"># get the $i-th column of matrix</span><br />		<span id="perlKey">my</span> <span id="var">%ic</span>; 
		<span id="braces">(</span><span id="var">$ic</span><span id="braces">{</span>A<span id="braces">}</span>, <span id="var">$ic</span><span id="braces">{</span>C<span id="braces">}</span>, <span id="var">$ic</span><span id="braces">{</span>G<span id="braces">}</span>, <span id="var">$ic</span><span id="braces">{</span>T<span id="braces">}</span><span id="braces">)</span> = list <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">slice</span><span id="braces">(</span><span id="var">$i</span><span id="braces">)</span>;
	
		<span id="comment"># sort nucleotides by increasing information content</span><br />		<span id="perlKey">my</span> <span id="var">@draw_order</span> = <span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$ic</span><span id="braces">{</span><span id="var">$a</span><span id="braces">}</span>&lt;=&gt;<span id="var">$ic</span><span id="braces">{</span><span id="var">$b</span><span id="braces">}</span><span id="braces">}</span> <span id="perlFunc">qw</span><span id="braces">(</span>A C G T<span id="braces">)</span>;
	
		<span id="comment"># draw logo column</span><br />		<span id="perlKey">my</span> <span id="var">$xlettersize</span> = <span id="var">$horiz_step</span> /1.1;<br />		<span id="perlKey">my</span> <span id="var">$ybottom</span> = <span id="var">$ysize</span> - <span id="var">$margin</span>;
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$base</span> <span id="braces">(</span><span id="var">@draw_order</span><span id="braces">)</span>  <span id="braces">{</span>
		    <span id="perlKey">my</span> <span id="var">$ylettersize</span> = <span id="perlFunc">int</span><span id="braces">(</span><span id="var">$ic</span><span id="braces">{</span><span id="var">$base</span><span id="braces">}</span>*<span id="var">$ic_1</span> +0.5<span id="braces">)</span>;
		    <span id="perlKey">next</span> <span id="perlKey">if</span> <span id="var">$ylettersize</span> ==0;
	
		    <span id="comment"># draw letter</span><br />		    <span id="var">$draw_letter</span><span id="braces">{</span><span id="var">$base</span><span id="braces">}</span>-&gt;<span id="braces">(</span><span id="var">$image</span>,
					  <span id="var">$margin</span> + <span id="var">$i</span>*<span id="var">$horiz_step</span>,
					  <span id="var">$ybottom</span> - <span id="var">$ylettersize</span>,
				  <span id="var">$xlettersize</span>, <span id="var">$ylettersize</span>, <span id="var">$white</span><span id="braces">)</span>;
		    <span id="var">$ybottom</span> = <span id="var">$ybottom</span> - <span id="var">$ylettersize</span>-1;
		<span id="braces">}</span>	    
	    
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-error_bars'</span><span id="braces">}</span> and <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-error_bars'</span><span id="braces">}</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="dqStr">"ARRAY"</span><span id="braces">)</span>  <span id="braces">{</span>
		    <span id="perlKey">my</span> <span id="var">$sd_pix</span>   = <span id="perlFunc">int</span><span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-error_bars'</span><span id="braces">}</span>-&gt;<span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>*<span id="var">$ic_1</span><span id="braces">)</span>;
		    <span id="perlKey">my</span> <span id="var">$yt</span>     = <span id="var">$ybottom</span> - <span id="var">$sd_pix</span>+1;
		    <span id="perlKey">my</span> <span id="var">$yb</span>  = <span id="var">$ybottom</span> + <span id="var">$sd_pix</span>-1;
		    <span id="perlKey">my</span> <span id="var">$xpos</span>     = <span id="var">$margin</span> + <span id="braces">(</span><span id="var">$i</span>+0.45<span id="braces">)</span>*<span id="var">$horiz_step</span>;
		    <span id="perlKey">my</span> <span id="var">$half_width</span>;
		    
		    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$yb</span> &gt; <span id="var">$ysize</span>-<span id="var">$margin</span>+<span id="var">$line_width</span><span id="braces">)</span>  <span id="braces">{</span>
			<span id="var">$yb</span> = <span id="var">$ysize</span>-<span id="var">$margin</span>+<span id="var">$line_width</span>
			<span id="braces">}</span>
		    <span id="perlKey">else</span> <span id="braces">{</span>
			<span id="var">$image</span>-&gt;<span id="method">line</span><span id="braces">(</span><span id="var">$xpos</span> - <span id="var">$xlettersize</span><span id="regExp">/8, </span><span id="var">$yb</span><span id="regExp">, <br />				     </span><span id="var">$xpos</span><span id="regExp"> + </span><span id="var">$xlettersize</span><span id="regExp">/</span>8, <span id="var">$yb</span>, 
				     <span id="var">$black</span><span id="braces">)</span>;
		    <span id="braces">}</span>
		   	
		    <span id="var">$image</span>-&gt;<span id="method">line</span><span id="braces">(</span><span id="var">$xpos</span>, <span id="var">$yt</span>, <span id="var">$xpos</span>, <span id="var">$yb</span>, <span id="var">$black</span><span id="braces">)</span>;
		    <span id="var">$image</span>-&gt;<span id="method">line</span><span id="braces">(</span><span id="var">$xpos</span> - 1 , <span id="var">$ybottom</span>, <span id="var">$xpos</span>+1, <span id="var">$ybottom</span>, <span id="var">$black</span><span id="braces">)</span>;
		    <span id="var">$image</span>-&gt;<span id="method">line</span><span id="braces">(</span><span id="var">$xpos</span> - <span id="var">$xlettersize</span><span id="regExp">/8, </span><span id="var">$yt</span><span id="regExp">, <br />				 </span><span id="var">$xpos</span><span id="regExp"> + </span><span id="var">$xlettersize</span><span id="regExp">/</span>8, <span id="var">$yt</span>, 
				 <span id="var">$black</span><span id="braces">)</span>;
		    
		    
		<span id="braces">}</span>
	
       <span id="comment"># print position number on x axis (The if condition is for avoiding clutter)</span><br />       <span id="perlKey">my</span> <span id="var">$xlabel</span> = <span id="var">$i</span>+ <span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span>;
       <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-startpos<span id="braces">}</span>&lt;0 and <span id="var">$xlabel</span>&gt;=0<span id="braces">)</span> <span id="braces">{</span>
           <span id="var">$xlabel</span> ++;
       <span id="braces">}</span>
       <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$xlabel</span> % <span id="var">$draw_every_nth_label</span> == 0<span id="braces">)</span> <span id="braces">{</span>
           <span id="var">$image</span>-&gt;<span id="method">string</span><span id="braces">(</span><span id="var">$font</span>,
                          <span id="var">$margin</span> + <span id="braces">(</span><span id="var">$i</span>+0.5<span id="braces">)</span>*<span id="var">$horiz_step</span> - <span id="var">$font</span>-&gt;<span id="method">width</span><span id="braces">(</span><span id="braces">)</span><span id="regExp">/2,<br />                          </span><span id="var">$ysize</span><span id="regExp"> - </span><span id="var">$margin</span><span id="regExp"> +5*</span><span id="var">$line_width</span><span id="regExp">,<br />                          </span><span id="var">$xlabel</span><span id="regExp">,<br />                          </span><span id="var">$black</span>);<br />       <span id="braces">}</span>
    <span id="braces">}</span>
    
    <span id="comment"># print $args{-file};</span><br />    <span id="perlKey">if</span>  <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>  
		<span id="perlFunc">open</span> <span id="braces">(</span>PNGFILE, <span id="dqStr">"&gt;"</span>.<span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span>
		    or <span id="var">$self</span>-&gt;<span id="method">throw</span><span id="braces">(</span><span id="dqStr">"Could not write to "</span>.<span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span>;
	        <span id="perlFunc">print</span> PNGFILE <span id="var">$image</span>-&gt;<span id="method">png</span>;
		<span id="perlFunc">close</span> PNGFILE;
    <span id="braces">}</span>
    <span id="perlKey">return</span> <span id="var">$image</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE14" id="CODE14"></a>new</td><td ><a href="#POD4">description</a></td><td ><a href="#CODE13">prev</a></td><td ><a href="#CODE15">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">new</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>, <span id="var">%args</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$matrix</span> = <span id="module"><a href="../Matrix.html">TFBS::Matrix</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="var">%args</span>, -matrixtype=&gt;<span id="dqStr">"ICM"</span><span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">bless</span> <span id="var">$matrix</span>, <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> || <span id="var">$class</span>;
    <span id="var">$self</span>-&gt;<span id="method">_check_ic_validity</span><span id="braces">(</span><span id="braces">)</span>;
    <span id="perlKey">return</span> <span id="var">$self</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE15" id="CODE15"></a>to_PWM</td><td ><a href="#POD5">description</a></td><td ><a href="#CODE14">prev</a></td><td ><a href="#CODE16">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">to_PWM</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="var">$self</span>-&gt;<span id="method">throw</span> <span id="braces">(</span><span id="dqStr">"Method to_PWM not yet implemented."</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE16" id="CODE16"></a>total_ic</td><td >description</td><td ><a href="#CODE15">prev</a></td><td >next</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">total_ic</span>
{<pre>    <span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">sum</span><span id="braces">(</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<a name="General" id="General"></a>
<div id="mainTitle">General documentation</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_FEEDBACK" id="_pod_FEEDBACK"></a>FEEDBACK</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">Please send bug reports and other comments to the author.</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_AUTHOR - Boris Lenhard" id="_pod_AUTHOR - Boris Lenhard"></a>AUTHOR - Boris Lenhard</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">Boris Lenhard &lt;Boris.Lenhard@cgb.ki.se&gt;</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_APPENDIX" id="_pod_APPENDIX"></a>APPENDIX</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">The rest of the documentation details each of the object<br />methods. Internal methods are preceded with an underscore.</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_name" id="_pod_name"></a>name</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_ID" id="_pod_ID"></a>ID</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_class" id="_pod_class"></a>class</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_matrix" id="_pod_matrix"></a>matrix</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_length" id="_pod_length"></a>length</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_revcom" id="_pod_revcom"></a>revcom</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_rawprint" id="_pod_rawprint"></a>rawprint</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_prettyprint" id="_pod_prettyprint"></a>prettyprint</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">The above methods are common to all matrix objects. Please consult<br /><a href="../Matrix.html" target="urlWin" id="podUrl"><b>TFBS::Matrix</b></a> to find out how to use them.</div>
<div id="sep"></div>
</body>
</html>
