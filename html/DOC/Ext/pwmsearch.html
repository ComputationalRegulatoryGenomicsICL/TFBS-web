<head>
<!-- Generated by perlmod2www.pl -->
<title>
pwmsearch documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS::Ext</H4>
<H3>pwmsearch</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#SUMMARY">Summary</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#SYNOPSIS">Synopsis</A></TD>
<TD><A HREF="#DESCRIPTION">Description</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR><TD BGCOLOR="#ffae84"><B>Summary</B></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD><pre><B>TFBS::Ext::pwmsearch</B> - Perl extension for scanning a DNA sequence object with a position weight matrix<BR></pre></TD></TR>
</TABLE>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR BGCOLOR="#ffd39b"><TD COLSPAN="2"><B>Globals (from <FONT COLOR="BLUE">use vars</FONT> definitions)</B></TD></TR>
<TR><TD COLSPAN="2"><font color="#1f32ff">@EXPORT</font></TD></TR>
<TR><TD COLSPAN="2"><font color="#1f32ff">%EXPORT_TAGS</font></TD></TR>
<TR><TD COLSPAN="2"><font color="#1f32ff">@EXPORT_OK</font></TD></TR>
<TR><TD COLSPAN="2"><font color="#1f32ff">$VERSION</font></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::SeqIO</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">File::Temp</font></b> qw ( :POSIX ) </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">warnings</font></b></TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre>  use TFBS::Ext::pwmsearch;<BR>  pwmsearch<BR></pre>
</TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre>Stub documentation for TFBS::Ext::pwmsearch, created by h2xs. It looks like the<BR>author of the extension was negligent enough to leave the stub<BR>unedited.<BR><BR>Blah blah blah.<BR></pre>
<pre>None by default.<BR></pre>
</TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>pwmsearch</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>pwmsearch</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>pwmsearch</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$matrixobj</font>, <font color="#1f32ff">$seqobj</font>, <font color="#1f32ff">$threshold</font>, <font color="#1f32ff">$start</font>, <font color="#1f32ff">$end</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$start</font> = 1 <font color="#0000ff"><b>if</b></font> !<font color="#4169e1"><b>defined</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$start</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$end</font> = <font color="#1f32ff">$seqobj</font>-&gt;<font color="#4169e1"><b>length</b></font> <font color="#0000ff"><b>if</b></font> !<font color="#4169e1"><b>defined</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$end</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixfile</font> = <font color="#ff8204">tmpnam</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#4169e1"><b>open</b></font> <font color="#0000ff"><b>(</b></font>MATRIX, <font color="#007400">"&gt;<font color="#1f32ff">$matrixfile</font>"</font><font color="#0000ff"><b>)</b></font> or <font color="#4169e1"><b>die</b></font> <font color="#0000ff"><b>(</b></font><font color="#007400">"Error opening temporary file."</font><font color="#0000ff"><b>)</b></font>;
    <font color="#4169e1"><b>print</b></font> MATRIX <font color="#1f32ff">$matrixobj</font>-&gt;<font color="#ff8204">rawprint</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#4169e1"><b>close</b></font> MATRIX;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$outfile</font> = <font color="#ff8204">tmpnam</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#ff0000">## pwm_search is confused by long descriptions - we delete desc temporarily:</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$save_desc</font> = <font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">desc</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">desc</font><font color="#0000ff"><b>(</b></font><font color="#007400">""</font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqfile</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$seqfile</font> = <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$seqfile</font> = <font color="#ff8204">tmpnam</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$outstream</font> = <font color="#8000ff"><b>Bio::SeqIO</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-file=&gt;<font color="#007400">"&gt;<font color="#1f32ff">$seqfile</font>"</font>, -<font color="#4169e1"><b>format</b></font>=&gt;<font color="#007400">"fasta"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$outstream</font>-&gt;<font color="#ff8204">write_seq</font><font color="#0000ff"><b>(</b></font><font color="#8000ff"><b>Bio::Seq</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-seq =&gt;<font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">subseq</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$start</font>, <font color="#1f32ff">$end</font><font color="#0000ff"><b>)</b></font>,
					    -id  =&gt;<font color="#1f32ff">$seqobj</font>-&gt;id<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$outstream</font>-&gt;<font color="#4169e1"><b>close</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>

    <font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">desc</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$save_desc</font><font color="#0000ff"><b>)</b></font>;

    <font color="#ff0000">## calculate threshold</font><BR>
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$threshold</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$threshold</font> =~ <font color="#006400"><b>/(.+)%/</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font> 
	    <font color="#ff0000">## percentage</font><BR>	    <font color="#1f32ff">$threshold</font> = <font color="#1f32ff">$matrixobj</font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font> +
		<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$matrixobj</font>-&gt;<font color="#0000ff"><b>{</b></font>max_score<font color="#0000ff"><b>}</b></font> - <font color="#1f32ff">$matrixobj</font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>* <font color="#1f32ff">$1</font>/100;<BR>	<font color="#0000ff"><b>}</b></font>
	<font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#ff0000">## absolute value</font><BR>	    <font color="#ff0000">## $threshold = $args{-threshold};</font><BR>	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#ff0000">## no threshold given</font><BR>	<font color="#1f32ff">$threshold</font> = <font color="#1f32ff">$matrixobj</font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font> -1;
    <font color="#0000ff"><b>}</b></font>
    
    <font color="#ff8204">search_xs</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$matrixfile</font>, <font color="#1f32ff">$seqfile</font>, 
	    <font color="#1f32ff">$threshold</font>, <font color="#1f32ff">$matrixobj</font>-&gt;<font color="#ff8204">name</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>.<font color="#007400">""</font>, 
	    <font color="#1f32ff">$matrixobj</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'class'</font><font color="#0000ff"><b>}</b></font>.<font color="#007400">""</font>, <font color="#1f32ff">$outfile</font><font color="#0000ff"><b>)</b></font>;
    
    <font color="#4169e1"><b>unlink</b></font> <font color="#1f32ff">$seqfile</font> <font color="#0000ff"><b>unless</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'_fastafile'</font><font color="#0000ff"><b>}</b></font>; 
    <font color="#4169e1"><b>unlink</b></font> <font color="#1f32ff">$matrixfile</font>;  

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$hitlist</font> = <A HREF="../TFBS/SiteSet.html"><font color="#8000ff"><b>TFBS::SiteSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$TFname</font>, <font color="#1f32ff">$TFclass</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$matrixobj</font>-&gt;<font color="#0000ff"><b>{</b></font>name<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$matrixobj</font>-&gt;<font color="#0000ff"><b>{</b></font>class<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;

    
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$save_delim</font> = $/; <font color="#ff0000">## bugfix submitted </font><BR>    <font color="#0000ff"><b>local</b></font> $/ = <font color="#007400">"\n"</font>;     <font color="#ff0000">## by Michal Lapidot</font><BR>
    <font color="#4169e1"><b>open</b></font> <font color="#0000ff"><b>(</b></font>OUTFILE, <font color="#1f32ff">$outfile</font><font color="#0000ff"><b>)</b></font> 
	or <font color="#4169e1"><b>die</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"Could not read temporary outfile"</font><font color="#0000ff"><b>)</b></font>; 
    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$line</font> = &lt;OUTFILE&gt;<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#ff0000">## print STDERR $line;</font><BR>	<font color="#4169e1"><b>chomp</b></font> <font color="#1f32ff">$line</font>;
	<font color="#1f32ff">$line</font> =~ <font color="#006400"><b>s/^\s+//</b></font>;
	<font color="#1f32ff">$line</font> =~ <font color="#006400"><b>s/ *\t */\t/g</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq_id</font>, <font color="#1f32ff">$factor</font>, <font color="#1f32ff">$class</font>, <font color="#1f32ff">$strand</font>, <font color="#1f32ff">$score</font>, <font color="#1f32ff">$pos</font>, <font color="#1f32ff">$siteseq</font><font color="#0000ff"><b>)</b></font> =
	    <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>split</b></font> <font color="#006400"><b>/\t/</b></font>, <font color="#1f32ff">$line</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>[</b></font>0, 2, 3, 4, 5, 7, 9<font color="#0000ff"><b>]</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$num_strand</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$strand</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"-"</font><font color="#0000ff"><b>)</b></font>? <font color="#007400">"-1"</font> : <font color="#007400">"1"</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$site</font> = <A HREF="../TFBS/Site.html"><font color="#8000ff"><b>TFBS::Site</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font> <font color="#0000ff"><b>(</b></font> -seq_id =&gt; <font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">display_id</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>.<font color="#007400">""</font>,
				     -seqobj  =&gt; <font color="#1f32ff">$seqobj</font>,
				     -strand  =&gt; <font color="#1f32ff">$num_strand</font>.<font color="#007400">""</font>,
				     -pattern =&gt; <font color="#1f32ff">$matrixobj</font>,
				     -siteseq =&gt; <font color="#1f32ff">$siteseq</font>.<font color="#007400">""</font>,
				     -score   =&gt; <font color="#1f32ff">$score</font>.<font color="#007400">""</font>,
				     -start   =&gt; <font color="#1f32ff">$pos</font> +<font color="#1f32ff">$start</font> -1,
				     -end     =&gt; <font color="#1f32ff">$pos</font> +<font color="#1f32ff">$start</font>
						 +<font color="#4169e1"><b>length</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$siteseq</font><font color="#0000ff"><b>)</b></font> -2
				     <font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$hitlist</font>-&gt;<font color="#ff8204">add_site</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$site</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#4169e1"><b>close</b></font> OUTFILE;
    $/ = <font color="#1f32ff">$save_delim</font>;
    <font color="#4169e1"><b>unlink</b></font> <font color="#1f32ff">$outfile</font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$hitlist</font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_AUTHOR"><B>AUTHOR</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>A. U. Thor, <a href="mailto:a.u.thor@a.galaxy.far.far.away">a.u.thor@a.galaxy.far.far.away</a><BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_SEE ALSO"><B>SEE ALSO</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>perl(1).<BR></pre>
</TD></TR>
</TABLE>
</body>
</html>
