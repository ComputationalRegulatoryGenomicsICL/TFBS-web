<head>
<!-- Generated by perlmod2www.pl -->
<title>
SetOperations documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS::Tools</H4>
<H3>SetOperations</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#libs">Included libraries</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR><TD COLSPAN="2">No package variables defined.</TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Root::Root</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
</TABLE>
<A NAME="libs"></A><TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Inherit</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD><b><font color="#0000ff">Bio::Root::Root</font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><FONT COLOR="RED">No synopsis!</FONT></TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><FONT COLOR="RED">No description!</FONT></TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>_get_index_elements</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>_index</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>_index_by_annotation</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>_index_by_pair_annotation</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>_index_strict</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>_output</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
<TR><TD><B>_sets_to_arrayrefs</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE7">Code</A></TD></TR>
<TR><TD><B>difference</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE8">Code</A></TD></TR>
<TR><TD><B>index_by</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE9">Code</A></TD></TR>
<TR><TD><B>intersection</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE10">Code</A></TD></TR>
<TR><TD><B>new</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE11">Code</A></TD></TR>
<TR><TD><B>output_type</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE12">Code</A></TD></TR>
<TR><TD><B>pairs</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE13">Code</A></TD></TR>
<TR><TD><B>strict</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE14">Code</A></TD></TR>
<TR><TD><B>union</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE15">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>_get_index_elements</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_get_index_elements</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$set_member</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@index_elements</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$method</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;index_by<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$method</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">'CODE'</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@index_elements</font>, <font color="#1f32ff">$method</font>-&gt;<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$set_member</font><font color="#0000ff"><b>)</b></font>;
        <font color="#0000ff"><b>}</b></font>
        <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
            <font color="#0000ff"><b>eval</b></font> <font color="#0000ff"><b>{</b></font> <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@index_elements</font>, <font color="#1f32ff">$set_member</font>-&gt;<font color="#1f32ff">$method</font>; <font color="#0000ff"><b>}</b></font>;
            <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font>$@<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
                <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>sprintf</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"Could not use '%s' for indexing a <font color="#1f32ff">%s</font> object. The original error was:\n"</font>,
                                     <font color="#1f32ff">$method</font>, <font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$set_member</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>.$@<font color="#0000ff"><b>)</b></font>
            <font color="#0000ff"><b>}</b></font>
       <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">@index_elements</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>_index</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_index</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_index_fn<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>(</b></font><font color="#1f32ff">@_</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>_index_by_annotation</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_index_by_annotation</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$set_arrayref</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%index_hash</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$member</font> <font color="#0000ff"><b>(</b></font>@$set_arrayref<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@index_elements</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_index_elements</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$member</font><font color="#0000ff"><b>)</b></font>;
        <font color="#1f32ff">$index_hash</font><font color="#0000ff"><b>{</b></font><font color="#4169e1"><b>join</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"::"</font>, <font color="#1f32ff">@index_elements</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$member</font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">%index_hash</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>_index_by_pair_annotation</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_index_by_pair_annotation</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$set_arrayref</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%index_hash</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$member</font> <font color="#0000ff"><b>(</b></font>@$set_arrayref<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@index_elements</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_index_elements</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$member</font>-&gt;feature1<font color="#0000ff"><b>)</b></font>,
                              <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_index_elements</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$member</font>-&gt;feature2<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
        <font color="#1f32ff">$index_hash</font><font color="#0000ff"><b>{</b></font><font color="#4169e1"><b>join</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"::"</font>, <font color="#1f32ff">@index_elements</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$member</font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">%index_hash</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>_index_strict</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_index_strict</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$set_arrayref</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%index_hash</font> = <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>map</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$_</font>, <font color="#1f32ff">$_</font><font color="#0000ff"><b>}</b></font> @$set_arrayref<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">%index_hash</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>_output</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30"><A HREF="#CODE7">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_output</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$hashref</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;output_type <font color="#0000ff"><b>eq</b></font> <font color="#007400">"arrayref"</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>return</b></font> <font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>values</b></font> %$hashref<font color="#0000ff"><b>]</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;output_type <font color="#0000ff"><b>eq</b></font> <font color="#007400">"array"</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>return</b></font> %$hashref;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;output_type <font color="#0000ff"><b>eq</b></font> <font color="#007400">"matrix_set"</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$setobj</font> = <A HREF="../MatrixSet.html"><font color="#8000ff"><b>TFBS::MatrixSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font>;
        <font color="#1f32ff">$setobj</font>-&gt;<font color="#ff8204">add_Matrix</font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>values</b></font> %$hashref<font color="#0000ff"><b>)</b></font>;
        <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$setobj</font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;output_type <font color="#0000ff"><b>eq</b></font> <font color="#007400">"site_set"</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$setobj</font> = <A HREF="../SiteSet.html"><font color="#8000ff"><b>TFBS::SiteSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font>;
        <font color="#1f32ff">$setobj</font>-&gt;<font color="#ff8204">add_site</font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>values</b></font> %$hashref<font color="#0000ff"><b>)</b></font>;
        <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$setobj</font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;output_type.<font color="#007400">" is not a supported output type"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE7"></A><B>_sets_to_arrayrefs</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE6">prev</A></TD><TD WIDTH="30"><A HREF="#CODE8">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_sets_to_arrayrefs</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@sets</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@set_arrayrefs</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$set</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@sets</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$set</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"ARRAY"</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@set_arrayrefs</font>, <font color="#1f32ff">$set</font>;
        <font color="#0000ff"><b>}</b></font>
        <font color="#0000ff"><b>elsif</b></font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$set</font><font color="#0000ff"><b>)</b></font> and <font color="#1f32ff">$set</font>-&gt;<font color="#ff8204">can</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Iterator"</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@set_elements</font>;
            <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$it</font> = <font color="#1f32ff">$set</font>-&gt;Iterator;
            <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$set_el</font> = <font color="#1f32ff">$it</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font> <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@set_elements</font>, <font color="#1f32ff">$set_el</font> <font color="#0000ff"><b>}</b></font>
            <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@set_arrayrefs</font>,\@ set_elements;
        <font color="#0000ff"><b>}</b></font>
        <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
            <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Set must be an aray reference or have an "</font>.
                         <font color="#007400">"Iterator method. Got "</font>.<font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$set</font> or <font color="#1f32ff">$set</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>. <font color="#007400">"instead."</font><font color="#0000ff"><b>)</b></font>;
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">@set_arrayrefs</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE8"></A><B>difference</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE7">prev</A></TD><TD WIDTH="30"><A HREF="#CODE9">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>difference</b></font>
 {<pre>    <font color="#ff0000">## pairs only for now</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@sets</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$set1</font>, <font color="#1f32ff">$set2</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_sets_to_arrayrefs</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@sets</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font>!<font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$set2</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$self</font>-&gt;throw <font color="#0000ff"><b>(</b></font><font color="#007400">"'difference' needs exactly two sets as arguments"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%diff_index1</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_index</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$set1</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%diff_index2</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_index</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$set2</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$key</font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>keys</b></font> <font color="#1f32ff">%diff_index1</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$diff_index2</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$key</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
            <font color="#4169e1"><b>delete</b></font> <font color="#1f32ff">$diff_index1</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$key</font><font color="#0000ff"><b>}</b></font>;
            <font color="#4169e1"><b>delete</b></font> <font color="#1f32ff">$diff_index2</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$key</font><font color="#0000ff"><b>}</b></font>;
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#4169e1"><b>wantarray</b></font> ? <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_output</font><font color="#0000ff"><b>(</b></font>\<font color="#1f32ff">%diff_index1</font><font color="#0000ff"><b>)</b></font>, <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_output</font><font color="#0000ff"><b>(</b></font>\<font color="#1f32ff">%diff_index2</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>
              : <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_output</font><font color="#0000ff"><b>(</b></font>\<font color="#1f32ff">%diff_index1</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE9"></A><B>index_by</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE8">prev</A></TD><TD WIDTH="30"><A HREF="#CODE10">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>index_by</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>shift</b></font>;

    <font color="#ff0000">## By default, we are dealing with Bio::SeqFeatureI objects</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@DEFAULTS</font> = <font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>primary_tag source_tag start end score strand<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@_</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>if</b></font><font color="#0000ff"><b>(</b></font>!<font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_index_by<font color="#0000ff"><b>}</b></font> =\@ DEFAULTS;
        <font color="#0000ff"><b>}</b></font>
        <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"ARRAY"</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_index_by<font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>;
        <font color="#0000ff"><b>}</b></font>
        <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_index_by<font color="#0000ff"><b>}</b></font> = <font color="#0000ff"><b>[</b></font><font color="#1f32ff">@_</font><font color="#0000ff"><b>]</b></font>;
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_index_by<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE10"></A><B>intersection</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE9">prev</A></TD><TD WIDTH="30"><A HREF="#CODE11">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>intersection</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@sets</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@set_arrayrefs</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_sets_to_arrayrefs</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@sets</font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">##this would be faster, but we might want to retain the exact objects</font><BR>    <font color="#ff0000">## that were present in</font><BR>    <font color="#ff0000">##my @set_arrayrefs = sort {@$a &lt;=&gt; @$b} $self-&gt;_sets_to_arrayrefs(@sets);</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%intersection_index</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_index</font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>shift</b></font> <font color="#1f32ff">@set_arrayrefs</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$set_arrayref</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@set_arrayrefs</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%curr_set_index</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_index</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$set_arrayref</font><font color="#0000ff"><b>)</b></font>;
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@help_array</font> = <font color="#1f32ff">%curr_set_index</font>;
        
        <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$key</font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>keys</b></font> <font color="#1f32ff">%intersection_index</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>

            <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font>!<font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$curr_set_index</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$key</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            	<font color="#4169e1"><b>delete</b></font> <font color="#1f32ff">$intersection_index</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$key</font><font color="#0000ff"><b>}</b></font> ;
            <font color="#0000ff"><b>}</b></font>
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_output</font><font color="#0000ff"><b>(</b></font>\<font color="#1f32ff">%intersection_index</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE11"></A><B>new</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE10">prev</A></TD><TD WIDTH="30"><A HREF="#CODE12">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>new</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font>, <font color="#1f32ff">@args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>bless</b></font> <font color="#0000ff"><b>{</b></font><font color="#0000ff"><b>}</b></font>, <font color="#4169e1"><b>ref</b></font> <font color="#1f32ff">$caller</font> || <font color="#1f32ff">$caller</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$index_by</font>, <font color="#1f32ff">$strict</font>, <font color="#1f32ff">$output_type</font>, <font color="#1f32ff">$pairs</font><font color="#0000ff"><b>)</b></font> =
        <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_rearrange</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>qw</b></font><font color="#007400">'INDEX_BY STRICT OUTPUT_TYPE PAIRS'</font><font color="#0000ff"><b>]</b></font>, <font color="#1f32ff">@args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">index_by</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$index_by</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">strict</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$strict</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">output_type</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$output_type</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">pairs</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pairs</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE12"></A><B>output_type</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE11">prev</A></TD><TD WIDTH="30"><A HREF="#CODE13">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>output_type</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@_</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_output_type<font color="#0000ff"><b>}</b></font> = <font color="#4169e1"><b>shift</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_output_type<font color="#0000ff"><b>}</b></font> = <font color="#007400">"arrayref"</font>
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_output_type<font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE13"></A><B>pairs</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE12">prev</A></TD><TD WIDTH="30"><A HREF="#CODE14">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>pairs</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@_</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_pairs<font color="#0000ff"><b>}</b></font> = <font color="#4169e1"><b>shift</b></font> and !<font color="#1f32ff">$self</font>-&gt;strict<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_index_fn<font color="#0000ff"><b>}</b></font> =\&amp; _index_by_pair_annotation;
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_pairs<font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE14"></A><B>strict</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE13">prev</A></TD><TD WIDTH="30"><A HREF="#CODE15">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>strict</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@_</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_strict<font color="#0000ff"><b>}</b></font> = <font color="#4169e1"><b>shift</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_index_fn<font color="#0000ff"><b>}</b></font> =\&amp; _index_strict;
        <font color="#0000ff"><b>}</b></font>
        <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_index_fn<font color="#0000ff"><b>}</b></font> =\&amp; _index_by_annotation;
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_strict<font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE15"></A><B>union</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE14">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>union</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@sets</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%union_index</font> =
        <font color="#4169e1"><b>map</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_index</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>}</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_sets_to_arrayrefs</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@sets</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_output</font><font color="#0000ff"><b>(</b></font>\<font color="#1f32ff">%union_index</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
</TABLE>
<B>No general documentation available.</B><BR>
</body>
</html>
