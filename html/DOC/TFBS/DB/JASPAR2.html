<head>
<!-- Generated by perlmod2www.pl -->
<title>
JASPAR2 documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS::DB</H4>
<H3>JASPAR2</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#SUMMARY">Summary</A></TD>
<TD><A HREF="#libs">Included libraries</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#SYNOPSIS">Synopsis</A></TD>
<TD><A HREF="#DESCRIPTION">Description</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR><TD BGCOLOR="#ffae84"><B>Summary</B></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD><pre><B>TFBS::DB::JASPAR2</B> - interface to MySQL relational database of pattern matrices<BR></pre></TD></TR>
</TABLE>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR BGCOLOR="#ffd39b"><TD COLSPAN="2"><B>Globals (from <FONT COLOR="BLUE">use vars</FONT> definitions)</B></TD></TR>
<TR><TD COLSPAN="2"><font color="#1f32ff">$AUTOLOAD</font></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Root::Root</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">DBI</font></b></TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../Matrix/ICM.html">TFBS::Matrix::ICM</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../Matrix/PFM.html">TFBS::Matrix::PFM</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../Matrix/PWM.html">TFBS::Matrix::PWM</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../MatrixSet.html">TFBS::MatrixSet</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">constant(1)</font></b> DEFAULT_CONNECTSTRING =&gt; &quot; dbi:mysql:JASPAR_DEMO &quot; </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">constant(2)</font></b> DEFAULT_USER =&gt; &quot; &quot; </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">constant(3)</font></b> DEFAULT_PASSWORD =&gt; &quot; &quot; </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
</TABLE>
<A NAME="libs"></A><TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Inherit</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD><b><font color="#0000ff">Bio::Root::Root</font></b> <b><font color="#0000ff"><a href="../DB.html">TFBS::DB</a></font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><BR><A NAME="_pod_* creating a database object by connecting to the existing JASPAR2-type database">    * creating a database object by connecting to the existing JASPAR2-type database</A><BR>        my $db = <B>TFBS::DB::JASPAR2</B>-&gt;connect(&quot;dbi:mysql:JASPAR2:myhost&quot;,<BR>					&quot;myusername&quot;,<BR>					&quot;mypassword&quot;);<BR><BR><A NAME="_pod_* retrieving a TFBS::Matrix::* object from the database">    * retrieving a TFBS::Matrix::* object from the database</A><BR>        # retrieving a PFM by ID<BR>    my $pfm = $db-&gt;get_Matrix_by_ID('M0079','PFM');<BR> <BR>    #retrieving a PWM by name<BR>    my $pwm = $db-&gt;get_Matrix_by_name('NF-kappaB', 'PWM');<BR><BR><A NAME="_pod_">    </A><BR><A NAME="_pod_">    </A><BR><A NAME="_pod_* storing a matrix in the database (currently only PFMs):">    * storing a matrix in the database (currently only PFMs):</A><BR>        #let $pfm is a TFBS::Matrix::PFM object<BR>    $db-&gt;store_Matrix($pfm);<BR><BR><BR></pre>
</TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><B>TFBS::DB::JASPAR2</B> is a read/write database interface module that<BR>retrieves and stores TFBS::Matrix::* and TFBS::MatrixSet<BR>objects in a relational database.<BR></pre>
</TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>AUTOLOAD</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>DESTROY</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>_create_tables</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>_get_IDlist_by_query</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>_get_matrixstring</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>_new</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
<TR><TD><B>_simple_query</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE7">Code</A></TD></TR>
<TR><TD><B>_store_matrix_data</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE8">Code</A></TD></TR>
<TR><TD><B>_store_matrix_info</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE9">Code</A></TD></TR>
<TR><TD><B>_store_matrix_seqs</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE10">Code</A></TD></TR>
<TR><TD><B>_store_matrix_species</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE11">Code</A></TD></TR>
<TR><TD><B>connect</B></TD><TD><A HREF="#POD1">Description</A></TD><TD><A HREF="#CODE12">Code</A></TD></TR>
<TR><TD><B>create</B></TD><TD><A HREF="#POD2">Description</A></TD><TD><A HREF="#CODE13">Code</A></TD></TR>
<TR><TD><B>dbh</B></TD><TD><A HREF="#POD3">Description</A></TD><TD><A HREF="#CODE14">Code</A></TD></TR>
<TR><TD><B>delete_Matrix_having_ID</B></TD><TD><A HREF="#POD4">Description</A></TD><TD><A HREF="#CODE15">Code</A></TD></TR>
<TR><TD><B>get_MatrixSet</B></TD><TD><A HREF="#POD5">Description</A></TD><TD><A HREF="#CODE16">Code</A></TD></TR>
<TR><TD><B>get_Matrix_by_ID</B></TD><TD><A HREF="#POD6">Description</A></TD><TD><A HREF="#CODE17">Code</A></TD></TR>
<TR><TD><B>get_Matrix_by_name</B></TD><TD><A HREF="#POD7">Description</A></TD><TD><A HREF="#CODE18">Code</A></TD></TR>
<TR><TD><B>new</B></TD><TD><A HREF="#POD8">Description</A></TD><TD><A HREF="#CODE19">Code</A></TD></TR>
<TR><TD><B>store_Matrix</B></TD><TD><A HREF="#POD9">Description</A></TD><TD><A HREF="#CODE20">Code</A></TD></TR>
<TR><TD><B>store_MatrixSet</B></TD><TD><A HREF="#POD10">Description</A></TD><TD><A HREF="#CODE21">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_connect"></A><A NAME="POD1"></A><B>connect</B></TD><TD><A HREF="#CODE12">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD>prev</TD><TD><A HREF="#POD2">next</A></TD></TR></TABLE>
<pre> Title   : connect<BR> Usage   : my $db =<BR>	    <B>TFBS::DB::JASPAR2</B>-&gt;connect(&quot;dbi:mysql:DATABASENAME:HOSTNAME&quot;,<BR>					&quot;USERNAME&quot;,<BR>					&quot;PASSWORD&quot;);<BR> Function: connects to the existing JASPAR2-type database and<BR>	   returns a database object that interfaces the database<BR> Returns : a <B>TFBS::DB::JASPAR2</B> object<BR> Args    : a standard database connection triplet<BR>	   (&quot;dbi:mysql:DATABASENAME:HOSTNAME&quot;,  &quot;USERNAME&quot;, &quot;PASSWORD&quot;)<BR>	   In place of DATABASENAME, HOSTNAME, USERNAME and PASSWORD,<BR>	   use the actual values. PASSWORD and USERNAME might be<BR>	   optional, depending on the user acces permissions for<BR>	   the database server.<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_create"></A><A NAME="POD2"></A><B>create</B></TD><TD><A HREF="#CODE13">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD1">prev</A></TD><TD><A HREF="#POD3">next</A></TD></TR></TABLE>
<pre> Title   : create<BR> Usage   : my $newdb =<BR>	    <B>TFBS::DB::JASPAR2</B>-&gt;create(&quot;dbi:mysql:NEWDATABASENAME:HOSTNAME&quot;,<BR>				      &quot;USERNAME&quot;,<BR>				      &quot;PASSWORD&quot;);<BR> Function: connects to the database server, creates a new JASPAR2-type database and returns a database<BR>	   object that interfaces the database<BR> Returns : a <B>TFBS::DB::JASPAR2</B> object<BR> Args    : a standard database connection triplet<BR>	    (&quot;dbi:mysql:NEWDATABASENAME:HOSTNAME&quot;,  &quot;USERNAME&quot;, &quot;PASSWORD&quot;)<BR>	   In place of NEWDATABASENAME, HOSTNAME, USERNAME and<BR>	   PASSWORD use the actual values. PASSWORD and USERNAME<BR>           might be optional, depending on the users acces permissions<BR>           for the database server.<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_dbh"></A><A NAME="POD3"></A><B>dbh</B></TD><TD><A HREF="#CODE14">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD2">prev</A></TD><TD><A HREF="#POD4">next</A></TD></TR></TABLE>
<pre> Title   : dbh<BR> Usage   : my $dbh = $db-&gt;dbh();<BR>	   $dbh-&gt;do(&quot;UPDATE matrix_data SET name='ADD1' WHERE NAME='SREBP2'&quot;);<BR> Function: returns the DBI database handle of the MySQL database<BR>	   interfaced by $db; THIS IS USED FOR WRITING NEW METHODS<BR>	   FOR DIRECT RELATIONAL DATABASE MANIPULATION - if you<BR>	   have write access AND do not know what you are doing,<BR>	   you can severely  corrupt the data<BR>	   For documentation about database handle methods, see <a href="#_pod_DBI">DBI</a><BR> Returns : the database (DBI) handle of the MySQL JASPAR2-type<BR>	   relational database associated with the TFBS::DB::JASPAR2<BR>	   object<BR> Args    : none<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_delete_Matrix_having_ID"></A><A NAME="POD4"></A><B>delete_Matrix_having_ID</B></TD><TD><A HREF="#CODE15">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD3">prev</A></TD><TD><A HREF="#POD5">next</A></TD></TR></TABLE>
<pre> Title   : delete_Matrix_having_ID<BR> Usage   : $db-&gt;delete_Matrix_with_ID('M00045');<BR> Function: Deletes the matrix having the given ID from the database<BR> Returns : 0 on success; $@ contents on failure<BR>	   (this is too C-like and may change in future versions)<BR> Args    : (ID)<BR>	   A string<BR> Comment : Yeah, yeah, 'delete_Matrix_having_ID' is a stupid name<BR>	   for a method, but at least it should be obviuos what it does.<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_MatrixSet"></A><A NAME="POD5"></A><B>get_MatrixSet</B></TD><TD><A HREF="#CODE16">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD4">prev</A></TD><TD><A HREF="#POD6">next</A></TD></TR></TABLE>
<pre> Title   : get_MatrixSet<BR> Usage   : my $matrixset = $db-&gt;get_MatrixSet(%args);<BR> Function: fetches matrix data under for all matrices in the database<BR>	   matching criteria defined by the named arguments<BR>	   and returns a TFBS::MatrixSet object<BR> Returns : a TFBS::MatrixSet object<BR> Args    : This method accepts named arguments:<BR>	   -IDs        # a reference to an array of IDs (strings)<BR>	   -names      # a reference to an array of<BR>		       #  transcription factor names (string)<BR>	   -classes    # a reference to an array of<BR>		       #  structural class names (strings)<BR>	   -species    # a reference to an array of<BR>		       #   Latin species names (strings)<BR>	   -sysgroups  # a reference to an array of<BR>		       #  higher taxonomic categories (strings)<BR><BR>	   -matrixtype # a string, 'PFM', 'ICM' or 'PWM'<BR>	   -min_ic     # float, minimum total information content<BR>		       #   of the matrix<BR><BR>The five arguments that expect list references are used in database<BR>query formulation: elements within lists are combined with 'OR'<BR>operators, and the lists of different types with 'AND'. For example,<BR><BR>    my $matrixset = $db-&gt;(-classes =&gt; ['TRP_CLUSTER', 'FORKHEAD'],<BR>			  -species =&gt; ['Homo sapiens', 'Mus musculus'],<BR>			  -matrixtype =&gt; 'PWM');<BR><BR>gives a set of PWMs whose (structural clas is 'TRP_CLUSTER' OR<BR>'FORKHEAD') AND (the species they are derived from is 'Homo sapiens'<BR>OR 'Mus musculus').<BR><BR>The -min_ic filter is applied after the query in the sense that the<BR>matrices profiles with total infromation content less than specified<BR>are not included in the set.<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_Matrix_by_ID"></A><A NAME="POD6"></A><B>get_Matrix_by_ID</B></TD><TD><A HREF="#CODE17">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD5">prev</A></TD><TD><A HREF="#POD7">next</A></TD></TR></TABLE>
<pre> Title   : get_Matrix_by_ID<BR> Usage   : my $pfm = $db-&gt;get_Matrix_by_ID('M00034', 'PFM');<BR> Function: fetches matrix data under the given ID from the<BR>           database and returns a TFBS::Matrix::* object<BR> Returns : a TFBS::Matrix::* object; the exact type of the<BR>	   object depending on the second argument (allowed<BR>	   values are 'PFM', 'ICM', and 'PWM'); returns undef if<BR>	   matrix with the given ID is not found<BR> Args    : (Matrix_ID, Matrix_type)<BR>	   Matrix_ID is a string; Matrix_type is one of the<BR>	   following: 'PFM' (raw position frequency matrix),<BR>	   'ICM' (information content matrix) or 'PWM' (position<BR>	   weight matrix)<BR>	   If Matrix_type is omitted, a PWM is retrieved by default.<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_Matrix_by_name"></A><A NAME="POD7"></A><B>get_Matrix_by_name</B></TD><TD><A HREF="#CODE18">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD6">prev</A></TD><TD><A HREF="#POD8">next</A></TD></TR></TABLE>
<pre> Title   : get_Matrix_by_name<BR> Usage   : my $pfm = $db-&gt;get_Matrix_by_name('HNF-1', 'PWM');<BR> Function: fetches matrix data under the given name from the<BR>	   database and returns a TFBS::Matrix::* object<BR> Returns : a TFBS::Matrix::* object; the exact type of the object<BR>	   depending on the second argument (allowed values are<BR>	   'PFM', 'ICM', and 'PWM')<BR> Args    : (Matrix_name, Matrix_type)<BR>	   Matrix_name is a string; Matrix_type is one of the<BR>	   following:<BR>	   'PFM' (raw position frequency matrix),<BR>	   'ICM' (information content matrix) or<BR>	   'PWM' (position weight matrix)<BR>	   If Matrix_type is omitted, a PWM is retrieved by default.<BR> Warning : According to the current JASPAR2 data model, name is<BR>	   not necessarily a unique identifier. In the case where<BR>	   there are several matrices with the same name in the<BR>	   database, the function fetches the first one and prints<BR>	   a warning on STDERR. You have been warned.<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_new"></A><A NAME="POD8"></A><B>new</B></TD><TD><A HREF="#CODE19">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD7">prev</A></TD><TD><A HREF="#POD9">next</A></TD></TR></TABLE>
<pre> Title   : new<BR> Usage   : DEPRECATED - for backward compatibility only<BR>           Use connect() or create() instead<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_store_Matrix"></A><A NAME="POD9"></A><B>store_Matrix</B></TD><TD><A HREF="#CODE20">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD8">prev</A></TD><TD><A HREF="#POD10">next</A></TD></TR></TABLE>
<pre> Title   : store_Matrix<BR> Usage   : $db-&gt;store_Matrix($pfm);<BR> Function: Stores the contents of a TFBS::Matrix::DB object in the database<BR> Returns : 0 on success; $@ contents on failure<BR>	   (this is too C-like and may change in future versions)<BR> Args    : (PFM_object)<BR>	   A TFBS::Matrix::PFM object<BR> Comment : this is an experimental method that is not 100% bulletproof;<BR>	   use at your own risk<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_store_MatrixSet"></A><A NAME="POD10"></A><B>store_MatrixSet</B></TD><TD><A HREF="#CODE21">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD9">prev</A></TD><TD><A HREF="#POD11">next</A></TD></TR></TABLE>
<pre> Title   : store_MatrixSet<BR> Usage   : $db-&gt;store_Matrix($matrixset);<BR> Function: Stores the TFBS::DB::PFM object that are part of a<BR>           TFBS::MatrixSet object into the database<BR> Returns : 0 on success; $@ contents on failure<BR>	   (this is too C-like and may change in future versions)<BR> Args    : (MatrixSet_object)<BR>	   A TFBS::MatrixSet object<BR> Comment : THIS METHOD IS NOT YET IMPLEMENTED<BR></pre>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>AUTOLOAD</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>AUTOLOAD</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$ID</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#4169e1"><b>no</b></font> strict <font color="#007400">'refs'</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$TABLE</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%dbname_of</font> = <font color="#0000ff"><b>(</b></font>ID       =&gt; <font color="#007400">'ID'</font>,
		     name     =&gt; <font color="#007400">'name'</font>,
		     class    =&gt; <font color="#007400">'class'</font>, 
		     species  =&gt; <font color="#007400">'species'</font>, 
		     sysgroup =&gt; <font color="#007400">'phylum'</font>,
		     type     =&gt; <font color="#007400">'type'</font>,
		     seqdb    =&gt; <font color="#007400">'seq_db'</font>,
		     acc      =&gt; <font color="#007400">'seq'</font>,
		     total_ic =&gt; <font color="#007400">'IC'</font>,
		     medline  =&gt; <font color="#007400">'medline'</font>
		     <font color="#0000ff"><b>)</b></font>; 
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$where_column</font>, <font color="#1f32ff">$where_value</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$AUTOLOAD</font> =~ <font color="#006400"><b>/.*::_{0,1}get_(\w+)_list/</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$dbname_of</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$1</font><font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"<font color="#1f32ff">$AUTOLOAD</font>: no such method!"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$where_column</font>, <font color="#1f32ff">$where_value</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font>1,1<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$AUTOLOAD</font> =~ <font color="#006400"><b>/.*::_get_(\w+)/</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$dbname_of</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$1</font><font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"<font color="#1f32ff">$AUTOLOAD</font>: no such method!"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$ID</font> or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"No ID provided for <font color="#1f32ff">$AUTOLOAD</font>"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$where_column</font>, <font color="#1f32ff">$where_value</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font><font color="#007400">'ID'</font>, <font color="#1f32ff">$ID</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"<font color="#1f32ff">$AUTOLOAD</font>: no such method!"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$dbname_of</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$1</font><font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"<font color="#1f32ff">$AUTOLOAD</font>: no such method!"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font>    <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$1</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">'species'</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$TABLE</font> = <font color="#007400">'matrix_species'</font>; <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$1</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">'seqdb'</font> or <font color="#1f32ff">$1</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">'acc'</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$TABLE</font> = <font color="#007400">'matrix_seqs'</font>, <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$TABLE</font> = <font color="#007400">'matrix_info'</font> ; <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@results</font> = <font color="#1f32ff">$self</font>-&gt;_simple_query <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$TABLE</font>, <font color="#1f32ff">$dbname_of</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$1</font><font color="#0000ff"><b>}</b></font>, 
					<font color="#1f32ff">$where_column</font> =&gt; <font color="#1f32ff">$where_value</font><font color="#0000ff"><b>)</b></font>;
    <font color="#4169e1"><b>wantarray</b></font> ? <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">@results</font> : <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$results</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>DESTROY</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>DESTROY</b></font>
 {<pre>    <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#ff8204">dbh</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>if</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;dbh;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>_create_tables</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_create_tables</b></font>
 {<pre>    <font color="#ff0000">## utility function</font><BR>
    <font color="#ff0000">## If you want to change the databse schema,</font><BR>    <font color="#ff0000">## this is the right place to do it</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$dbh</font> = <font color="#4169e1"><b>shift</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@queries</font> = 
	<font color="#0000ff"><b>(</b></font>
       <font color="#4169e1"><b>q</b></font><font color="#007400">!!<BR>       CREATE TABLE matrix_data (<BR>         ID varchar(16) DEFAULT '' NOT NULL,<BR>         pos_ID varchar(24) DEFAULT '' NOT NULL,<BR>         base enum('A','C','G','T'),<BR>         position tinyint(3) unsigned,<BR>         raw int(3) unsigned,<BR>         info float(7,5) unsigned,<BR>         pwm float(7,5),<BR>         normalized float(7,5) unsigned,<BR>         PRIMARY KEY (pos_ID),<BR>         KEY id_index (ID)<BR>       )<BR>       !</font>,

       <font color="#4169e1"><b>q</b></font><font color="#007400">!!<BR>       CREATE TABLE matrix_info (<BR>         ID varchar(16) DEFAULT '' NOT NULL,<BR>         name varchar(15) DEFAULT '' NOT NULL,<BR>         type varchar(8) DEFAULT '' NOT NULL,<BR>         class varchar(20),<BR>         phylum varchar(32),<BR>         litt varchar(40),<BR>         medline int(12),<BR>         information varchar(20),<BR>         iterations varchar(6),<BR>         width int(2),<BR>         consensus varchar(25),<BR>         IC float(6,4),<BR>         sites int(3) unsigned,<BR>         PRIMARY KEY (ID)<BR>       )<BR>       !</font>,

       <font color="#4169e1"><b>q</b></font><font color="#007400">!!<BR>       CREATE TABLE matrix_seqs (<BR>         ID varchar(16) DEFAULT '' NOT NULL,<BR>         internal varchar(8) DEFAULT '' NOT NULL,<BR>         seq_db varchar(15) NOT NULL,<BR>         seq varchar(10) NOT NULL,<BR>         PRIMARY KEY (ID, seq_db, seq)<BR>       )<BR>       !</font>,

       <font color="#4169e1"><b>q</b></font><font color="#007400">!!<BR>       CREATE TABLE matrix_species (<BR>         ID varchar(16) DEFAULT '' NOT NULL,<BR>         internal varchar(8) DEFAULT '' NOT NULL,<BR>         species varchar(24) NOT NULL,<BR>         PRIMARY KEY (ID, species)<BR>       )<BR>	 !</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$query</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@queries</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$dbh</font>-&gt;<font color="#0000ff"><b>do</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$query</font><font color="#0000ff"><b>)</b></font> 
	    or <font color="#4169e1"><b>die</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"Error executing the query: $query\n"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>_get_IDlist_by_query</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_get_IDlist_by_query</b></font>
 {<pre>
    <font color="#ff0000">## called by get_MatrixSet</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$TABLES</font>, <font color="#1f32ff">%arrayref</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-names<font color="#0000ff"><b>}</b></font>     and  <font color="#1f32ff">$arrayref</font><font color="#0000ff"><b>{</b></font>name<font color="#0000ff"><b>}</b></font>   = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-names<font color="#0000ff"><b>}</b></font>    ;
    <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-classes<font color="#0000ff"><b>}</b></font>   and  <font color="#1f32ff">$arrayref</font><font color="#0000ff"><b>{</b></font>class<font color="#0000ff"><b>}</b></font>  = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-classes<font color="#0000ff"><b>}</b></font>  ;
    <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-sysgroups<font color="#0000ff"><b>}</b></font> and  <font color="#1f32ff">$arrayref</font><font color="#0000ff"><b>{</b></font>phylum<font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-sysgroups<font color="#0000ff"><b>}</b></font>;
    <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-IDs<font color="#0000ff"><b>}</b></font>       and  <font color="#1f32ff">$arrayref</font><font color="#0000ff"><b>{</b></font>ID<font color="#0000ff"><b>}</b></font>     = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-IDs<font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@andconditions</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-species<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$TABLES</font> = <font color="#007400">' matrix_info, matrix_species '</font>;
	<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@andconditions</font>, 
	<font color="#007400">'matrix_info.ID = matrix_species.ID'</font>,
	<font color="#007400">" ("</font>.
	    <font color="#4169e1"><b>join</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">" OR "</font>, 
	         <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>map</b></font> <font color="#0000ff"><b>{</b></font><font color="#007400">"matrix_species.species="</font>.
			   <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">dbh</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>)</b></font>
			   <font color="#0000ff"><b>}</b></font> 
		  @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-species<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>
		  <font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>.
		      <font color="#007400">") "</font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$TABLES</font> = <font color="#007400">'matrix_info '</font>;
    <font color="#0000ff"><b>}</b></font>
    
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$key</font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>keys</b></font> <font color="#1f32ff">%arrayref</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
      <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>scalar</b></font> @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$arrayref</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$key</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@andconditions</font>,
	<font color="#007400">"("</font>.
	<font color="#4169e1"><b>join</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">" OR "</font>,
	     <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>map</b></font> <font color="#0000ff"><b>{</b></font><font color="#007400">"matrix_info.<font color="#1f32ff">$key</font>="</font>.
		       <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">dbh</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>)</b></font>
		  <font color="#0000ff"><b>}</b></font> 
	      @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$arrayref</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$key</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>
	     <font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>.
	<font color="#007400">")"</font>;
      <font color="#0000ff"><b>}</b></font>
      <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@andconditions</font>, <font color="#007400">"(1=0)"</font>;
      <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$WHERE</font> = <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>scalar</b></font> <font color="#1f32ff">@andconditions</font><font color="#0000ff"><b>)</b></font> == 0<font color="#0000ff"><b>)</b></font> ? <font color="#007400">""</font> : <font color="#007400">" WHERE "</font>;


    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$query</font> = 
	    <font color="#007400">"SELECT DISTINCTROW matrix_info.id FROM <font color="#1f32ff">$TABLES</font> <font color="#1f32ff">$WHERE</font>"</font>.
	    <font color="#4169e1"><b>join</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">" AND "</font>, <font color="#1f32ff">@andconditions</font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sth</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">dbh</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$query</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$sth</font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font> or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Query failed:\n$query\n"</font><font color="#0000ff"><b>)</b></font>;
    
    <font color="#ff0000">## collect IDs and return</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@IDlist</font> = <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$id</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">$sth</font>-&gt;<font color="#ff8204">fetchrow_array</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@IDlist</font>, <font color="#1f32ff">$id</font>;
    <font color="#0000ff"><b>}</b></font>

    <font color="#1f32ff">$sth</font>-&gt;finish;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">@IDlist</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>_get_matrixstring</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_get_matrixstring</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$ID</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%dbname</font> = <font color="#0000ff"><b>(</b></font>PWM =&gt; <font color="#007400">'pwm'</font>, PFM =&gt; <font color="#007400">'raw'</font>, ICM =&gt; <font color="#007400">'info'</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$dbname</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$mt</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Unsupported matrix type: "</font>.<font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sth</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$qID</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">dbh</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixstring</font> = <font color="#007400">""</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$base</font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>A C G T<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$sth</font>=<font color="#1f32ff">$self</font>-&gt;dbh-&gt;prepare
	    <font color="#0000ff"><b>(</b></font><font color="#007400">"SELECT <font color="#1f32ff">$dbname</font>{<font color="#1f32ff">$mt</font>} FROM matrix_data 
              WHERE ID=<font color="#1f32ff">$qID</font> AND base='$base' ORDER BY position"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$sth</font>-&gt;execute;
	<font color="#1f32ff">$matrixstring</font> .=
	    <font color="#4169e1"><b>join</b></font> <font color="#0000ff"><b>(</b></font><font color="#007400">" "</font>, <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>map</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$_</font>-&gt;<font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>}</b></font> @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$sth</font>-&gt;<font color="#ff8204">fetchall_arrayref</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>.<font color="#007400">"\n"</font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#1f32ff">$sth</font>-&gt;finish;
    <font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>undef</b></font> <font color="#0000ff"><b>if</b></font> <font color="#1f32ff">$matrixstring</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"\n"</font>x4;

    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$matrixstring</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>_new</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30"><A HREF="#CODE7">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_new</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>  = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$class</font> = <font color="#4169e1"><b>ref</b></font> <font color="#1f32ff">$caller</font> || <font color="#1f32ff">$caller</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>bless</b></font> <font color="#0000ff"><b>{</b></font><font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$class</font>;

    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$connectstring</font>, <font color="#1f32ff">$user</font>, <font color="#1f32ff">$password</font><font color="#0000ff"><b>)</b></font>;
 
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-connect'</font><font color="#0000ff"><b>}</b></font> and <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-connect'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"ARRAY"</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$connectstring</font>, <font color="#1f32ff">$user</font>, <font color="#1f32ff">$password</font><font color="#0000ff"><b>)</b></font> = @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-connect'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-create'</font><font color="#0000ff"><b>}</b></font> and <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-create'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"ARRAY"</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$caller</font>-&gt;<font color="#ff8204">create</font><font color="#0000ff"><b>(</b></font>@<font color="#0000ff"><b>{</b></font>-args<font color="#0000ff"><b>{</b></font><font color="#007400">'create'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$connectstring</font>, <font color="#1f32ff">$user</font>, <font color="#1f32ff">$password</font><font color="#0000ff"><b>)</b></font> = 
	    <font color="#0000ff"><b>(</b></font>DEFAULT_CONNECTSTRING, DEFAULT_USER, DEFAULT_PASSWORD<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>

    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">dbh</font><font color="#0000ff"><b>(</b></font> <font color="#ff8204">DBI->connect</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$connectstring</font>, <font color="#1f32ff">$user</font>, <font color="#1f32ff">$password</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>)</b></font>;
    
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE7"></A><B>_simple_query</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE6">prev</A></TD><TD WIDTH="30"><A HREF="#CODE8">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_simple_query</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$table</font>, <font color="#1f32ff">$retr_field</font>, <font color="#1f32ff">$search_field</font>, <font color="#1f32ff">$search_value</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$q_value</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">dbh</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$search_value</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sth</font> = <font color="#1f32ff">$self</font>-&gt;dbh-&gt;prepare
	<font color="#0000ff"><b>(</b></font><font color="#007400">"SELECT DISTINCT <font color="#1f32ff">$retr_field</font> from <font color="#1f32ff">$table</font> WHERE <font color="#1f32ff">$search_field</font> = <font color="#1f32ff">$q_value</font> and <font color="#1f32ff">$retr_field</font> &lt;&gt;\&quot;\&quot;  ORDER BY <font color="#1f32ff">$retr_field</font>"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$sth</font>-&gt;execute;
    <font color="#0000ff"><b>return</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>map</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$_</font>-&gt;<font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>}</b></font> @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$sth</font>-&gt;fetchall_arrayref<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE8"></A><B>_store_matrix_data</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE7">prev</A></TD><TD WIDTH="30"><A HREF="#CODE9">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_store_matrix_data</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$pfm</font>, <font color="#1f32ff">$ACTION</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@base</font> = <font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>A C G T<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pfmatrix</font> = <font color="#1f32ff">$pfm</font>-&gt;<font color="#ff8204">matrix</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$icmatrix</font> = <font color="#1f32ff">$pfm</font>-&gt;<font color="#ff8204">to_ICM</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>-&gt;<font color="#ff8204">matrix</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwmatrix</font> = <font color="#1f32ff">$pfm</font>-&gt;<font color="#ff8204">to_PWM</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sth</font> = <font color="#1f32ff">$self</font>-&gt;dbh-&gt;prepare 
	<font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>q</b></font><font color="#007400">!! INSERT INTO matrix_data VALUES(?,?,?,?,?,?,?,?) !</font><font color="#0000ff"><b>)</b></font>;
				 
    <font color="#0000ff"><b>for</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> <font color="#0000ff"><b>(</b></font>0..3<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>for</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$j</font> <font color="#0000ff"><b>(</b></font>0..<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;<font color="#4169e1"><b>length</b></font>-1<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$sth</font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font> <font color="#1f32ff">$pfm</font>-&gt;ID,
			   <font color="#1f32ff">$pfm</font>-&gt;ID.<font color="#007400">"."</font>.<font color="#1f32ff">$base</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font>.<font color="#007400">"."</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$j</font>+1<font color="#0000ff"><b>)</b></font>,
			   <font color="#1f32ff">$base</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font>,
			   <font color="#1f32ff">$j</font>+1,
			   <font color="#1f32ff">$pfmatrix</font>-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$j</font><font color="#0000ff"><b>]</b></font>,
			   <font color="#1f32ff">$icmatrix</font>-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$j</font><font color="#0000ff"><b>]</b></font>,
			   <font color="#1f32ff">$pwmatrix</font>-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$j</font><font color="#0000ff"><b>]</b></font>,
			   <font color="#1f32ff">$pfmatrix</font>-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$j</font><font color="#0000ff"><b>]</b></font> <font color="#006400"><b>/ </b></font><font color="#1f32ff">$pfm</font><font color="#006400"><b>-&gt;column_sum())<BR>		or </b></font><font color="#1f32ff">$self</font>-&gt;throw(&quot;Error executing query.&quot;);<BR>	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE9"></A><B>_store_matrix_info</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE8">prev</A></TD><TD WIDTH="30"><A HREF="#CODE10">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_store_matrix_info</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$pfm</font>, <font color="#1f32ff">$ACTION</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sth</font> = <font color="#1f32ff">$self</font>-&gt;dbh-&gt;prepare 
	<font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>q</b></font><font color="#007400">!! INSERT INTO matrix_info<BR>	    (ID, name, type, class, phylum, width, IC, sites) <BR>	    VALUES(?,?,?,?,?,?,?,?) !</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$sth</font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;ID,
		  <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;name or <font color="#1f32ff">$pfm</font>-&gt;ID<font color="#0000ff"><b>)</b></font>,
		  <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'tags'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'type'</font><font color="#0000ff"><b>}</b></font> or <font color="#007400">""</font><font color="#0000ff"><b>)</b></font>,
		  <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;<font color="#ff8204">class</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font> or <font color="#4169e1"><b>undef</b></font><font color="#0000ff"><b>)</b></font>,
		  <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'tags'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'sysgroup'</font><font color="#0000ff"><b>}</b></font> or <font color="#4169e1"><b>undef</b></font><font color="#0000ff"><b>)</b></font>,
		  <font color="#1f32ff">$pfm</font>-&gt;<font color="#4169e1"><b>length</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>,
		  <font color="#1f32ff">$pfm</font>-&gt;<font color="#ff8204">to_ICM</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>,
		  <font color="#1f32ff">$pfm</font>-&gt;<font color="#ff8204">column_sum</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>
		  <font color="#0000ff"><b>)</b></font>
	or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Error executing query"</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE10"></A><B>_store_matrix_seqs</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE9">prev</A></TD><TD WIDTH="30"><A HREF="#CODE11">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_store_matrix_seqs</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$pfm</font>, <font color="#1f32ff">$ACTION</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>return</b></font> <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'tags'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seqdb'</font><font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$pfm</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'tags'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'acc'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sth</font> = <font color="#1f32ff">$self</font>-&gt;dbh-&gt;prepare
	<font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>q</b></font><font color="#007400">!! INSERT INTO matrix_seqs<BR>	    (ID, seq_db, seq) <BR>	    VALUES(?,?,?) !</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$sth</font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;ID,
		  <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'tags'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seqdb'</font><font color="#0000ff"><b>}</b></font> or <font color="#007400">""</font><font color="#0000ff"><b>)</b></font>,
		  <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'tags'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'acc'</font><font color="#0000ff"><b>}</b></font> or <font color="#007400">""</font><font color="#0000ff"><b>)</b></font>
		 <font color="#0000ff"><b>)</b></font>
	or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Error executing query"</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE11"></A><B>_store_matrix_species</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE10">prev</A></TD><TD WIDTH="30"><A HREF="#CODE12">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_store_matrix_species</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$pfm</font>, <font color="#1f32ff">$ACTION</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>return</b></font> <font color="#0000ff"><b>unless</b></font> <font color="#1f32ff">$pfm</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'tags'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'species'</font><font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sp</font> = <font color="#1f32ff">$pfm</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'tags'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'species'</font><font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@splist</font> = <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$sp</font><font color="#0000ff"><b>)</b></font> ? @$sp : <font color="#1f32ff">$sp</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$species</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@splist</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sth</font> = <font color="#1f32ff">$self</font>-&gt;dbh-&gt;prepare
	    <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>q</b></font><font color="#007400">!! INSERT INTO matrix_species<BR>	     (ID, species) <BR>	     VALUES(?,?) !</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$sth</font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font>-&gt;ID,
		      <font color="#1f32ff">$species</font>
		      <font color="#0000ff"><b>)</b></font>
	    or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Error executing query"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE12"></A><B>connect</B></TD><TD><A HREF="#POD1">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE11">prev</A></TD><TD WIDTH="30"><A HREF="#CODE13">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>connect</b></font>
 {<pre>    <font color="#ff0000">## a more intuitive syntax for the constructor</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font>, <font color="#1f32ff">@connection_args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$caller</font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-<font color="#4169e1"><b>connect</b></font> =&gt;\@ connection_args<font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE13"></A><B>create</B></TD><TD><A HREF="#POD2">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE12">prev</A></TD><TD WIDTH="30"><A HREF="#CODE14">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>create</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font>, <font color="#1f32ff">$connectstring</font>, <font color="#1f32ff">$user</font>, <font color="#1f32ff">$password</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$connectstring</font> 
	and <font color="#1f32ff">$connectstring</font> =~ <font color="#006400"><b>/dbi:mysql:(\w+)(.*)/</b></font><font color="#0000ff"><b>)</b></font>  
    <font color="#0000ff"><b>{</b></font>
	<font color="#ff0000">## connect to the server;</font><BR>	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$dbh</font>=<font color="#ff8204">DBI</font><font color="#0000ff"><b>(</b></font><font color="#007400">"dbi:mysql:mysql"</font>.<font color="#1f32ff">$2</font>,
			     <font color="#1f32ff">$user</font>,<font color="#1f32ff">$password</font><font color="#0000ff"><b>)</b></font>
	    or <font color="#4169e1"><b>die</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"Error connecting to the database"</font><font color="#0000ff"><b>)</b></font>; 

	<font color="#ff0000">## create database and open it</font><BR>	<font color="#1f32ff">$dbh</font>-&gt;<font color="#0000ff"><b>do</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"create database <font color="#1f32ff">$1</font>"</font><font color="#0000ff"><b>)</b></font> 
	    or <font color="#4169e1"><b>die</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"Error creating database."</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$dbh</font>-&gt;<font color="#0000ff"><b>do</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"use <font color="#1f32ff">$1</font>"</font><font color="#0000ff"><b>)</b></font>; 
	
	<font color="#ff0000">## create tables</font><BR>	<font color="#ff8204">_create_tables</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$dbh</font><font color="#0000ff"><b>)</b></font>;

	<font color="#1f32ff">$dbh</font>-&gt;disconnect;

	<font color="#ff0000">## run &quot;new&quot; with new database</font><BR>
	<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$caller</font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-<font color="#4169e1"><b>connect</b></font>=&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$connectstring</font>, <font color="#1f32ff">$user</font>, <font color="#1f32ff">$password</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>die</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"Missing or malformed connect string for "</font>.
		     <font color="#007400">"TFBS::DB::JASPAR2 connection."</font><font color="#0000ff"><b>)</b></font>; 
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE14"></A><B>dbh</B></TD><TD><A HREF="#POD3">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE13">prev</A></TD><TD WIDTH="30"><A HREF="#CODE15">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>dbh</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$dbh</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'dbh'</font><font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$dbh</font> <font color="#0000ff"><b>if</b></font> <font color="#1f32ff">$dbh</font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'dbh'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE15"></A><B>delete_Matrix_having_ID</B></TD><TD><A HREF="#POD4">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE14">prev</A></TD><TD WIDTH="30"><A HREF="#CODE16">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>delete_Matrix_having_ID</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@IDs</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>eval</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ID</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@IDs</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$q_ID</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">dbh</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$table</font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>qw</b></font>  <font color="#0000ff"><b>(</b></font>matrix_data
				    matrix_info
				    matrix_seqs
				    matrix_species<font color="#0000ff"><b>)</b></font>
				<font color="#0000ff"><b>)</b></font>
	    <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">dbh</font><font color="#0000ff"><b>(</b></font><font color="#007400">"DELETE from <font color="#1f32ff">$table</font> where ID=<font color="#1f32ff">$q_ID</font>"</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>}</b></font>
	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>return</b></font> $@;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE16"></A><B>get_MatrixSet</B></TD><TD><A HREF="#POD5">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE15">prev</A></TD><TD WIDTH="30"><A HREF="#CODE17">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_MatrixSet</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@IDlist</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_IDlist_by_query</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$mt</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-matrixtype'</font><font color="#0000ff"><b>}</b></font> or <font color="#007400">"PWM"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixset</font> = <A HREF="../MatrixSet.html"><font color="#8000ff"><b>TFBS::MatrixSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@IDlist</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>next</b></font> <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-min_ic'</font><font color="#0000ff"><b>}</b></font> 
		 and <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_total_ic</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>)</b></font> &lt; <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-min_ic'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$matrixset</font>-&gt;<font color="#ff8204">add_Matrix</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_Matrix_by_ID</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$_</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$matrixset</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE17"></A><B>get_Matrix_by_ID</B></TD><TD><A HREF="#POD6">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE16">prev</A></TD><TD WIDTH="30"><A HREF="#CODE18">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_Matrix_by_ID</b></font>
 {<pre>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$ID</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$mt</font> = <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>uc</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> or <font color="#007400">"PWM"</font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$ID</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"No ID passed to get_Matrix_by_ID"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixobj</font>;
    <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>no</b></font> strict <font color="#007400">'refs'</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ucmt</font> = <font color="#4169e1"><b>uc</b></font> <font color="#1f32ff">$mt</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixstring</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_matrixstring</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ID</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> || <font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>undef</b></font>;
	
	<font color="#0000ff"><b>eval</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"\<font color="#1f32ff">$matrixobj</font>= TFBS::Matrix::<font color="#1f32ff">$ucmt</font>-&gt;new"</font>.<font color="#007400">' <BR>	    ( -ID    =&gt; $ID,<BR>	      -name  =&gt; $self-&gt;_get_name($ID).&quot;&quot;,<BR>	      -class =&gt; $self-&gt;_get_class($ID).&quot;&quot;,<BR>              -tags  =&gt; { &quot;medline&quot; =&gt; ($self-&gt;_get_medline($ID) or  &quot;&quot;),<BR>		          &quot;species&quot; =&gt; ($self-&gt;_get_species($ID) or &quot;&quot;),<BR>		          &quot;sysgroup&quot;=&gt; ($self-&gt;_get_sysgroup($ID) or &quot;&quot;),<BR>		          &quot;type&quot;    =&gt; ($self-&gt;_get_type($ID) or &quot;&quot;),<BR>		          &quot;seqdb&quot;   =&gt; ($self-&gt;_get_seqdb($ID) or &quot;&quot;),<BR>		          &quot;acc&quot;     =&gt; ($self-&gt;_get_acc($ID) or &quot;&quot;),<BR>		          &quot;total_ic&quot;=&gt; ($self-&gt;_get_total_ic($ID) or &quot;&quot;)<BR>                        },<BR>	      -matrix=&gt; $matrixstring   # FIXME - temporary<BR>	      );'</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font>$@<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font>$@<font color="#0000ff"><b>)</b></font>; <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>

    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$matrixobj</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE18"></A><B>get_Matrix_by_name</B></TD><TD><A HREF="#POD7">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE17">prev</A></TD><TD WIDTH="30"><A HREF="#CODE19">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_Matrix_by_name</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$name</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>unless</b></font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$name</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font> 
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"No name passed to get_Matrix_by_name."</font><font color="#0000ff"><b>)</b></font>; <font color="#0000ff"><b>}</b></font>

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@IDlist</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_IDlist_by_query</font><font color="#0000ff"><b>(</b></font>-names=&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$name</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ID</font>= <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$IDlist</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font> 
	    or <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>warn</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"No matrix with name <font color="#1f32ff">$name</font> found."</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$L</font>= <font color="#4169e1"><b>scalar</b></font> <font color="#1f32ff">@IDlist</font><font color="#0000ff"><b>)</b></font> &gt; 1<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>warn</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"There are <font color="#1f32ff">$L</font> matrices with name '$name'"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_Matrix_by_ID</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ID</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE19"></A><B>new</B></TD><TD><A HREF="#POD8">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE18">prev</A></TD><TD WIDTH="30"><A HREF="#CODE20">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>new</b></font>
 {<pre>  _new <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@_</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE20"></A><B>store_Matrix</B></TD><TD><A HREF="#POD9">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE19">prev</A></TD><TD WIDTH="30"><A HREF="#CODE21">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>store_Matrix</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@PFMs</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$err</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pfm</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@PFMs</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>eval</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_store_matrix_data</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_store_matrix_info</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_store_matrix_seqs</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_store_matrix_species</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pfm</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> $@;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE21"></A><B>store_MatrixSet</B></TD><TD><A HREF="#POD10">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE20">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>store_MatrixSet</b></font>
 {<pre>    <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;throw <font color="#0000ff"><b>(</b></font><font color="#007400">"Method store_MtrixSet not yet implemented."</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_JASPAR2 DATA MODEL"><B>JASPAR2 DATA MODEL</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>JASPAR2 is working name for a relational database model used<BR>for storing transcriptional factor pattern matrices in a MySQL database.<BR>It was initially designed to store matrices for the JASPAR database of<BR>high quality eukaryotic transcription factor specificity profiles by<BR>Albin Sandelin and Wyeth W. Wasserman. Besides the profile matrix itself,<BR>this data model stores profile ID (unique), name, structural class,<BR>basic taxonomic and bibliographic information<BR>as well as some additional optional tags.<BR><BR>Due to its data model, which precedeed the design of the <BR>module, <B>TFBS::DB::JASPAR2</B> cannot store arbitrary tags for a matrix.<BR><BR>The supported tags are<BR>    'acc'      # (accession number; <BR>	       # originally for transcription factor protein seq)<BR>    'seqdb'    # sequence database where 'acc' comes from<BR>    'medline'  # PubMed ID<BR>    'species'  # Species name<BR>    'sysgroup'<BR>    'total_ic' # total information content - redundant, present <BR>               # for historical<BR>&quot;medline&quot; =&gt; ($self-&gt;_get_medline($ID) or  &quot;&quot;),<BR>		          &quot;species&quot; =&gt; ($self-&gt;_get_species($ID) or &quot;&quot;),<BR>		          &quot;sysgroup&quot;=&gt; ($self-&gt;_get_sysgroup($ID) or &quot;&quot;),<BR>		          &quot;type&quot;    =&gt; ($self-&gt;_get_type($ID) or &quot;&quot;),<BR>		          &quot;seqdb&quot;   =&gt; ($self-&gt;_get_seqdb($ID) or &quot;&quot;),<BR>		          &quot;acc&quot;     =&gt; ($self-&gt;_get_acc($ID) or &quot;&quot;),<BR>		          &quot;total_ic&quot;=<BR><BR>-----------------------  ADVANCED  ---------------------------------<BR><BR>For the developers and the curious, here is the JASPAR2 data model:<BR><BR>       CREATE TABLE matrix_data (<BR>         ID varchar(16) DEFAULT '' NOT NULL,<BR>         pos_ID varchar(24) DEFAULT '' NOT NULL,<BR>         base enum('A','C','G','T'),<BR>         position tinyint(3) unsigned,<BR>         raw int(3) unsigned,<BR>         info float(7,5) unsigned, -- calculated<BR>         pwm float(7,5) unsigned,  -- calculated<BR>         normalized float(7,5) unsigned,<BR>         PRIMARY KEY (pos_ID),<BR>         KEY id_index (ID)<BR>       );<BR><BR>       CREATE TABLE matrix_info (<BR>         ID varchar(16) DEFAULT '' NOT NULL,<BR>         name varchar(15) DEFAULT '' NOT NULL,<BR>         type varchar(8) DEFAULT '' NOT NULL,<BR>         class varchar(20),<BR>         phylum varchar (32),          -- maps to 'sysgroup' tag<BR>         litt varchar(40),             -- not used by this module<BR>         medline int(12),<BR>         information varchar(20),      -- not used by this module<BR>         iterations varchar(6),<BR>         width int(2),                 -- calculated<BR>         consensus varchar(25),        -- calculated<BR>         IC float(6,4),                -- maps to 'total_ic' tag<BR>         sites int(3) unsigned,        -- not used by this module<BR>         PRIMARY KEY (ID)<BR>       )<BR><BR>       CREATE TABLE matrix_seqs (<BR>         ID varchar(16) DEFAULT '' NOT NULL,<BR>         internal varchar(8) DEFAULT '' NOT NULL,<BR>         seq_db varchar(15) NOT NULL,<BR>         seq varchar(10) NOT NULL,<BR>         PRIMARY KEY (ID, seq_db, seq)<BR>       )<BR><BR>       CREATE TABLE matrix_species (<BR>         ID varchar(16) DEFAULT '' NOT NULL,<BR>         internal varchar(8) DEFAULT '' NOT NULL,<BR>         species varchar(24) NOT NULL,<BR>         PRIMARY KEY (ID, species)<BR>       )<BR><BR>It is our best intention to hide the details of this data model, which we <BR>are using on a daily basis in our work, from most TFBS users, simply <BR>because for historical reasons some table column names are confusing <BR>at best. Most users should only know the methods to store the data and <BR>which tags are supported.<BR><BR>-------------------------------------------------------------------------<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_FEEDBACK"><B>FEEDBACK</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Please send bug reports and other comments to the author.<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_AUTHOR - Boris Lenhard"><B>AUTHOR - Boris Lenhard</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Boris Lenhard <a href="mailto:Boris.Lenhard@cgb.ki.seE">Boris.Lenhard@cgb.ki.seE</a>i.se&gt;<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_APPENDIX"><B>APPENDIX</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>The rest of the documentation details each of the object<BR>methods. Internal methods are preceded with an underscore.<BR></pre>
</TD></TR>
</TABLE>
</body>
</html>
