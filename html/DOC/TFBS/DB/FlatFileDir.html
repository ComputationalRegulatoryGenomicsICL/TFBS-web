<head>
<!-- Generated by perlmod2www.pl -->
<title>
FlatFileDir documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS::DB</H4>
<H3>FlatFileDir</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#SUMMARY">Summary</A></TD>
<TD><A HREF="#libs">Included libraries</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#SYNOPSIS">Synopsis</A></TD>
<TD><A HREF="#DESCRIPTION">Description</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR><TD BGCOLOR="#ffae84"><B>Summary</B></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD><pre><B>TFBS::DB::FlatFileDir</B> - interface to a database of pattern matrices<BR>stored as a collection of flat files in a dedicated directory<BR></pre></TD></TR>
</TABLE>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR><TD COLSPAN="2">No package variables defined.</TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Root::Root</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../Matrix/ICM.html">TFBS::Matrix::ICM</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../Matrix/PFM.html">TFBS::Matrix::PFM</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../Matrix/PWM.html">TFBS::Matrix::PWM</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../MatrixSet.html">TFBS::MatrixSet</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
</TABLE>
<A NAME="libs"></A><TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Inherit</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD><b><font color="#0000ff">Bio::Root::Root</font></b> <b><font color="#0000ff"><a href="../DB.html">TFBS::DB</a></font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><BR><A NAME="_pod_* creating a database object by connecting to the existing directory">    * creating a database object by connecting to the existing directory</A><BR>        my $db = <B>TFBS::DB::FlatFileDir</B>-&gt;connect(&quot;/home/boris/MatrixDir&quot;);<BR><BR><A NAME="_pod_* retrieving a TFBS::Matrix::* object from the database">    * retrieving a TFBS::Matrix::* object from the database</A><BR>        # retrieving a PFM by ID<BR>    my $pfm = $db-&gt;get_Matrix_by_ID('M00079','PFM');<BR> <BR>    #retrieving a PWM by name<BR>    my $pwm = $db-&gt;get_Matrix_by_name('NF-kappaB', 'PWM');<BR><BR><A NAME="_pod_">    </A><BR><A NAME="_pod_">    </A><BR><A NAME="_pod_* storing a matrix in the database:">    * storing a matrix in the database:</A><BR>        #let $pfm is a TFBS::Matrix::PFM object<BR>    $db-&gt;store_Matrix($pfm);<BR><BR><BR></pre>
</TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><B>TFBS::DB::FlatFileDir</B> is a read/write database interface module that<BR>retrieves and stores TFBS::Matrix::* and TFBS::MatrixSet<BR>objects in a set of flat files in a dedicated directory. It has a<BR>very simple structure and can be easily set up manually if desired.<BR></pre>
</TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>_check_matrixtype</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>_load_db_index</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>_read_file</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>_update_db_index</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>connect</B></TD><TD><A HREF="#POD1">Description</A></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>create</B></TD><TD><A HREF="#POD2">Description</A></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
<TR><TD><B>delete_Matrix_having_ID</B></TD><TD><A HREF="#POD3">Description</A></TD><TD><A HREF="#CODE7">Code</A></TD></TR>
<TR><TD><B>get_MatrixSet</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE8">Code</A></TD></TR>
<TR><TD><B>get_Matrix_by_ID</B></TD><TD><A HREF="#POD4">Description</A></TD><TD><A HREF="#CODE9">Code</A></TD></TR>
<TR><TD><B>get_Matrix_by_name</B></TD><TD><A HREF="#POD5">Description</A></TD><TD><A HREF="#CODE10">Code</A></TD></TR>
<TR><TD><B>get_matrix</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE11">Code</A></TD></TR>
<TR><TD><B>new</B></TD><TD><A HREF="#POD6">Description</A></TD><TD><A HREF="#CODE12">Code</A></TD></TR>
<TR><TD><B>store_Matrix</B></TD><TD><A HREF="#POD7">Description</A></TD><TD><A HREF="#CODE13">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_connect"></A><A NAME="POD1"></A><B>connect</B></TD><TD><A HREF="#CODE5">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD>prev</TD><TD><A HREF="#POD2">next</A></TD></TR></TABLE>
<pre> Title   : connect<BR> Usage   : my $db = <B>TFBS::DB::FlatFileDir</B>-&gt;connect($directory);<BR> Function: Creates a database object that retrieves TFBS::Matrix::*<BR>	   object data from or stores it in an existing directory<BR> Returns : a <B>TFBS::DB::FlatFileDir</B> object<BR> Args    : ($directory)<BR>	    The name of the directory (possibly with fully qualified<BR>	    path).<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_create"></A><A NAME="POD2"></A><B>create</B></TD><TD><A HREF="#CODE6">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD1">prev</A></TD><TD><A HREF="#POD3">next</A></TD></TR></TABLE>
<pre> Title   : create<BR> Usage   : my $newdb = <B>TFBS::DB::FlatFileDir</B>-&gt;create($new_directory);<BR> Function: connects to the database server, creates a new directory,<BR>	   sets up a FlatFileDir database and returns a database<BR>	   object that interfaces the database<BR> Returns : a <B>TFBS::DB::FlatFileDir</B> object<BR> Args    : ($new_directory)<BR>	    The name of the directory to create<BR>	    (possibly with fully qualified path).<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_delete_Matrix_having_ID"></A><A NAME="POD3"></A><B>delete_Matrix_having_ID</B></TD><TD><A HREF="#CODE7">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD2">prev</A></TD><TD><A HREF="#POD4">next</A></TD></TR></TABLE>
<pre> Title   : delete_Matrix_having_ID<BR> Usage   : $db-&gt;delete_Matrix_with_ID('M00045');<BR> Function: Deletes the matrix having the given ID from the database<BR> Returns : 0 on success; $@ contents on failure<BR>	   (this is too C-like and may change in future versions)<BR> Args    : (ID)<BR>	   A string<BR> Comment : Yeah, yeah, 'delete_Matrix_having_ID' is a stupid name<BR>	   for a method, but at least it should be obviuos what it does.<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_Matrix_by_ID"></A><A NAME="POD4"></A><B>get_Matrix_by_ID</B></TD><TD><A HREF="#CODE9">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD3">prev</A></TD><TD><A HREF="#POD5">next</A></TD></TR></TABLE>
<pre> Title   : get_Matrix_by_ID<BR> Usage   : my $pfm = $db-&gt;get_Matrix_by_ID('M00034', 'PFM');<BR> Function: fetches matrix data under the given ID from the<BR>           database and returns a TFBS::Matrix::* object<BR> Returns : a TFBS::Matrix::* object; the exact type of the<BR>	   object depending on the second argument (allowed<BR>	   values are 'PFM', 'ICM', and 'PWM'); returns undef if<BR>	   matrix with the given ID is not found<BR> Args    : (Matrix_ID, Matrix_type)<BR>	   Matrix_ID is a string; Matrix_type is one of the<BR>	   following: 'PFM' (raw position frequency matrix),<BR>	   'ICM' (information content matrix) or 'PWM' (position<BR>	   weight matrix)<BR>	   If Matrix_type is omitted, a PWM is retrieved by default.<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_Matrix_by_name"></A><A NAME="POD5"></A><B>get_Matrix_by_name</B></TD><TD><A HREF="#CODE10">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD4">prev</A></TD><TD><A HREF="#POD6">next</A></TD></TR></TABLE>
<pre> Title   : get_Matrix_by_name<BR> Usage   : my $pfm = $db-&gt;get_Matrix_by_name('HNF-1', 'PWM');<BR> Function: fetches matrix data under the given name from the<BR>	   database and returns a TFBS::Matrix::* object<BR> Returns : a TFBS::Matrix::* object; the exact type of the object<BR>	   depending on the second argument (allowed values are<BR>	   'PFM', 'ICM', and 'PWM')<BR> Args    : (Matrix_name, Matrix_type)<BR>	   Matrix_name is a string; Matrix_type is one of the<BR>	   following:<BR>	   'PFM' (raw position frequency matrix),<BR>	   'ICM' (information content matrix) or<BR>	   'PWM' (position weight matrix)<BR>	   If Matrix_type is omitted, a PWM is retrieved by default.<BR> Warning : According to the current JASPAR2 data model, name is<BR>	   not necessarily a unique identifier. In the case where<BR>	   there are several matrices with the same name in the<BR>	   database, the function fetches the first one and prints<BR>	   a warning on STDERR. You have been warned.<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_new"></A><A NAME="POD6"></A><B>new</B></TD><TD><A HREF="#CODE12">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD5">prev</A></TD><TD><A HREF="#POD7">next</A></TD></TR></TABLE>
<pre> Title   : new<BR> Usage   : my $db = <B>TFBS::DB::FlatFileDir</B>-&gt;new(%args);<BR> Function: the formal constructor for the <B>TFBS::DB::FlatFileDir</B> object;<BR>	   most users will not use it - they will use specialized<BR>	   <i>connect</i> or <i>create</i> constructors to create a<BR>	   database object<BR> Returns : a <B>TFBS::DB::FlatFileDir</B> object<BR> Args    : -dir       # the directory containing flat files<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_store_Matrix"></A><A NAME="POD7"></A><B>store_Matrix</B></TD><TD><A HREF="#CODE13">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD6">prev</A></TD><TD><A HREF="#POD8">next</A></TD></TR></TABLE>
<pre> Title   : store_Matrix<BR> Usage   : $db-&gt;store_Matrix($matrixobj);<BR> Function: Stores the contents of a TFBS::Matrix::DB object in the database<BR> Returns : 0 on success; $@ contents on failure<BR>	   (this is too C-like and may change in future versions)<BR> Args    : ($matrixobj) # a TFBS::Matrix::* object<BR></pre>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>_check_matrixtype</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_check_matrixtype</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$mt</font> = <font color="#4169e1"><b>uc</b></font> <font color="#1f32ff">$mt</font>;
    <font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>undef</b></font> <font color="#0000ff"><b>unless</b></font> <font color="#1f32ff">$mt</font>;
    <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font> <font color="#1f32ff">$mt</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"PFM"</font>
	    or <font color="#1f32ff">$mt</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"ICM"</font>
	    or <font color="#1f32ff">$mt</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"PWM"</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Unsupported matrix type: "</font>.<font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$mt</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>_load_db_index</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_load_db_index</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$field</font>, <font color="#1f32ff">$value</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$DIR</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dir<font color="#0000ff"><b>}</b></font>;
    <font color="#4169e1"><b>open</b></font> <font color="#0000ff"><b>(</b></font>MATRIXLIST, <font color="#007400">"<font color="#1f32ff">$DIR</font>/matrix_list.txt"</font><font color="#0000ff"><b>)</b></font>
	or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Could not read matrix list <font color="#1f32ff">$DIR</font>/matrix_list.txt"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$line</font> = &lt;MATRIXLIST&gt;<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>chomp</b></font> <font color="#1f32ff">$line</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ID</font>, <font color="#1f32ff">$ic</font>, <font color="#1f32ff">$name</font>, <font color="#1f32ff">$class</font><font color="#0000ff"><b>)</b></font> = <font color="#4169e1"><b>split</b></font> <font color="#006400"><b>/\s+/</b></font>, <font color="#1f32ff">$line</font> ;
	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ID</font> =~ <font color="#006400"><b>/(\w+)\.(\w+)$/</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$ID</font> = <font color="#1f32ff">$1</font>;
	<font color="#0000ff"><b>}</b></font>
	
	<font color="#4169e1"><b>defined</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> 
	    and <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>warn</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"Duplicate entries for ID <font color="#1f32ff">$ID</font>"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>}</b></font> = <font color="#0000ff"><b>{</b></font>name=&gt;<font color="#1f32ff">$name</font>, ic=&gt;<font color="#1f32ff">$ic</font>, class=&gt;<font color="#1f32ff">$class</font><font color="#0000ff"><b>}</b></font>;
	<font color="#4169e1"><b>push</b></font> @<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_idlist_of_name<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$name</font><font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$ID</font>;
	<font color="#4169e1"><b>push</b></font> @<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_idlist_of_class<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$class</font><font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$ID</font>;
	<font color="#ff0000">## annoatation</font><BR>	
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@anno</font>= <font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>(</b></font><font color="#006400"><b>/\s?;\s?/</b></font>, <font color="#1f32ff">$line</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%tags</font>;
        <font color="#4169e1"><b>shift</b></font> <font color="#1f32ff">@anno</font>;
	<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@anno</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
            <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$name</font>, <font color="#1f32ff">$val</font><font color="#0000ff"><b>)</b></font>=<font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>(</b></font><font color="#006400"><b>/\s?\&quot;/</b></font>, <font color="#1f32ff">$_</font><font color="#0000ff"><b>)</b></font>;
	  <font color="#ff0000">##  print &quot;$name $val\n&quot;;</font><BR>	    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'tags'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$name</font><font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$val</font>;
	  
	<font color="#0000ff"><b>}</b></font>
	
	
	
    <font color="#0000ff"><b>}</b></font>
    <font color="#4169e1"><b>close</b></font> MATRIXLIST;
    <font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>scalar</b></font> <font color="#4169e1"><b>keys</b></font> %<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font>;  <font color="#ff0000">## false if list empty</font><BR></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>_read_file</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_read_file</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$id</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>local</b></font> $/ = <font color="#4169e1"><b>undef</b></font>;
    <font color="#4169e1"><b>open</b></font> FILE, <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dir<font color="#0000ff"><b>}</b></font>.<font color="#007400">"/<font color="#1f32ff">$id</font>."</font>.<font color="#4169e1"><b>lc</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> or <font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>undef</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixstring</font> = &lt;FILE&gt;; <font color="#ff0000">##slurp;</font><BR>    <font color="#4169e1"><b>close</b></font> FILE;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$matrixstring</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>_update_db_index</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_update_db_index</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#4169e1"><b>rename</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dir<font color="#0000ff"><b>}</b></font>.<font color="#007400">"/matrix_list.txt"</font>, <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dir<font color="#0000ff"><b>}</b></font>.<font color="#007400">"/~matrix_list.txt"</font>;
    <font color="#4169e1"><b>open</b></font> FILE, <font color="#007400">"&gt;"</font>.<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dir<font color="#0000ff"><b>}</b></font>.<font color="#007400">"/matrix_list.txt"</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ID</font> <font color="#0000ff"><b>(</b></font> <font color="#4169e1"><b>keys</b></font> %<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>print</b></font> FILE <font color="#4169e1"><b>join</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"\t"</font>, 	<font color="#1f32ff">$ID</font>,
				<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font>ic<font color="#0000ff"><b>}</b></font>,
				<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font>name<font color="#0000ff"><b>}</b></font>,
				<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font>class<font color="#0000ff"><b>}</b></font>
			<font color="#0000ff"><b>)</b></font>.<font color="#007400">"\t"</font>;
<font color="#ff0000">##   add tagged annotation	</font><BR><font color="#ff0000">##  my %tag = $self-&gt;{_item}-&gt;{$ID}-&gt;{'all_tags'};</font><BR>     <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$name</font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>sort</b></font> <font color="#4169e1"><b>keys</b></font> %<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'_item'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>{</b></font><font color="#007400">'tag'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
         
         <font color="#4169e1"><b>print</b></font> FILE <font color="#007400">"; "</font>, <font color="#1f32ff">$name</font>, <font color="#007400">"\&quot; "</font>, <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'_item'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>{</b></font><font color="#007400">'tag'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$name</font><font color="#0000ff"><b>}</b></font>, <font color="#007400">"\&quot;\ "</font>;
         
     <font color="#0000ff"><b>}</b></font>
     
    
     
     
     
<font color="#4169e1"><b>print</b></font> FILE <font color="#007400">"\n"</font>;


	
    <font color="#0000ff"><b>}</b></font>
    <font color="#4169e1"><b>close</b></font> FILE;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>connect</B></TD><TD><A HREF="#POD1">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>connect</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font>, <font color="#1f32ff">$dir</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$caller</font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-dir=&gt;<font color="#1f32ff">$dir</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>create</B></TD><TD><A HREF="#POD2">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30"><A HREF="#CODE7">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>create</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font>, <font color="#1f32ff">$dir</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font>-d <font color="#1f32ff">$dir</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font> <font color="#4169e1"><b>die</b></font> <font color="#0000ff"><b>(</b></font><font color="#007400">"Directory <font color="#1f32ff">$dir</font> exists"</font><font color="#0000ff"><b>)</b></font> ; <font color="#0000ff"><b>}</b></font> 
    <font color="#4169e1"><b>mkdir</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$dir</font><font color="#0000ff"><b>)</b></font> or  <font color="#4169e1"><b>die</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"Error creating directory <font color="#1f32ff">$dir</font>, stopped"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#4169e1"><b>open</b></font> FILE, <font color="#007400">"&gt;<font color="#1f32ff">$dir</font>/matrix_list.txt"</font>
	or <font color="#4169e1"><b>die</b></font> <font color="#0000ff"><b>(</b></font><font color="#007400">"Error creating matrix_list.txt"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#4169e1"><b>close</b></font> FILE;
    <font color="#1f32ff">$caller</font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-dir=&gt;<font color="#1f32ff">$dir</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE7"></A><B>delete_Matrix_having_ID</B></TD><TD><A HREF="#POD3">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE6">prev</A></TD><TD WIDTH="30"><A HREF="#CODE8">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>delete_Matrix_having_ID</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$ID</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$DIR</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dir<font color="#0000ff"><b>}</b></font>;
    <font color="#4169e1"><b>unlink</b></font> &lt;<font color="#1f32ff">$DIR</font><font color="#006400"><b>/</b></font><font color="#1f32ff">$ID</font>.*&gt;;<BR>    <font color="#4169e1"><b>delete</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ID</font><font color="#0000ff"><b>}</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_update_db_index</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE8"></A><B>get_MatrixSet</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE7">prev</A></TD><TD WIDTH="30"><A HREF="#CODE9">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_MatrixSet</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$DIR</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>db<font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$arrayref</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$mt</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_check_matrixtype</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-matrixtype<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
	|| <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"No matrix type provided."</font><font color="#0000ff"><b>)</b></font>;
    <font color="#4169e1"><b>delete</b></font> <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-matrixtype'</font><font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$field</font>, <font color="#1f32ff">$value</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">%args</font>;
    <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$field</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$field</font>=<font color="#007400">"-IDs"</font>;
	<font color="#1f32ff">$arrayref</font> = <font color="#0000ff"><b>[</b></font> <font color="#4169e1"><b>keys</b></font> %<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>]</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@IDlist</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$field</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"-IDs"</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">@IDlist</font> = @$arrayref;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$field</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"-names"</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>(</b></font>@$arrayref<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@IDlist</font>, @<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_idlist_of_name<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font>;
	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$field</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"-classes"</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>(</b></font>@$arrayref<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@IDlist</font>, @<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_idlist_of_class<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font>;
	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Unknown matrixset selector: <font color="#1f32ff">$field</font>."</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixset</font> = <A HREF="../MatrixSet.html"><font color="#8000ff"><b>TFBS::MatrixSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ID</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@IDlist</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$matrixset</font>-&gt;<font color="#ff8204">add_matrix</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_Matrix_by_ID</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ID</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#4169e1"><b>close</b></font> MATRIXLIST;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$matrixset</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE9"></A><B>get_Matrix_by_ID</B></TD><TD><A HREF="#POD4">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE8">prev</A></TD><TD WIDTH="30"><A HREF="#CODE10">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_Matrix_by_ID</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$ID</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"No ID passed to get_Matrix_by_ID."</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>unless</b></font> <font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$ID</font>;
    <font color="#1f32ff">$mt</font> = <font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$mt</font> ? <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_check_matrixtype</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> : <font color="#007400">"PWM"</font>; 
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixobj</font>;
    <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>no</b></font> strict <font color="#007400">'refs'</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$working_mt</font> = <font color="#1f32ff">$mt</font> = <font color="#4169e1"><b>uc</b></font> <font color="#1f32ff">$mt</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixstring</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_read_file</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ID</font>,<font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font>
			    <font color="#ff0000">## if no desired $mt, is there a PFM?</font><BR>			    || <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_read_file</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ID</font>,<font color="#1f32ff">$working_mt</font>=<font color="#007400">"PFM"</font><font color="#0000ff"><b>)</b></font>
			    || <font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>undef</b></font>;

	<font color="#0000ff"><b>eval</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"\<font color="#1f32ff">$matrixobj</font>= TFBS::Matrix::<font color="#1f32ff">$working_mt</font>-&gt;new"</font>.<font color="#007400">' <BR>	    ( -ID    =&gt; $ID,<BR>	      -name  =&gt; $self-&gt;{_item}-&gt;{$ID}-&gt;{name} ||  &quot;&quot;,<BR>	      -class =&gt; $self-&gt;{_item}-&gt;{$ID}-&gt;{class}||  &quot;&quot;,<BR>	      -matrix=&gt; $matrixstring, <BR>	      -tags=&gt; $self-&gt;{_item}-&gt;{$ID}-&gt;{tags}<BR>	      <BR>	      );'</font>.
	     <font color="#007400">"if (\<font color="#1f32ff">$working_mt</font> ne\$ mt) {\<font color="#1f32ff">$matrixobj</font> =\$ matrixobj-&gt;to_<font color="#1f32ff">$mt</font>;}"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font>$@<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font>$@<font color="#0000ff"><b>)</b></font>; <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#ff0000">## print &quot;MATRIXOBJ: $matrixobj\n&quot;;</font><BR>    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$matrixobj</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE10"></A><B>get_Matrix_by_name</B></TD><TD><A HREF="#POD5">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE9">prev</A></TD><TD WIDTH="30"><A HREF="#CODE11">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_Matrix_by_name</b></font>
 {<pre>      <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$name</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ID</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_idlist_of_name<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$name</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font> 
	    or <font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>undef</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$L</font>= <font color="#4169e1"><b>scalar</b></font> @<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_idlist_of_name<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$name</font><font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> &gt; 1<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>warn</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"There are <font color="#1f32ff">$L</font> matrices with name '$name'"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_Matrix_by_ID</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ID</font>, <font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE11"></A><B>get_matrix</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE10">prev</A></TD><TD WIDTH="30"><A HREF="#CODE12">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_matrix</b></font>
 {<pre>    <font color="#ff0000">## an obsolete method - kept for the time being for backward compatibility</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$DIR</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dir<font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ID</font>;
    <font color="#ff0000">## retrieval from .pwm files in a directory</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$mt</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_matrixtype_from_args</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>
	or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"No -matrixtype provided."</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-ID<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font> 
	<font color="#1f32ff">$ID</font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-ID<font color="#0000ff"><b>}</b></font>; 
    <font color="#0000ff"><b>}</b></font>
	<font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$name</font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-name<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font> 
	<font color="#1f32ff">$ID</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_idlist_of_name<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$name</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font> 
	    or <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>warn</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"No matrix with name <font color="#1f32ff">$name</font> found."</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$L</font>= <font color="#4169e1"><b>scalar</b></font> @<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_idlist_of_name<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$name</font><font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> &gt; 1<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>warn</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"There are <font color="#1f32ff">$L</font> matrices with name '$name'"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"No -ID or -name passed to "</font>.<font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
	
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixobj</font>;
    <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>no</b></font> strict <font color="#007400">'refs'</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ucmt</font> = <font color="#4169e1"><b>uc</b></font> <font color="#1f32ff">$mt</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixstring</font> =`cat <font color="#1f32ff">$DIR</font><font color="#006400"><b>/</b></font><font color="#1f32ff">$ID</font><font color="#006400"><b>.</b></font><font color="#1f32ff">$mt</font>`;<BR>
	<font color="#0000ff"><b>eval</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"\<font color="#1f32ff">$matrixobj</font>= TFBS::Matrix::<font color="#1f32ff">$ucmt</font>-&gt;new"</font>.<font color="#007400">' <BR>	    ( -ID    =&gt; $ID,<BR>	      -name  =&gt; $self-&gt;{_item}-&gt;{$ID}-&gt;{name},<BR>	      -class =&gt; $self-&gt;{_item}-&gt;{$ID}-&gt;{class},<BR>	      -matrix=&gt; $matrixstring   # FIXME - temporary<BR>	      );'</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font>$@<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font>$@<font color="#0000ff"><b>)</b></font>; <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#ff0000">## print &quot;MATRIXOBJ: $matrixobj\n&quot;;</font><BR>    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$matrixobj</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE12"></A><B>new</B></TD><TD><A HREF="#POD6">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE11">prev</A></TD><TD WIDTH="30"><A HREF="#CODE13">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>new</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$caller</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>bless</b></font> <font color="#0000ff"><b>{</b></font>_item =&gt; <font color="#0000ff"><b>{</b></font><font color="#0000ff"><b>}</b></font>, 
		      _idlist_of_name=&gt;<font color="#0000ff"><b>{</b></font><font color="#0000ff"><b>}</b></font> , 
		      _idlist_of_class=&gt;<font color="#0000ff"><b>{</b></font><font color="#0000ff"><b>}</b></font>
		     <font color="#0000ff"><b>}</b></font>, 
                 <font color="#4169e1"><b>ref</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font><font color="#0000ff"><b>)</b></font> || <font color="#1f32ff">$caller</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font>-d <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dir<font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">'-dir'</font> and -d <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dir<font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Error initializing FlatFileDir database dir: "</font>,
		     <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> or <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font> or <font color="#007400">"No directory parameter passed."</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_load_db_index</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>; 
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE13"></A><B>store_Matrix</B></TD><TD><A HREF="#POD7">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE12">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>store_Matrix</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$matrixobj</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$matrixobj</font> =~ <font color="#006400"><b>/TFBS::Matrix::(\w+)/</b></font><font color="#0000ff"><b>)</b></font>
	or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Wrong type of object passed to store_Matrix."</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$matrixobj</font>-&gt;<font color="#ff8204">ID</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"ID "</font>.<font color="#1f32ff">$matrixobj</font>-&gt;<font color="#ff8204">ID</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>.<font color="#007400">" exists in the database."</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixfile</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dir<font color="#0000ff"><b>}</b></font>.<font color="#007400">"/"</font>.<font color="#1f32ff">$matrixobj</font>-&gt;<font color="#ff8204">ID</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>.<font color="#007400">"."</font>.<font color="#4169e1"><b>lc</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$mt</font><font color="#0000ff"><b>)</b></font>;
	<font color="#4169e1"><b>open</b></font> FILE, <font color="#007400">"&gt;<font color="#1f32ff">$matrixfile</font>"</font>
	    or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Could not write file <font color="#1f32ff">$matrixfile</font>."</font><font color="#0000ff"><b>)</b></font>;
	<font color="#4169e1"><b>print</b></font> FILE <font color="#1f32ff">$matrixobj</font>-&gt;rawprint;
	<font color="#4169e1"><b>close</b></font> FILE;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ic</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$mt</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"ICM"</font><font color="#0000ff"><b>)</b></font> ? <font color="#1f32ff">$matrixobj</font>-&gt;total_ic :
		    <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$mt</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"PFM"</font><font color="#0000ff"><b>)</b></font> ? <font color="#1f32ff">$matrixobj</font>-&gt;to_ICM-&gt;total_ic : <font color="#007400">""</font>; 
	<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$matrixobj</font>-&gt;<font color="#ff8204">ID</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>}</b></font> = <font color="#0000ff"><b>{</b></font> <font color="#007400">'name'</font> =&gt; <font color="#1f32ff">$matrixobj</font>-&gt;name || <font color="#007400">""</font>,
					       <font color="#007400">'ic'</font>   =&gt; <font color="#1f32ff">$ic</font>,
					       <font color="#007400">'class'</font>=&gt; <font color="#1f32ff">$matrixobj</font>-&gt;class || <font color="#007400">""</font> <font color="#0000ff"><b>}</b></font>;
	
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%tags</font>= <font color="#1f32ff">$matrixobj</font>-&gt;<font color="#ff8204">all_tags</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$named_tag</font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>keys</b></font> <font color="#1f32ff">%tags</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
	   <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_item<font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$matrixobj</font>-&gt;<font color="#ff8204">ID</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>{</b></font><font color="#007400">'tag'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$named_tag</font><font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$tags</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$named_tag</font><font color="#0000ff"><b>}</b></font>; 
           <font color="#ff0000">## print $named_tag , &quot; &quot;, $self-&gt;{_item}-&gt;{$matrixobj-&gt;ID()}{'tag'}{$named_tag}, &quot;\n&quot;;</font><BR>
	<font color="#0000ff"><b>}</b></font>
	
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_update_db_index</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> 0;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_FEEDBACK"><B>FEEDBACK</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Please send bug reports and other comments to the author.<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_AUTHOR - Boris Lenhard"><B>AUTHOR - Boris Lenhard</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Boris Lenhard <a href="mailto:Boris.Lenhard@cgb.ki.seE">Boris.Lenhard@cgb.ki.seE</a>i.se&gt;<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_APPENDIX"><B>APPENDIX</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>The rest of the documentation details each of the object<BR>methods. Internal methods are preceded with an underscore.<BR></pre>
</TD></TR>
</TABLE>
</body>
</html>
