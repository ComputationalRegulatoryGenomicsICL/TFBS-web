<head>
<!-- Generated by perlmod2www.pl -->
<title>
MatrixSet documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS</H4>
<H3>MatrixSet</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#SUMMARY">Summary</A></TD>
<TD><A HREF="#libs">Included libraries</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#SYNOPSIS">Synopsis</A></TD>
<TD><A HREF="#DESCRIPTION">Description</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR><TD BGCOLOR="#ffae84"><B>Summary</B></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD><pre>TFBS::Matrix::Set - an agregate class representing a set of matrix patterns, containing methods for manipulating the set as a whole<BR></pre></TD></TR>
</TABLE>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR><TD COLSPAN="2">No package variables defined.</TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Root::Root</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Seq</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::SeqIO</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">File::Temp</font></b> qw /:POSIX/ </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">PDL</font></b></TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="Matrix.html">TFBS::Matrix</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="SiteSet.html">TFBS::SiteSet</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="_Iterator/_MatrixSetIterator.html">TFBS::_Iterator::_MatrixSetIterator</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
</TABLE>
<A NAME="libs"></A><TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Inherit</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD><b><font color="#0000ff">Bio::Root::Root</font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre>    # creation of a <B>TFBS::MatrixSet</B> object<BR>    # let @list_of_matrix_objects be a list of TFBS::Matrix::* objects<BR><BR>    ###################################<BR>    # Create a <B>TFBS::MatrixSet</B> object:<BR><BR>    my $matrixset = <B>TFBS::MatrixSet</B>-&gt;new(); # creates an empty set<BR>    $matrixset-&gt;add_Matrix(@list_of_matrix_objects); #add matrix objects to set<BR>    $matrixset-&gt;add_Matrix($matrixobj); # adds a single matrix object to set<BR><BR>    # or, same as above:<BR><BR>    my $matrixset = <B>TFBS::MatrixSet</B>-&gt;new(@list_of_matrix_objects, $matrixobj);<BR><BR>    ###################################<BR>    #<BR></pre>
</TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><B>TFBS::MatrixSet</B> is an aggregate class storing a set of TFBS::Matrix::* subclass objects, and providing methods form manipulating those sets as a whole. <B>TFBS::MatrixSet</B> objects are created &lt;I&gt;de novo&lt;I&gt; or returned by some database (TFBS::DB::*) retrieval methods.<BR></pre>
</TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>Iterator</B></TD><TD><A HREF="#POD1">Description</A></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>_bsearch</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>_csearch</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>_search</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>_seq_to_pdlmatrix</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>_to_seqobj</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
<TR><TD><B>add_Matrix</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE7">Code</A></TD></TR>
<TR><TD><B>add_matrix</B></TD><TD><A HREF="#POD2">Description</A></TD><TD><A HREF="#CODE8">Code</A></TD></TR>
<TR><TD><B>add_matrix_set</B></TD><TD><A HREF="#POD3">Description</A></TD><TD><A HREF="#CODE9">Code</A></TD></TR>
<TR><TD><B>new</B></TD><TD><A HREF="#POD4">Description</A></TD><TD><A HREF="#CODE10">Code</A></TD></TR>
<TR><TD><B>next</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE11">Code</A></TD></TR>
<TR><TD><B>reset</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE12">Code</A></TD></TR>
<TR><TD><B>search_aln</B></TD><TD><A HREF="#POD5">Description</A></TD><TD><A HREF="#CODE13">Code</A></TD></TR>
<TR><TD><B>search_seq</B></TD><TD><A HREF="#POD6">Description</A></TD><TD><A HREF="#CODE14">Code</A></TD></TR>
<TR><TD><B>size</B></TD><TD><A HREF="#POD7">Description</A></TD><TD><A HREF="#CODE15">Code</A></TD></TR>
<TR><TD><B>sort_by_name</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE16">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_Iterator"></A><A NAME="POD1"></A><B>Iterator</B></TD><TD><A HREF="#CODE1">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD>prev</TD><TD><A HREF="#POD2">next</A></TD></TR></TABLE>
<pre> Title   : Iterator<BR> Usage   : my $matrixset_iterator =<BR>                   $matrixset-&gt;Iterator(-sort_by =&gt;'total_ic');<BR>           while (my $matrix_object = $matrix_iterator-&gt;next) {<BR>	       # do whatever you want with individual matrix objects<BR>	   }<BR> Function: Returns an iterator object that can be used to go through<BR>           all members of the set<BR> Returns : an iterator object (currently undocumentened in TFBS -<BR>			       but understands the 'next' method)<BR> Args    : -sort_by # optional - currently it accepts<BR>                    #    'ID' (alphabetically)<BR>                    #    'name' (alphabetically)<BR>                    #    'class' (alphabetically)<BR>                    #    'total_ic' (numerically, decreasing order)<BR><BR>           -reverse # optional - reverses the default sorting order if true<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_add_matrix"></A><A NAME="POD2"></A><B>add_matrix</B></TD><TD><A HREF="#CODE8">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD1">prev</A></TD><TD><A HREF="#POD3">next</A></TD></TR></TABLE>
<pre> Title   : add_matrix<BR> Usage   : $matrixset-&gt;add_matrix(@list_of_matrix_objects);<BR> Function: Adds matrix objects to matrixset<BR> Returns : object reference (usually ignored)<BR> Args    : one or more TFBS::Matrix::* objects<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_add_matrix_set"></A><A NAME="POD3"></A><B>add_matrix_set</B></TD><TD><A HREF="#CODE9">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD2">prev</A></TD><TD><A HREF="#POD4">next</A></TD></TR></TABLE>
<pre> Title   : add_matrix<BR> Usage   : $matrixset-&gt;add_matrix(@list_of_matrixset_objects);<BR> Function: Adds to the matrixset matrix objects contained in one or<BR>           more other matrixsets<BR> Returns : object reference (usually ignored)<BR> Args    : one or more <B>TFBS::MatrixSet</B> objects<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_new"></A><A NAME="POD4"></A><B>new</B></TD><TD><A HREF="#CODE10">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD3">prev</A></TD><TD><A HREF="#POD5">next</A></TD></TR></TABLE>
<pre></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_search_aln"></A><A NAME="POD5"></A><B>search_aln</B></TD><TD><A HREF="#CODE13">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD4">prev</A></TD><TD><A HREF="#POD6">next</A></TD></TR></TABLE>
<pre> Title   : search_aln<BR> Usage   : my $site_pair_set = $matrixset-&gt;search_aln(%args)<BR> Function: Scans a pairwise alignment of nucleotide sequences<BR>	   with the pattern represented by the PWM: it reports only<BR>           those hits that are present in equivalent positions of both<BR>	   sequences and exceed a specified threshold score in both, AND<BR>	   are found in regions of the alignment above the specified<BR>	   conservation cutoff value.<BR>           It works only if all matrix object in $matrixset understand<BR>           search_aln method (currently only TFBS::Matrix::PWM objects do)<BR><BR> Returns : a TFBS::SitePairSet object<BR> Args    : # you must specify either one of the following three:<BR><BR>	   -file,       # the name of the alignment file in Clustal<BR>			       format<BR>	      #or<BR>	   -alignobj      # a Bio::SimpleAlign object<BR>		        # (more accurately, a Bio::PrimarySeqobject or a<BR>		        #  subclass thereof)<BR>	      #or<BR>	   -alignstring # a multi-line string containing the alignment<BR>			# in clustal format<BR>	   #############<BR><BR>	   -threshold,  # minimum score for the hit, either absolute<BR>			# (e.g. 11.2) or relative (e.g. &quot;75%&quot;)<BR>			# OPTIONAL: default &quot;80%&quot;<BR><BR>	   -window,     # size of the sliding window (inn nucleotides)<BR>			# for calculating local conservation in the<BR>			# alignment<BR>			# OPTIONAL: default 50<BR><BR>	   -cutoff      # conservation cutoff (%) for including the<BR>			# region in the results of the pattern search<BR>			# OPTIONAL: default &quot;70%&quot;<BR><BR>	   -subpart	# subpart of the alignment to search, given as e.g.<BR>			# -subpart =&gt; { relative_to =&gt; 1,<BR>			#		start       =&gt; 140,<BR>			#		end	    =&gt; 180 }<BR>			# where start and end are coordinates in the<BR>			# sequence indicated by relative_to (1 for the<BR>			# 1st sequence in the alignment, 2 for the 2nd)<BR>			# OPTIONAL: by default searches entire alignment<BR><BR>	   -conservation<BR>	   		# conservation profile, a TFBS::ConservationProfile<BR>			# OPTIONAL: by default the conservation profile is<BR>			# computed internally on the fly (less efficient)<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_search_seq"></A><A NAME="POD6"></A><B>search_seq</B></TD><TD><A HREF="#CODE14">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD5">prev</A></TD><TD><A HREF="#POD7">next</A></TD></TR></TABLE>
<pre> Title   : search_seq<BR> Usage   : my $siteset = $matrixset-&gt;search_seq(%args)<BR> Function: scans a nucleotide sequence with all patterns represented<BR>           stored in $matrixset;<BR><BR>           It works only if all matrix objects in $matrixset understand<BR>           search_seq method (currently only TFBS::Matrix::PWM objects do)<BR> Returns : a TFBS::SiteSet object<BR> Args    : # you must specify either one of the following three:<BR><BR>	   -file,       # the name od a fasta file (single sequence)<BR>	      #or<BR>	   -seqobj      # a Bio::Seq object<BR>		        # (more accurately, a Bio::PrimarySeqobject or a<BR>		        #  subclass thereof)<BR>	      #or<BR>	   -seqstring # a string containing the sequence<BR><BR>	   -threshold,  # minimum score for the hit, either absolute<BR>			# (e.g. 11.2) or relative (e.g. &quot;75%&quot;)<BR>			# OPTIONAL: default &quot;80%&quot;<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_size"></A><A NAME="POD7"></A><B>size</B></TD><TD><A HREF="#CODE15">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD6">prev</A></TD><TD><A HREF="#POD8">next</A></TD></TR></TABLE>
<pre> Title   : size<BR> Usage   : my $number_of_matrices = $matrixset-&gt;size;<BR> Function: gets the number of matrix objects in the $matrixset<BR>           (i.e. the size of the set)<BR> Returns : a number<BR> Args    : none<BR></pre>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>Iterator</B></TD><TD><A HREF="#POD1">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>Iterator</b></font>
 {<pre>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>return</b></font> <A HREF="_Iterator/_MatrixSetIterator.html"><font color="#8000ff"><b>TFBS::_Iterator::_MatrixSetIterator</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>matrix_list<font color="#0000ff"><b>}</b></font>,
				<font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-sort_by'</font><font color="#0000ff"><b>}</b></font>,
				<font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-reverse'</font><font color="#0000ff"><b>}</b></font>
			       <font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>_bsearch</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_bsearch</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>; <font color="#ff0000">##the rest of @_ goes to _to_seqob;</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@PWMs</font>;

    <font color="#ff0000">## prepare the sequence</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_to_seqobj</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_pdl_matrix<font color="#0000ff"><b>}</b></font> = <font color="#ff8204">_seq_to_pdlmatrix</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj</font><font color="#0000ff"><b>)</b></font>;

    <font color="#ff0000">## prepare the PWMs</font><BR>
    <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>reset</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwm</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@PWMs</font>,<font color="#1f32ff">$pwm</font>;
    <font color="#0000ff"><b>}</b></font>

    <font color="#ff0000">## do the analysis</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$hitlist</font> = <A HREF="SiteSet.html"><font color="#8000ff"><b>TFBS::SiteSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwm</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@PWMs</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$threshold</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-threshold<font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$pwm</font>-&gt;<font color="#0000ff"><b>{</b></font>minscore<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$hitlist</font>-&gt;<font color="#ff8204">add_siteset</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pwm</font>-&gt;<font color="#ff8204">bsearch</font><font color="#0000ff"><b>(</b></font>-seqobj=&gt;<font color="#1f32ff">$seqobj</font>,
					    -threshold =&gt;<font color="#1f32ff">$threshold</font> <font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#4169e1"><b>delete</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_pdl_matrix<font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$hitlist</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>_csearch</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_csearch</b></font>
 {<pre>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$PWM_SEARCH</font> = <font color="#007400">'/home/httpd/cgi-bin/CONSITE/bin/pwm_searchPFF'</font>;

    <font color="#ff0000">## DIRTY - stick tmp file name to seq object</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_to_seqobj</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastaFH<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> = <font color="#ff8204">tmpnam</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">## we need $fastafile below</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqFH</font> = <font color="#8000ff"><b>Bio::SeqIO</b></font>-&gt;<font color="#ff8204">newFh</font><font color="#0000ff"><b>(</b></font>-fh=&gt;<font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastaFH<font color="#0000ff"><b>}</b></font>, -<font color="#4169e1"><b>format</b></font>=&gt;<font color="#007400">"Fasta"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#4169e1"><b>print</b></font> <font color="#1f32ff">$seqFH</font> <font color="#1f32ff">$seqobj</font>;


    <font color="#ff0000">## iterate through pwms</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@PWMs</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>reset</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwm</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@PWMs</font>,<font color="#1f32ff">$pwm</font>;
    <font color="#0000ff"><b>}</b></font>

    <font color="#ff0000">## do the analysis</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$hitlist</font> = <A HREF="SiteSet.html"><font color="#8000ff"><b>TFBS::SiteSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwm</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@PWMs</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$threshold</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-threshold<font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$pwm</font>-&gt;<font color="#0000ff"><b>{</b></font>minscore<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$hitlist</font>-&gt;<font color="#ff8204">add_siteset</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pwm</font>-&gt;<font color="#ff8204">search_seq</font><font color="#0000ff"><b>(</b></font>-seqobj=&gt;<font color="#1f32ff">$seqobj</font>,
					    -threshold =&gt;<font color="#1f32ff">$threshold</font> <font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#4169e1"><b>delete</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastaFH<font color="#0000ff"><b>}</b></font>;
    <font color="#4169e1"><b>delete</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$hitlist</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>_search</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_search</b></font>
 {<pre>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;

    <font color="#ff0000">## DIRTY - stick tmp file name to seq object</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_to_seqobj</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastaFH<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> = <font color="#ff8204">tmpnam</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">## we need $fastafile below</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$outstream</font> = <font color="#8000ff"><b>Bio::SeqIO</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-file=&gt;<font color="#007400">"&gt;"</font>.<font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font>, -<font color="#4169e1"><b>format</b></font>=&gt;<font color="#007400">"Fasta"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$subseqobj</font>;
    <font color="#0000ff"><b>if</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$subpart</font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-subpart<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$subseq_start</font> = <font color="#1f32ff">$subpart</font>-&gt;<font color="#0000ff"><b>{</b></font>-start<font color="#0000ff"><b>}</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$subseq_end</font> = <font color="#1f32ff">$subpart</font>-&gt;<font color="#0000ff"><b>{</b></font>-end<font color="#0000ff"><b>}</b></font>;
	<font color="#0000ff"><b>unless</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$subseq_start</font> and <font color="#1f32ff">$subseq_end</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Option -subpart missing suboption -relative_to, -start or -end"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
	<font color="#1f32ff">$subseqobj</font> = <font color="#8000ff"><b>Bio::Seq</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-seq =&gt; <font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">subseq</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$subseq_start</font>, <font color="#1f32ff">$subseq_end</font><font color="#0000ff"><b>)</b></font>,
				    -id =&gt; <font color="#1f32ff">$seqobj</font>-&gt;id<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#1f32ff">$outstream</font>-&gt;<font color="#ff8204">write_seq</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$subseqobj</font> or <font color="#1f32ff">$seqobj</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$outstream</font>-&gt;<font color="#4169e1"><b>close</b></font>;

    <font color="#ff0000">## iterate through pwms</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@PWMs</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$mxit</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">Iterator</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwm</font> = <font color="#1f32ff">$mxit</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@PWMs</font>,<font color="#1f32ff">$pwm</font>;
    <font color="#0000ff"><b>}</b></font>

    <font color="#ff0000">## do the analysis</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$hitlist</font> = <A HREF="SiteSet.html"><font color="#8000ff"><b>TFBS::SiteSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwm</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@PWMs</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$threshold</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-threshold<font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$pwm</font>-&gt;<font color="#0000ff"><b>{</b></font>minscore<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$hitlist</font>-&gt;<font color="#ff8204">add_siteset</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pwm</font>-&gt;<font color="#ff8204">search_seq</font><font color="#0000ff"><b>(</b></font>-seqobj=&gt;<font color="#1f32ff">$seqobj</font>,
					    -threshold =&gt;<font color="#1f32ff">$threshold</font>,
					      -subpart=&gt;<font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-subpart<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#4169e1"><b>delete</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastaFH<font color="#0000ff"><b>}</b></font>;
    <font color="#4169e1"><b>unlink</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font>;
    <font color="#4169e1"><b>delete</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$hitlist</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>_seq_to_pdlmatrix</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_seq_to_pdlmatrix</b></font>
 {<pre>
    <font color="#ff0000">## not OO - help function for search</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqstring</font> = <font color="#4169e1"><b>uc</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">seq</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@perlarray</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>A C G T<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqtobits</font> = <font color="#1f32ff">$seqstring</font>;
	<font color="#0000ff"><b>eval</b></font> <font color="#007400">"\<font color="#1f32ff">$seqtobits</font> =~ tr/<font color="#1f32ff">$_</font>/1/"</font>;  <font color="#ff0000">## curr. letter $_ to 1</font><BR>	<font color="#0000ff"><b>eval</b></font> <font color="#007400">"\<font color="#1f32ff">$seqtobits</font> =~ tr/1/0/c"</font>;  <font color="#ff0000">## non-1s to 0</font><BR>	<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@perlarray</font>, <font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">""</font>, <font color="#1f32ff">$seqtobits</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>]</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> byte <font color="#0000ff"><b>(</b></font>\<font color="#1f32ff">@perlarray</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>_to_seqobj</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30"><A HREF="#CODE7">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_to_seqobj</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seq</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>    <font color="#ff0000">## not a Bio::Seq</font><BR>	<font color="#0000ff"><b>return</b></font> <font color="#8000ff"><b>Bio::SeqIO</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-file =&gt; <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font>,
			     -<font color="#4169e1"><b>format</b></font> =&gt; <font color="#007400">'fasta'</font>,
			     -moltype =&gt; <font color="#007400">'dna'</font><font color="#0000ff"><b>)</b></font>-&gt;<font color="#ff8204">next_seq</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-seqstring<font color="#0000ff"><b>}</b></font>
	   or <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-seq<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
    <font color="#0000ff"><b>{</b></font>   <font color="#ff0000">## I guess it's a string then</font><BR>	<font color="#0000ff"><b>return</b></font> <font color="#8000ff"><b>Bio::Seq</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-seq  =&gt; <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-seqstring<font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-seq<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>,
			     -id =&gt; <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-seq_id<font color="#0000ff"><b>}</b></font> or <font color="#007400">"undefined"</font><font color="#0000ff"><b>)</b></font>,
			     -moltype =&gt; <font color="#007400">'dna'</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-seqobj'</font><font color="#0000ff"><b>}</b></font> and <font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-seqobj'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> =~ <font color="#006400"><b>/Bio\:\:Seq/</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#ff0000">## do nothing (maybe check later)</font><BR>	<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-seqobj'</font><font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#ff0000">##elsif (ref($format) =~ /Bio\:\:Seq/ and !defined $seq)  {</font><BR>	<font color="#ff0000">## if only one parameter passed and it's a Bio::Seq</font><BR>	<font color="#ff0000">##return $format;</font><BR>    <font color="#ff0000">##}</font><BR>    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;throw <font color="#0000ff"><b>(</b></font><font color="#007400">"Wrong parametes passed to search method: "</font>.<font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>


    <font color="#ff0000">## CONTINUE HERE TOMORROW</font><BR></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE7"></A><B>add_Matrix</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE6">prev</A></TD><TD WIDTH="30"><A HREF="#CODE8">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>add_Matrix</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@matrixlist</font><font color="#0000ff"><b>)</b></font>  = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@matrixlist</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>)</b></font> =~ <font color="#006400"><b>/TFBS::Matrix::/</b></font>
	    or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Attempted to add an element "</font>.
			     <font color="#007400">"that is not a TFBS::Matrix object."</font><font color="#0000ff"><b>)</b></font>;
	<font color="#4169e1"><b>push</b></font> @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>matrix_list<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>,  <font color="#1f32ff">$_</font>;
	<font color="#4169e1"><b>push</b></font> @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_iterator_list<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$_</font>;

    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> 1;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE8"></A><B>add_matrix</B></TD><TD><A HREF="#POD2">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE7">prev</A></TD><TD WIDTH="30"><A HREF="#CODE9">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>add_matrix</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@matrices</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrix</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@matrices</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Argument to add_matrix_set not a TFBS::Matrix object"</font><font color="#0000ff"><b>)</b></font>
	    <font color="#0000ff"><b>unless</b></font> <font color="#1f32ff">$matrix</font>-&gt;<font color="#ff8204">isa</font><font color="#0000ff"><b>(</b></font><font color="#007400">"TFBS::Matrix"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#4169e1"><b>push</b></font> @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>matrix_list<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">@matrices</font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE9"></A><B>add_matrix_set</B></TD><TD><A HREF="#POD3">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE8">prev</A></TD><TD WIDTH="30"><A HREF="#CODE10">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>add_matrix_set</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@sets</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixset</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@sets</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Argument to add_matrix_set not a TFBS::Matrixset object"</font><font color="#0000ff"><b>)</b></font>
	    <font color="#0000ff"><b>unless</b></font> <font color="#1f32ff">$matrixset</font>-&gt;<font color="#ff8204">isa</font><font color="#0000ff"><b>(</b></font><font color="#007400">"TFBS::MatrixSet"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#4169e1"><b>push</b></font> @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>matrix_list<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>, @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$matrixset</font>-&gt;<font color="#0000ff"><b>{</b></font>matrix_list<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE10"></A><B>new</B></TD><TD><A HREF="#POD4">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE9">prev</A></TD><TD WIDTH="30"><A HREF="#CODE11">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>new</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font>, <font color="#1f32ff">@matrices</font><font color="#0000ff"><b>)</b></font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>bless</b></font> <font color="#0000ff"><b>{</b></font>matrix_list =&gt;<font color="#0000ff"><b>[</b></font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>}</b></font>, <font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font><font color="#0000ff"><b>)</b></font> || <font color="#1f32ff">$caller</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">add_matrix</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@matrices</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>if</b></font> <font color="#1f32ff">@matrices</font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE11"></A><B>next</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE10">prev</A></TD><TD WIDTH="30"><A HREF="#CODE12">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>next</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>warn</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"next: Deprecated method use Iterator instead."</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$next_matrix</font> = <font color="#4169e1"><b>shift</b></font> <font color="#0000ff"><b>(</b></font>@<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_iterator_list<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$next_matrix</font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>reset</b></font>;
	<font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>undef</b></font>;
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE12"></A><B>reset</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE11">prev</A></TD><TD WIDTH="30"><A HREF="#CODE13">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>reset</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>warn</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"reset: Deprecated method use Iterator instead."</font><font color="#0000ff"><b>)</b></font>;
    @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>_iterator_list<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font> = @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>matrix_list<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE13"></A><B>search_aln</B></TD><TD><A HREF="#POD5">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE12">prev</A></TD><TD WIDTH="30"><A HREF="#CODE14">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>search_aln</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$mxit</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">Iterator</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sitepairset</font> = <A HREF="SitePairSet.html"><font color="#8000ff"><b>TFBS::SitePairSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$aln</font> = <A HREF="Matrix/_Alignment.html"><font color="#8000ff"><b>TFBS::Matrix::_Alignment</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$mx</font> = <font color="#1f32ff">$mxit</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$singleset</font> = <font color="#1f32ff">$mx</font>-&gt;<font color="#ff8204">search_aln</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font>,
                                        -alignment_setup =&gt; <font color="#1f32ff">$aln</font><font color="#0000ff"><b>)</b></font>;
        <font color="#1f32ff">$sitepairset</font>-&gt;<font color="#ff8204">add_site_pair_set</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$singleset</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$sitepairset</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE14"></A><B>search_seq</B></TD><TD><A HREF="#POD6">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE13">prev</A></TD><TD WIDTH="30"><A HREF="#CODE15">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>search_seq</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_search</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE15"></A><B>size</B></TD><TD><A HREF="#POD7">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE14">prev</A></TD><TD WIDTH="30"><A HREF="#CODE16">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>size</b></font>
 {<pre>    <font color="#4169e1"><b>scalar</b></font> @<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font>matrix_list<font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE16"></A><B>sort_by_name</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE15">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>sort_by_name</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>warn</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"sort_by_name: Deprecated method use Iterator instead."</font><font color="#0000ff"><b>)</b></font>;
    @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>matrix_list<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font> = <font color="#4169e1"><b>sort</b></font> <font color="#0000ff"><b>{</b></font> <font color="#4169e1"><b>uc</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$a</font>-&gt;<font color="#0000ff"><b>{</b></font>name<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> cmp <font color="#4169e1"><b>uc</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$b</font>-&gt;<font color="#0000ff"><b>{</b></font>name<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>}</b></font>
                              @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>matrix_list<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>reset</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_FEEDBACK"><B>FEEDBACK</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Please send bug reports and other comments to the author.<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_AUTHOR - Boris Lenhard"><B>AUTHOR - Boris Lenhard</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Boris Lenhard <a href="mailto:Boris.Lenhard@cgb.ki.seE">Boris.Lenhard@cgb.ki.seE</a>i.se&gt;<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_APPENDIX"><B>APPENDIX</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>The rest of the documentation details each of the object<BR>methods. Internal methods are preceded with an underscore.<BR></pre>
</TD></TR>
</TABLE>
</body>
</html>
