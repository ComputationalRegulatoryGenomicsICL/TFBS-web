<head>
<!-- Generated by perlmod2www.pl -->
<title>
PWM documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS::Matrix</H4>
<H3>PWM</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#SUMMARY">Summary</A></TD>
<TD><A HREF="#libs">Included libraries</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#SYNOPSIS">Synopsis</A></TD>
<TD><A HREF="#DESCRIPTION">Description</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR><TD BGCOLOR="#ffae84"><B>Summary</B></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD><pre><B>TFBS::Matrix::PWM</B> - class for position weight matrices of nucleotide<BR>patterns<BR></pre></TD></TR>
</TABLE>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR><TD COLSPAN="2">No package variables defined.</TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Root::Root</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Seq</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::SeqIO</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">File::Temp</font></b> qw /:POSIX/ </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">PDL</font></b></TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../../Ext/pwmsearch.html">TFBS::Ext::pwmsearch</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../Matrix.html">TFBS::Matrix</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="_Alignment.html">TFBS::Matrix::_Alignment</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../SiteSet.html">TFBS::SiteSet</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
</TABLE>
<A NAME="libs"></A><TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Inherit</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD><b><font color="#0000ff">Bio::Root::Root</font></b> <b><font color="#0000ff"><a href="../Matrix.html">TFBS::Matrix</a></font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><BR><A NAME="_pod_* creating a <B>TFBS::Matrix::PWM</B> object manually:">    * creating a <B>TFBS::Matrix::PWM</B> object manually:</A><BR>        my $matrixref = [ [ 0.61, -3.16,  1.83, -3.16,  1.21, -0.06],<BR>                      [-0.15, -2.57, -3.16, -3.16, -2.57, -1.83],<BR>		      [-1.57,  1.85, -2.57, -1.34, -1.57,  1.14],<BR>		      [ 0.31, -3.16, -2.57,  1.76,  0.24, -0.83]<BR>		    ];<BR>    my $pwm = <B>TFBS::Matrix::PWM</B>-&gt;new(-matrix =&gt; $matrixref,<BR>				     -name   =&gt; &quot;MyProfile&quot;,<BR>				     -ID     =&gt; &quot;M0001&quot;<BR>				    );<BR>    # or<BR><BR>        my $matrixstring = &lt;&lt;ENDMATRIX<BR>     0.61 -3.16  1.83 -3.16  1.21 -0.06<BR>    -0.15 -2.57 -3.16 -3.16 -2.57 -1.83<BR>    -1.57  1.85 -2.57 -1.34 -1.57  1.14<BR>     0.31 -3.16 -2.57  1.76  0.24 -0.83<BR>    ENDMATRIX<BR>    ;<BR>    my $pwm = <B>TFBS::Matrix::PWM</B>-&gt;new(-matrixstring =&gt; $matrixstring,<BR>				     -name   	   =&gt; &quot;MyProfile&quot;,<BR>				     -ID           =&gt; &quot;M0001&quot;<BR>				    );<BR><BR><A NAME="_pod_* retrieving a TFBS::Matix::PWM object from a database:">    * retrieving a TFBS::Matix::PWM object from a database:</A><BR>    (See documentation of individual TFBS::DB::* modules to learn<BR>how to connect to different types of pattern databases and retrieve<BR>TFBS::Matrix::* objects from them.)<BR><BR>        my $db_obj = TFBS::DB::JASPAR2-&gt;new<BR>		    (-connect =&gt; [&quot;dbi:mysql:JASPAR2:myhost&quot;,<BR>				  &quot;myusername&quot;, &quot;mypassword&quot;]);<BR>    my $pwm = $db_obj-&gt;get_Matrix_by_ID(&quot;M0001&quot;, &quot;PWM&quot;);<BR>    # or<BR>    my $pwm = $db_obj-&gt;get_Matrix_by_name(&quot;MyProfile&quot;, &quot;PWM&quot;);<BR><BR><A NAME="_pod_">    </A><BR>    (see decumentation of TFBS::MatrixSet to learn how to create<BR>objects for storage and manipulation of multiple matrices)<BR><BR>        my @pwm_list = $matrixset-&gt;all_patterns(-sort_by=&gt;&quot;name&quot;);<BR><BR><A NAME="_pod_* scanning a nucleotide sequence with a matrix">    * scanning a nucleotide sequence with a matrix</A><BR>        my $siteset = $pwm-&gt;search_seq(-file      =&gt;&quot;myseq.fa&quot;,<BR>				   -threshold =&gt; &quot;80%&quot;);<BR><BR><A NAME="_pod_* scanning a pairwise alignment with a matrix">    * scanning a pairwise alignment with a matrix</A><BR>        my $site_pair_set = $pwm-&gt;search_aln(-file      =&gt;&quot;myalign.aln&quot;,<BR>				         -threshold =&gt; &quot;80%&quot;,<BR>				         -cutoff    =&gt; &quot;70%&quot;,<BR>					 -window    =&gt; 50);<BR><BR><BR></pre>
</TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><B>TFBS::Matrix::PWM</B> is a class whose instances are objects representing<BR>position weight matrices (PWMs). A PWM is normally calculated from a<BR>raw position frequency matrix (see <a href="PFM.html" target="urlWin"><b>TFBS::Matrix::PFM</b></a><BR>for the explanation of position frequency matrices). For example, given<BR>the following position frequency matrix:<BR><BR>    A:[ 12     3     0     0     4     0  ]<BR>    C:[  0     0     0    11     7     0  ]<BR>    G:[  0     9    12     0     0     0  ]<BR>    T:[  0     0     0     1     1    12  ]<BR><BR>The standard computational procedure is applied to convert it into the<BR>following position weight matrix:<BR><BR>    A:[ 0.61 -3.16  1.83 -3.16  1.21 -0.06]<BR>    C:[-0.15 -2.57 -3.16 -3.16 -2.57 -1.83]<BR>    G:[-1.57  1.85 -2.57 -1.34 -1.57  1.14]<BR>    T:[ 0.31 -3.16 -2.57  1.76  0.24 -0.83]<BR><BR>which contains the &quot;weights&quot; associated with the occurence of each<BR>nucleotide at the given position in a pattern.<BR><BR>A <B>TFBS::Matrix::PWM</B> object is equipped with methods to search nucleotide<BR>sequences and pairwise alignments of nucleotide sequences with the<BR>pattern they represent, and return a set of sites in nucleotide<BR>sequence (a TFBS::SiteSet object for single sequence search, and a<BR>TFBS::SitePairSet for the alignment search).<BR></pre>
</TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>DESTROY</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>_bsearch</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>_csearch</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>_search</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>_seq_to_pdlmatrix</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>_set_min_max_score</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
<TR><TD><B>_to_seqobj</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE7">Code</A></TD></TR>
<TR><TD><B>max_score</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE8">Code</A></TD></TR>
<TR><TD><B>min_score</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE9">Code</A></TD></TR>
<TR><TD><B>new</B></TD><TD><A HREF="#POD1">Description</A></TD><TD><A HREF="#CODE10">Code</A></TD></TR>
<TR><TD><B>search_aln</B></TD><TD><A HREF="#POD2">Description</A></TD><TD><A HREF="#CODE11">Code</A></TD></TR>
<TR><TD><B>search_seq</B></TD><TD><A HREF="#POD3">Description</A></TD><TD><A HREF="#CODE12">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_new"></A><A NAME="POD1"></A><B>new</B></TD><TD><A HREF="#CODE10">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD>prev</TD><TD><A HREF="#POD2">next</A></TD></TR></TABLE>
<pre> Title   : new<BR> Usage   : my $pwm = <B>TFBS::Matrix::PWM</B>-&gt;new(%args)<BR> Function: constructor for the <B>TFBS::Matrix::PWM</B> object<BR> Returns : a new <B>TFBS::Matrix::PWM</B> object<BR> Args    : # you must specify either one of the following three:<BR><BR>	   -matrix,      # reference to an array of arrays of integers<BR>	      #or<BR>	   -matrixstring,# a string containing four lines<BR>	                 # of tab- or space-delimited integers<BR>	      #or<BR>	   -matrixfile,  # the name of a file containing four lines<BR>	                 # of tab- or space-delimited integers<BR>	   #######<BR><BR>           -name,        # string, OPTIONAL<BR>           -ID,          # string, OPTIONAL<BR>           -class,       # string, OPTIONAL<BR>           -tags         # an array reference, OPTIONAL<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_search_aln"></A><A NAME="POD2"></A><B>search_aln</B></TD><TD><A HREF="#CODE11">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD1">prev</A></TD><TD><A HREF="#POD3">next</A></TD></TR></TABLE>
<pre> Title   : search_aln<BR> Usage   : my $site_pair_set = $pwm-&gt;search_aln(%args)<BR> Function: Scans a pairwise alignment of nucleotide sequences<BR>	   with the pattern represented by the PWM: it reports only<BR>           those hits that are present in equivalent positions of both<BR>	   sequences and exceed a specified threshold score in both, AND<BR>	   are found in regions of the alignment above the specified<BR>	   conservation cutoff value.<BR> Returns : a TFBS::SitePairSet object<BR> Args    : # you must specify either one of the following three:<BR><BR>	   -file,       # the name of the alignment file in Clustal<BR>			       format<BR>	      #or<BR>	   -alignobj      # a Bio::SimpleAlign object<BR>		        # (more accurately, a Bio::PrimarySeqobject or a<BR>		        #  subclass thereof)<BR>	      #or<BR>	   -alignstring # a multi-line string containing the alignment<BR>			# in clustal format<BR>	   #############<BR><BR>	   -threshold,  # minimum score for the hit, either absolute<BR>			# (e.g. 11.2) or relative (e.g. &quot;75%&quot;)<BR>			# OPTIONAL: default &quot;80%&quot;<BR><BR>	   -window,     # size of the sliding window (inn nucleotides)<BR>			# for calculating local conservation in the<BR>			# alignment<BR>			# OPTIONAL: default 50<BR><BR>	   -cutoff      # conservation cutoff (%) for including the<BR>			# region in the results of the pattern search<BR>			# OPTIONAL: default &quot;70%&quot;<BR><BR>	   -subpart	# subpart of the alignment to search, given as e.g.<BR>			# -subpart =&gt; { relative_to =&gt; 1,<BR>			#		start       =&gt; 140,<BR>			#		end	    =&gt; 180 }<BR>			# where start and end are coordinates in the<BR>			# sequence indicated by relative_to (1 for the<BR>			# 1st sequence in the alignment, 2 for the 2nd)<BR>			# OPTIONAL: by default searches entire alignment<BR><BR>	   -conservation<BR>			# conservation profile, a TFBS::ConservationProfile<BR>			# OPTIONAL: by default the conservation profile is<BR>			# computed internally on the fly (less efficient)<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_search_seq"></A><A NAME="POD3"></A><B>search_seq</B></TD><TD><A HREF="#CODE12">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD2">prev</A></TD><TD><A HREF="#POD4">next</A></TD></TR></TABLE>
<pre> Title   : search_seq<BR> Usage   : my $siteset = $pwm-&gt;search_seq(%args)<BR> Function: scans a nucleotide sequence with the pattern represented<BR>	   by the PWM<BR> Returns : a TFBS::SiteSet object<BR> Args    : # you must specify either one of the following three:<BR><BR>	   -file,       # the name od a fasta file (single sequence)<BR>	      #or<BR>	   -seqobj      # a Bio::Seq object<BR>		        # (more accurately, a Bio::PrimarySeqobject or a<BR>		        #  subclass thereof)<BR>	      #or<BR>	   -seqstring # a string containing the sequence<BR><BR>	   -threshold,  # minimum score for the hit, either absolute<BR>			# (e.g. 11.2) or relative (e.g. &quot;75%&quot;)<BR>			# OPTIONAL: default &quot;80%&quot;<BR><BR>	   -subpart	# subpart of the sequence to search, given as<BR>			# -subpart =&gt; { start =&gt; 140,<BR>			#		end   =&gt; 180 }<BR>			# where start and end are coordinates in the<BR>			# sequence; the coordinate range is interpreted<BR>			# in the BioPerl tradition (1-based, inclusive)<BR>			# OPTIONAL: by default searches entire alignment<BR></pre>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>DESTROY</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>DESTROY</b></font>
 {<pre>    <font color="#ff0000">## nothing</font><BR></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>_bsearch</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_bsearch</b></font>
 {<pre>
    <font color="#ff0000">## this is Perl/PDL only search routine. For experimental purposes only</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>; <font color="#ff0000">##the rest of @_ goes to _to_seqob;</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@PWMs</font>;

    <font color="#ff0000">## prepare the sequence</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_to_seqobj</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqmatrix</font> = <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_pdl_matrix<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
	              ? <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_pdl_matrix<font color="#0000ff"><b>}</b></font>
                      : <font color="#ff8204">_seq_to_pdlmatrix</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj</font><font color="#0000ff"><b>)</b></font>;

    <font color="#ff0000">## calculate threshold</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$threshold</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-threshold<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-threshold<font color="#0000ff"><b>}</b></font> =~ <font color="#006400"><b>/(.+)%/</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#ff0000">## percentage</font><BR>	    <font color="#1f32ff">$threshold</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font> +
		<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>max_score<font color="#0000ff"><b>}</b></font> - <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>* <font color="#1f32ff">$1</font>/100;<BR>	<font color="#0000ff"><b>}</b></font>
	<font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#ff0000">## absolute value</font><BR>	    <font color="#1f32ff">$threshold</font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-threshold<font color="#0000ff"><b>}</b></font>;
	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#ff0000">## no threshold given</font><BR>	<font color="#1f32ff">$threshold</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font> -1;
    <font color="#0000ff"><b>}</b></font>

    <font color="#ff0000">## do the analysis</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$hitlist</font> = <A HREF="../SiteSet.html"><font color="#8000ff"><b>TFBS::SiteSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwm</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">revcom</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$TFlength</font> = <font color="#1f32ff">$pwm</font>-&gt;<font color="#ff8204">pdl_matrix</font><font color="#0000ff"><b>(</b></font>0<font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$position_score_pdl</font> = <font color="#ff8204">zeroes</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqmatrix</font>-&gt;<font color="#ff8204">getdim</font><font color="#0000ff"><b>(</b></font>0<font color="#0000ff"><b>)</b></font> - <font color="#1f32ff">$TFlength</font> + 1<font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$position_index_pdl</font> = <font color="#ff8204">sequence</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqmatrix</font>-&gt;<font color="#ff8204">getdim</font><font color="#0000ff"><b>(</b></font>0<font color="#0000ff"><b>)</b></font> - <font color="#1f32ff">$TFlength</font> + 1<font color="#0000ff"><b>)</b></font>+1;

	<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> <font color="#0000ff"><b>(</b></font>0..<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$TFlength</font>-1<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$columnproduct</font> = <font color="#1f32ff">$seqmatrix</font> * <font color="#1f32ff">$pwm</font>-&gt;<font color="#ff8204">pdl_matrix</font><font color="#0000ff"><b>(</b></font><font color="#007400">"<font color="#1f32ff">$i</font>,:"</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$position_score_pdl</font> +=
	      <font color="#1f32ff">$columnproduct</font>-&gt;<font color="#ff8204">xchg</font><font color="#0000ff"><b>(</b></font>0,1<font color="#0000ff"><b>)</b></font>-&gt;<font color="#ff8204">sumover</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$i</font>.<font color="#007400">":"</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$i</font>-<font color="#1f32ff">$TFlength</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@hitpositions</font> =
	    list <font color="#1f32ff">$position_index_pdl</font>-&gt;<font color="#ff8204">where</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$position_score_pdl</font> &gt;= <font color="#1f32ff">$threshold</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@hitscores</font>    =
	    list <font color="#1f32ff">$position_score_pdl</font>-&gt;<font color="#ff8204">where</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$position_score_pdl</font> &gt;= <font color="#1f32ff">$threshold</font><font color="#0000ff"><b>)</b></font>;

	<font color="#0000ff"><b>for</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font><font color="#0000ff"><b>(</b></font>0..$<font color="#ff0000">##hitpositions) {</font><BR>	    <font color="#0000ff"><b>my</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pos</font>,<font color="#1f32ff">$score</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$hitpositions</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font>, <font color="#1f32ff">$hitscores</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$siteseq</font> = <font color="#4169e1"><b>scalar</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">subseq</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pos</font>, <font color="#1f32ff">$pos</font>+<font color="#1f32ff">$TFlength</font>-1<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$site</font> = <A HREF="../Site.html"><font color="#8000ff"><b>TFBS::Site</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font> <font color="#0000ff"><b>(</b></font> -seq_id =&gt; <font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">display_id</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>,
					 -seqobj  =&gt; <font color="#1f32ff">$seqobj</font>,
					 -strand  =&gt; <font color="#1f32ff">$pwm</font>-&gt;<font color="#0000ff"><b>{</b></font>strand<font color="#0000ff"><b>}</b></font>,
					 -Matrix  =&gt; <font color="#1f32ff">$pwm</font>,
					 -siteseq =&gt; <font color="#1f32ff">$siteseq</font>,
					 -score   =&gt; <font color="#1f32ff">$score</font>,
					 -start   =&gt; <font color="#1f32ff">$pos</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$hitlist</font>-&gt;<font color="#ff8204">add_site</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$site</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>_csearch</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_csearch</b></font>
 {<pre>
    <font color="#ff0000">## this is a wrapper around Wyeth Wasserman's's pwm_searchPFF program</font><BR>    <font color="#ff0000">## until we do a proper extension</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font> = <font color="#4169e1"><b>shift</b></font>; <font color="#ff0000">##the rest of @_ goes to _to_seqob;</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%args</font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$PWM_SEARCH</font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-binary'</font><font color="#0000ff"><b>}</b></font>
                     || <font color="#007400">"pwm_searchPFF"</font>;

    <font color="#ff0000">## dump the sequence into a tempfile</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_to_seqobj</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@_</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$fastaFH</font>, <font color="#1f32ff">$fastafile</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastaFH<font color="#0000ff"><b>}</b></font> and <font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$fastaFH</font>, <font color="#1f32ff">$fastafile</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastaFH<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$fastaFH</font>, <font color="#1f32ff">$fastafile</font><font color="#0000ff"><b>)</b></font> = <font color="#ff8204">tmpnam</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqFH</font> = <font color="#8000ff"><b>Bio::SeqIO</b></font>-&gt;<font color="#ff8204">newFh</font><font color="#0000ff"><b>(</b></font>-fh =&gt;<font color="#1f32ff">$fastaFH</font>, -<font color="#4169e1"><b>format</b></font>=&gt;<font color="#007400">"Fasta"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#4169e1"><b>print</b></font> <font color="#1f32ff">$seqFH</font> <font color="#1f32ff">$seqobj</font>;
     <font color="#0000ff"><b>}</b></font>
    <font color="#ff0000">## we need $fastafile below</font><BR>

    <font color="#ff0000">## calculate threshold</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$threshold</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-threshold<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-threshold<font color="#0000ff"><b>}</b></font> =~ <font color="#006400"><b>/(.+)%/</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#ff0000">## percentage</font><BR>	    <font color="#1f32ff">$threshold</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font> +
		<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>max_score<font color="#0000ff"><b>}</b></font> - <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>* <font color="#1f32ff">$1</font>/100;<BR>	<font color="#0000ff"><b>}</b></font>
	<font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#ff0000">## absolute value</font><BR>	    <font color="#1f32ff">$threshold</font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-threshold<font color="#0000ff"><b>}</b></font>;
	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#ff0000">## no threshold given</font><BR>	<font color="#1f32ff">$threshold</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font> -1;
    <font color="#0000ff"><b>}</b></font>


    <font color="#ff0000">## convert piddle to text (there MUST be a better way)</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwmstring</font> = <font color="#4169e1"><b>sprintf</b></font> <font color="#0000ff"><b>(</b></font> <font color="#1f32ff">$self</font>-&gt;pdl_matrix <font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$pwmstring</font> =~ <font color="#006400"><b>s/\[|\]//g</b></font>;                <font color="#ff0000">## lose []</font><BR>    <font color="#1f32ff">$pwmstring</font> =~ <font color="#006400"><b>s/\n /\n/g</b></font>;                <font color="#ff0000">## lose leading spaces</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@pwmlines</font> = <font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"\n"</font>, <font color="#1f32ff">$pwmstring</font><font color="#0000ff"><b>)</b></font>; <font color="#ff0000">## f</font><BR>    <font color="#1f32ff">$pwmstring</font> = <font color="#4169e1"><b>join</b></font> <font color="#0000ff"><b>(</b></font><font color="#007400">"\n"</font>, <font color="#1f32ff">@pwmlines</font><font color="#0000ff"><b>[</b></font>2..5<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>.<font color="#007400">"\n"</font>;

    <font color="#ff0000">## dump pwm into a tempfile</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pwmFH</font>, <font color="#1f32ff">$pwmfile</font><font color="#0000ff"><b>)</b></font> = <font color="#ff8204">tmpnam</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;  <font color="#ff0000">## we need $pwmfile below</font><BR>    <font color="#4169e1"><b>print</b></font> <font color="#1f32ff">$pwmFH</font> <font color="#1f32ff">$pwmstring</font>;
    <font color="#4169e1"><b>close</b></font> <font color="#1f32ff">$pwmFH</font>;

    <font color="#ff0000">## run pwmsearch</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$hitlist</font> = <A HREF="../SiteSet.html"><font color="#8000ff"><b>TFBS::SiteSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$TFname</font>, <font color="#1f32ff">$TFclass</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>name<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>class<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@search_result_lines</font> =
	`<font color="#1f32ff">$PWM_SEARCH</font> <font color="#1f32ff">$pwmfile</font> <font color="#1f32ff">$fastafile</font> <font color="#1f32ff">$threshold</font> -n <font color="#1f32ff">$TFname</font> -c <font color="#1f32ff">$TFclass</font>`;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@search_result_lines</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>chomp</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq_id</font>, <font color="#1f32ff">$factor</font>, <font color="#1f32ff">$class</font>, <font color="#1f32ff">$strand</font>, <font color="#1f32ff">$score</font>, <font color="#1f32ff">$pos</font>, <font color="#1f32ff">$siteseq</font><font color="#0000ff"><b>)</b></font> =
	    <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>[</b></font>0, 2, 3, 4, 5, 7, 9<font color="#0000ff"><b>]</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$correct_strand</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$strand</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"+"</font><font color="#0000ff"><b>)</b></font>? <font color="#007400">"-1"</font> : <font color="#007400">"1"</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$site</font> = <A HREF="../Site.html"><font color="#8000ff"><b>TFBS::Site</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font> <font color="#0000ff"><b>(</b></font> -seq_id =&gt; <font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">display_id</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>.<font color="#007400">""</font>,
				     -seqobj  =&gt; <font color="#1f32ff">$seqobj</font>,
				     -strand  =&gt; <font color="#1f32ff">$correct_strand</font>.<font color="#007400">""</font>,
				     -pattern =&gt; <font color="#1f32ff">$self</font>,
				     -siteseq =&gt; <font color="#1f32ff">$siteseq</font>.<font color="#007400">""</font>,
				     -score   =&gt; <font color="#1f32ff">$score</font>.<font color="#007400">""</font>,
				     -start   =&gt; <font color="#1f32ff">$pos</font>,
				     -end     =&gt; <font color="#1f32ff">$pos</font> + <font color="#4169e1"><b>length</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$siteseq</font><font color="#0000ff"><b>)</b></font> -1
				     <font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$hitlist</font>-&gt;<font color="#ff8204">add_site</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$site</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>


    <font color="#ff0000">## cleanup</font><BR>    <font color="#4169e1"><b>unlink</b></font> <font color="#1f32ff">$fastafile</font> <font color="#0000ff"><b>unless</b></font> <font color="#1f32ff">$seqobj</font>-&gt;<font color="#0000ff"><b>{</b></font>_fastafile<font color="#0000ff"><b>}</b></font>;
    <font color="#4169e1"><b>unlink</b></font> <font color="#1f32ff">$pwmfile</font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$hitlist</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>_search</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_search</b></font>
 {<pre>    <font color="#ff0000">## this method runs the pwmsearch C extension and parses the data</font><BR>    <font color="#ff0000">## similarly to _csearch, which will eventually be discontinued</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>  = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_to_seqobj</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$subseq_start</font>, <font color="#1f32ff">$subseq_end</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font>1,<font color="#1f32ff">$seqobj</font>-&gt;<font color="#4169e1"><b>length</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$subpart</font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-subpart<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$subseq_start</font> = <font color="#1f32ff">$subpart</font>-&gt;<font color="#0000ff"><b>{</b></font>-start<font color="#0000ff"><b>}</b></font>;
	<font color="#1f32ff">$subseq_end</font> = <font color="#1f32ff">$subpart</font>-&gt;<font color="#0000ff"><b>{</b></font>-end<font color="#0000ff"><b>}</b></font>;
	<font color="#0000ff"><b>unless</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$subseq_start</font> and <font color="#1f32ff">$subseq_end</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Option -subpart missing suboption -start or -end"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <A HREF="../../Ext/pwmsearch.html"><font color="#8000ff"><b>TFBS::Ext::pwmsearch</b></font></A>::<font color="#ff8204">pwmsearch</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$seqobj</font>,
					   <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-threshold<font color="#0000ff"><b>}</b></font> or 0<font color="#0000ff"><b>)</b></font>,
					   <font color="#1f32ff">$subseq_start</font>, <font color="#1f32ff">$subseq_end</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>_seq_to_pdlmatrix</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_seq_to_pdlmatrix</b></font>
 {<pre>    <font color="#ff0000">## called from ?search</font><BR>
    <font color="#ff0000">## not OO - help function for search</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqstring</font> = <font color="#4169e1"><b>uc</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj</font>-&gt;<font color="#ff8204">seq</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@perlarray</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>A C G T<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqtobits</font> = <font color="#1f32ff">$seqstring</font>;
	<font color="#0000ff"><b>eval</b></font> <font color="#007400">"\<font color="#1f32ff">$seqtobits</font> =~ tr/<font color="#1f32ff">$_</font>/1/"</font>;  <font color="#ff0000">## curr. letter $_ to 1</font><BR>	<font color="#0000ff"><b>eval</b></font> <font color="#007400">"\<font color="#1f32ff">$seqtobits</font> =~ tr/1/0/c"</font>;  <font color="#ff0000">## non-1s to 0</font><BR>	<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@perlarray</font>, <font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">""</font>, <font color="#1f32ff">$seqtobits</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>]</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> byte <font color="#0000ff"><b>(</b></font>\<font color="#1f32ff">@perlarray</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>_set_min_max_score</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30"><A HREF="#CODE7">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_set_min_max_score</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$transpose</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">pdl_matrix</font><font color="#0000ff"><b>(</b></font>0,1<font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font> = <font color="#ff8204">sum</font><font color="#0000ff"><b>(</b></font>minimum <font color="#1f32ff">$transpose</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>max_score<font color="#0000ff"><b>}</b></font> = <font color="#ff8204">sum</font><font color="#0000ff"><b>(</b></font>maximum <font color="#1f32ff">$transpose</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE7"></A><B>_to_seqobj</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE6">prev</A></TD><TD WIDTH="30"><A HREF="#CODE8">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_to_seqobj</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seq</font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>    <font color="#ff0000">## not a Bio::Seq</font><BR>	<font color="#0000ff"><b>return</b></font> <font color="#8000ff"><b>Bio::SeqIO</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-file =&gt; <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font>,
			     -<font color="#4169e1"><b>format</b></font> =&gt; <font color="#007400">'fasta'</font>,
			     -moltype =&gt; <font color="#007400">'dna'</font><font color="#0000ff"><b>)</b></font>-&gt;<font color="#ff8204">next_seq</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-seqstring<font color="#0000ff"><b>}</b></font>
	   or <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-seq<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
    <font color="#0000ff"><b>{</b></font>   <font color="#ff0000">## I guess it's a string then</font><BR>	<font color="#0000ff"><b>return</b></font> <font color="#8000ff"><b>Bio::Seq</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-seq  =&gt; <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-seqstring<font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-seq<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>,
			     -id =&gt; <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-seq_id<font color="#0000ff"><b>}</b></font> or <font color="#007400">"undefined"</font><font color="#0000ff"><b>)</b></font>,
			     -moltype =&gt; <font color="#007400">'dna'</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-seqobj'</font><font color="#0000ff"><b>}</b></font> and <font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-seqobj'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> and <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-seqobj'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">can</font><font color="#0000ff"><b>(</b></font><font color="#007400">"seq"</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#ff0000">## do nothing (maybe check later)</font><BR>	<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-seqobj'</font><font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#ff0000">##elsif (ref($format) =~ /Bio\:\:Seq/ and !defined $seq)  {</font><BR>	<font color="#ff0000">## if only one parameter passed and it's a Bio::Seq</font><BR>	<font color="#ff0000">##return $format;</font><BR>    <font color="#ff0000">##}</font><BR>    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;throw <font color="#0000ff"><b>(</b></font><font color="#007400">"Wrong parametes passed to search method: "</font>.<font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE8"></A><B>max_score</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE7">prev</A></TD><TD WIDTH="30"><A HREF="#CODE9">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>max_score</b></font>
 {<pre>    <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font>max_score<font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE9"></A><B>min_score</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE8">prev</A></TD><TD WIDTH="30"><A HREF="#CODE10">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>min_score</b></font>
 {<pre>    <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font>min_score<font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE10"></A><B>new</B></TD><TD><A HREF="#POD1">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE9">prev</A></TD><TD WIDTH="30"><A HREF="#CODE11">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>new</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$class</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrix</font> = <A HREF="../Matrix.html"><font color="#8000ff"><b>TFBS::Matrix</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font>, -matrixtype=&gt;<font color="#007400">"PWM"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>bless</b></font> <font color="#1f32ff">$matrix</font>, <font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$class</font><font color="#0000ff"><b>)</b></font> || <font color="#1f32ff">$class</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_set_min_max_score</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE11"></A><B>search_aln</B></TD><TD><A HREF="#POD2">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE10">prev</A></TD><TD WIDTH="30"><A HREF="#CODE12">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>search_aln</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-alignstring<font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-alignobj<font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;throw
	    <font color="#0000ff"><b>(</b></font><font color="#007400">"No alignment file, string or object passed to search_aln."</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-pattern_set<font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$self</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$aln</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-alignment_setup<font color="#0000ff"><b>}</b></font> or <A HREF="_Alignment.html"><font color="#8000ff"><b>TFBS::Matrix::_Alignment</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$aln</font>-&gt;<font color="#ff8204">do_sitesearch</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$aln</font>-&gt;site_pair_set;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE12"></A><B>search_seq</B></TD><TD><A HREF="#POD3">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE11">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>search_seq</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_search</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_FEEDBACK"><B>FEEDBACK</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Please send bug reports and other comments to the author.<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_AUTHOR - Boris Lenhard"><B>AUTHOR - Boris Lenhard</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Boris Lenhard <a href="mailto:Boris.Lenhard@cgb.ki.seE">Boris.Lenhard@cgb.ki.seE</a>i.se&gt;<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_APPENDIX"><B>APPENDIX</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>The rest of the documentation details each of the object<BR>methods. Internal methods are preceded with an underscore.<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_name"><B>name</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_ID"><B>ID</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_class"><B>class</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_matrix"><B>matrix</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_length"><B>length</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_revcom"><B>revcom</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_rawprint"><B>rawprint</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_prettyprint"><B>prettyprint</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>The above methods are common to all matrix objects. Please consult<BR><a href="../Matrix.html" target="urlWin"><b>TFBS::Matrix</b></a> to find out how to use them.<BR></pre>
</TD></TR>
</TABLE>
</body>
</html>
