<head>
<!-- Generated by perlmod2www.pl -->
<title>
_Alignment documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS::Matrix</H4>
<H3>_Alignment</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#libs">Included libraries</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR BGCOLOR="#ffd39b"><TD COLSPAN="2"><B>Globals (from <FONT COLOR="BLUE">use vars</FONT> definitions)</B></TD></TR>
<TR><TD COLSPAN="2"><font color="#1f32ff">$AUTOLOAD</font></TD></TR>
<TR BGCOLOR="#ffd39b"><TD COLSPAN="2"><B>Privates (from <FONT COLOR="BLUE">my</FONT> definitions)</B></TD></TR>
<TR><TD COLSPAN="2"><font color="#1f32ff">@graph</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$match</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::AlignIO</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Root::Root</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Seq</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::SimpleAlign</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">IO::String</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">PDL</font></b></TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../SitePair.html">TFBS::SitePair</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../SitePairSet.html">TFBS::SitePairSet</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">constant(1)</font></b> DEFAULT_WINDOW =&gt; 50 </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">constant(2)</font></b> DEFAULT_CUTOFF =&gt; 70 </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">constant(3)</font></b> DEFAULT_THRESHOLD =&gt; &quot; 80 % &quot; </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
</TABLE>
<A NAME="libs"></A><TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Inherit</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD><b><font color="#0000ff">Bio::Root::Root</font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><FONT COLOR="RED">No synopsis!</FONT></TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><FONT COLOR="RED">No description!</FONT></TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>DESTROY</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>_alignfile_to_alignobj</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>_alignfile_to_string</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>_alignobj_to_string</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>_alignstring_to_alignobj</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>_calculate_conservation</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
<TR><TD><B>_calculate_cutoff</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE7">Code</A></TD></TR>
<TR><TD><B>_parse_alignment</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE8">Code</A></TD></TR>
<TR><TD><B>_set_subpart_bounds</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE9">Code</A></TD></TR>
<TR><TD><B>_strip_gaps</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE10">Code</A></TD></TR>
<TR><TD><B>alignseq1</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE11">Code</A></TD></TR>
<TR><TD><B>alignseq2</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE12">Code</A></TD></TR>
<TR><TD><B>conservation1</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE13">Code</A></TD></TR>
<TR><TD><B>conservation2</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE14">Code</A></TD></TR>
<TR><TD><B>cutoff</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE15">Code</A></TD></TR>
<TR><TD><B>do_sitesearch</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE16">Code</A></TD></TR>
<TR><TD><B>end_at</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE17">Code</A></TD></TR>
<TR><TD><B>exclude_orf</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE18">Code</A></TD></TR>
<TR><TD><B>higher_pdlindex</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE19">Code</A></TD></TR>
<TR><TD><B>lower_pdlindex</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE20">Code</A></TD></TR>
<TR><TD><B>new</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE21">Code</A></TD></TR>
<TR><TD><B>pdlindex</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE22">Code</A></TD></TR>
<TR><TD><B>seq1length</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE23">Code</A></TD></TR>
<TR><TD><B>seq1name</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE24">Code</A></TD></TR>
<TR><TD><B>seq2length</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE25">Code</A></TD></TR>
<TR><TD><B>seq2name</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE26">Code</A></TD></TR>
<TR><TD><B>site_pair_set</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE27">Code</A></TD></TR>
<TR><TD><B>start_at</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE28">Code</A></TD></TR>
<TR><TD><B>subpart1</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE29">Code</A></TD></TR>
<TR><TD><B>subpart2</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE30">Code</A></TD></TR>
<TR><TD><B>window</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE31">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>DESTROY</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>DESTROY</b></font>
 {<pre>    <font color="#ff0000">## empty</font><BR></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>_alignfile_to_alignobj</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_alignfile_to_alignobj</b></font>
 {<pre>    <font color="#ff0000">## a utility function</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$alignfile</font>, <font color="#1f32ff">$format</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@_</font>,<font color="#007400">'clustalw'</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font>!<font color="#1f32ff">$format</font> and <font color="#1f32ff">$alignfile</font> =~ <font color="#006400"><b>/\.msf$/i</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$format</font> = <font color="#007400">'msf'</font> ;<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$alnio</font> = <font color="#8000ff"><b>Bio::AlignIO</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-file=&gt;<font color="#1f32ff">$alignfile</font>, -<font color="#4169e1"><b>format</b></font>=&gt;<font color="#1f32ff">$format</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$alnio</font>-&gt;next_aln;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>_alignfile_to_string</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_alignfile_to_string</b></font>
 {<pre>    <font color="#ff0000">## a utility function</font><BR>    <font color="#ff0000">## DEPRECATED !!!</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$alignfile</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$alignfile</font> =~ <font color="#006400"><b>/\.msf$/i</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$alignobj</font> = <font color="#8000ff"><b>Bio::SimpleAlign</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$alignobj</font>-&gt;<font color="#ff8204">read_MSF</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$alignfile</font><font color="#0000ff"><b>)</b></font>;
        <font color="#0000ff"><b>return</b></font> <font color="#ff8204">_alignobj_to_string</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$alignobj</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font> <font color="#ff0000">##assumed clustalw - no AlignIO import yet</font><BR>	<font color="#0000ff"><b>local</b></font> $/ = <font color="#4169e1"><b>undef</b></font>;
	<font color="#4169e1"><b>open</b></font> FILE, <font color="#1f32ff">$alignfile</font>
	    or <font color="#4169e1"><b>die</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"Could not read alignfile <font color="#1f32ff">$alignfile</font>, stopped"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$alignstring</font> = &lt;FILE&gt;;
	<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$alignstring</font>;
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>_alignobj_to_string</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_alignobj_to_string</b></font>
 {<pre>    <font color="#ff0000">## a utility function</font><BR>    <font color="#ff0000">## DEPRECATED</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$alignobj</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$alignstring</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$io</font> = <font color="#8000ff"><b>IO::String</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$alignstring</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$alnio</font> = <font color="#8000ff"><b>Bio::AlignIO</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-fh=&gt;<font color="#1f32ff">$io</font>, -<font color="#4169e1"><b>format</b></font>=&gt;<font color="#007400">"clustalw"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$alnio</font>-&gt;<font color="#ff8204">write_aln</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$alignobj</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$alnio</font>-&gt;<font color="#4169e1"><b>close</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
<font color="#ff0000">##    $io-&gt;close;</font><BR>    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$alignstring</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>_alignstring_to_alignobj</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_alignstring_to_alignobj</b></font>
 {<pre>    <font color="#ff0000">## a utility function</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$alignstring</font>, <font color="#1f32ff">$format</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@_</font>, <font color="#007400">'clustalw'</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$io</font> = <font color="#8000ff"><b>IO::String</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$alignstring</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$alnio</font> = <font color="#8000ff"><b>Bio::AlignIO</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-fh=&gt;<font color="#1f32ff">$io</font>, -<font color="#4169e1"><b>format</b></font>=&gt;<font color="#1f32ff">$format</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$alignobj</font> = <font color="#1f32ff">$alnio</font>-&gt;<font color="#ff8204">next_aln</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$alnio</font>-&gt;<font color="#4169e1"><b>close</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
<font color="#ff0000">##    $io-&gt;close;</font><BR>    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$alignstring</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>_calculate_conservation</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30"><A HREF="#CODE7">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_calculate_conservation</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$WINDOW</font>, <font color="#1f32ff">$which</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@seq1</font>, <font color="#1f32ff">@seq2</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$which</font>==2<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">@seq1</font> = @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>alignseq2array<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>;
	<font color="#1f32ff">@seq2</font> = @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>alignseq1array<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">@seq1</font> = @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>alignseq1array<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>;
	<font color="#1f32ff">@seq2</font> = @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>alignseq2array<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font>;
	<font color="#1f32ff">$which</font>=1;
    <font color="#0000ff"><b>}</b></font>

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@CONSERVATION</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@match</font>;

    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq1</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"-"</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#4169e1"><b>shift</b></font> <font color="#1f32ff">@seq1</font>;
	<font color="#4169e1"><b>shift</b></font> <font color="#1f32ff">@seq2</font>;
    <font color="#0000ff"><b>}</b></font>

    <font color="#0000ff"><b>for</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> <font color="#0000ff"><b>(</b></font>0..$<font color="#ff0000">##seq1) {</font><BR>  	<font color="#4169e1"><b>push</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@match</font>,<font color="#0000ff"><b>(</b></font> <font color="#4169e1"><b>uc</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq1</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#4169e1"><b>uc</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq2</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font> ? 1:0<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>
  	    <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq1</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"-"</font> or <font color="#1f32ff">$seq1</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"."</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE7"></A><B>_calculate_cutoff</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE6">prev</A></TD><TD WIDTH="30"><A HREF="#CODE8">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_calculate_cutoff</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ile</font> = 0.9;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@conservation_array</font> = <font color="#4169e1"><b>sort</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$a</font> &lt;=&gt; <font color="#1f32ff">$b</font><font color="#0000ff"><b>}</b></font> @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">conservation1</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>}</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$perc_90</font> = <font color="#1f32ff">$conservation_array</font><font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>int</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ile</font>*<font color="#4169e1"><b>scalar</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@conservation_array</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>]</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$perc_90</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE8"></A><B>_parse_alignment</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE7">prev</A></TD><TD WIDTH="30"><A HREF="#CODE9">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_parse_alignment</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq1</font>, <font color="#1f32ff">$seq2</font>, <font color="#1f32ff">$start</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$alignobj</font>;

    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-alignstring'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$alignobj</font> = <font color="#ff8204">_alignstring_to_alignobj</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-alignstring'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-file'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$alignobj</font> = <font color="#ff8204">_alignfile_to_alignobj</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-file'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font>  <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-alignobj<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$alignobj</font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-alignobj'</font><font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font>  <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"No -alignstring, -file or -alignobj passed."</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>


    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@match</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj1</font>, <font color="#1f32ff">$seqobj2</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">$alignobj</font>-&gt;each_seq;
    <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq1</font>, <font color="#1f32ff">$seq2</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj1</font>-&gt;seq, <font color="#1f32ff">$seqobj2</font>-&gt;seq<font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$start</font> = 1;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">seq1name</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj1</font>-&gt;display_id<font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">seq2name</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj2</font>-&gt;display_id<font color="#0000ff"><b>)</b></font>;


    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">alignseq1</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq1</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">alignseq2</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq2</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@seq1</font> = <font color="#0000ff"><b>(</b></font><font color="#007400">"-"</font>, <font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">''</font>, <font color="#1f32ff">$seq1</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@seq2</font> = <font color="#0000ff"><b>(</b></font><font color="#007400">"-"</font>, <font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">''</font>, <font color="#1f32ff">$seq2</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>alignseq1array<font color="#0000ff"><b>}</b></font> = <font color="#0000ff"><b>[</b></font><font color="#1f32ff">@seq1</font><font color="#0000ff"><b>]</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>alignseq2array<font color="#0000ff"><b>}</b></font> = <font color="#0000ff"><b>[</b></font><font color="#1f32ff">@seq2</font><font color="#0000ff"><b>]</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@seq1index</font>, <font color="#1f32ff">@seq2index</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$i1</font>, <font color="#1f32ff">$i2</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font>0, 0<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>for</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pos</font> <font color="#0000ff"><b>(</b></font>0..$<font color="#ff0000">##seq1) {</font><BR>		<font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$s1</font>, <font color="#1f32ff">$s2</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font>0, 0<font color="#0000ff"><b>)</b></font>;
		<font color="#1f32ff">$seq1</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$pos</font><font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>ne</b></font> <font color="#007400">"-"</font> and  <font color="#1f32ff">$s1</font> = ++<font color="#1f32ff">$i1</font>;
		<font color="#1f32ff">$seq2</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$pos</font><font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>ne</b></font> <font color="#007400">"-"</font> and  <font color="#1f32ff">$s2</font> = ++<font color="#1f32ff">$i2</font>;
		<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@seq1index</font>, <font color="#1f32ff">$s1</font>;
		<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@seq2index</font>, <font color="#1f32ff">$s2</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE9"></A><B>_set_subpart_bounds</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE8">prev</A></TD><TD WIDTH="30"><A HREF="#CODE10">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_set_subpart_bounds</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$subpart</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>if</b></font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$subpart</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$relative_to</font>, <font color="#1f32ff">$start</font>, <font color="#1f32ff">$end</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$subpart</font>-&gt;<font color="#0000ff"><b>{</b></font>-relative_to<font color="#0000ff"><b>}</b></font>,
					   <font color="#1f32ff">$subpart</font>-&gt;<font color="#0000ff"><b>{</b></font>-start<font color="#0000ff"><b>}</b></font>,
					   <font color="#1f32ff">$subpart</font>-&gt;<font color="#0000ff"><b>{</b></font>-end<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>unless</b></font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$relative_to</font><font color="#0000ff"><b>)</b></font> and <font color="#4169e1"><b>defined</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$start</font><font color="#0000ff"><b>)</b></font> and <font color="#4169e1"><b>defined</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$end</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Option -subpart missing suboption -relative_to, -start or -end"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
    	<font color="#0000ff"><b>if</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$relative_to</font> == 1<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$other_start</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">higher_pdlindex</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$start</font>, 1 =&gt; 2<font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$other_end</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">lower_pdlindex</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$end</font>, 1 =&gt; 2<font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$other_start</font>, <font color="#1f32ff">$other_end</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font>0,0<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>if</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$other_start</font> &gt; <font color="#1f32ff">$other_end</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">subpart1</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>{</b></font> -start =&gt; <font color="#1f32ff">$start</font>, -end =&gt; <font color="#1f32ff">$end</font> <font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">subpart2</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>{</b></font> -start =&gt; <font color="#1f32ff">$other_start</font>, -end =&gt; <font color="#1f32ff">$other_end</font> <font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
    	<font color="#0000ff"><b>elsif</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$relative_to</font> == 2<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$other_start</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">higher_pdlindex</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$start</font>, 2 =&gt; 1<font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$other_end</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">lower_pdlindex</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$end</font>, 2 =&gt; 1<font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$other_start</font>, <font color="#1f32ff">$other_end</font><font color="#0000ff"><b>)</b></font> = <font color="#0000ff"><b>(</b></font>0,0<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>if</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$other_start</font> &gt; <font color="#1f32ff">$other_end</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">subpart1</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>{</b></font> -start =&gt; <font color="#1f32ff">$other_start</font>, -end =&gt; <font color="#1f32ff">$other_end</font> <font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">subpart2</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>{</b></font> -start =&gt; <font color="#1f32ff">$start</font>, -end =&gt; <font color="#1f32ff">$end</font> <font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
	<font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Suboption -relative_to should be 1 or 2"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE10"></A><B>_strip_gaps</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE9">prev</A></TD><TD WIDTH="30"><A HREF="#CODE11">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_strip_gaps</b></font>
 {<pre>    <font color="#ff0000">## a utility function</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seq</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#1f32ff">$seq</font> =~ <font color="#006400"><b>s/\-|\.//g</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$seq</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE11"></A><B>alignseq1</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE10">prev</A></TD><TD WIDTH="30"><A HREF="#CODE12">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>alignseq1</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'alignseq1'</font><font color="#0000ff"><b>}</b></font>     = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'alignseq1'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE12"></A><B>alignseq2</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE11">prev</A></TD><TD WIDTH="30"><A HREF="#CODE13">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>alignseq2</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'alignseq2'</font><font color="#0000ff"><b>}</b></font>     = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'alignseq2'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE13"></A><B>conservation1</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE12">prev</A></TD><TD WIDTH="30"><A HREF="#CODE14">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>conservation1</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'conservation1'</font><font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'conservation1'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE14"></A><B>conservation2</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE13">prev</A></TD><TD WIDTH="30"><A HREF="#CODE15">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>conservation2</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'conservation2'</font><font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'conservation2'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE15"></A><B>cutoff</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE14">prev</A></TD><TD WIDTH="30"><A HREF="#CODE16">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>cutoff</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'cutoff'</font><font color="#0000ff"><b>}</b></font>        = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'cutoff'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE16"></A><B>do_sitesearch</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE15">prev</A></TD><TD WIDTH="30"><A HREF="#CODE17">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>do_sitesearch</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@args</font> <font color="#0000ff"><b>)</b></font> =  <font color="#1f32ff">@_</font>;

	<font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$MATRIXSET</font>, <font color="#1f32ff">$THRESHOLD</font>, <font color="#1f32ff">$CUTOFF</font><font color="#0000ff"><b>)</b></font> =
	    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_rearrange</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>PATTERN_SET THRESHOLD CUTOFF<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>]</b></font>, <font color="#1f32ff">@args</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font>!<font color="#1f32ff">$MATRIXSET</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"No -pattern_set passed to do_sitesearch"</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
	<font color="#1f32ff">$CUTOFF</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$CUTOFF</font> or DEFAULT_CUTOFF<font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$THRESHOLD</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$THRESHOLD</font> or DEFAULT_THRESHOLD<font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">site_pair_set</font><font color="#0000ff"><b>(</b></font><A HREF="../SitePairSet.html"><font color="#8000ff"><b>TFBS::SitePairSet</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>return</b></font> <font color="#0000ff"><b>if</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;subpart1 and <font color="#1f32ff">$self</font>-&gt;subpart1-&gt;<font color="#0000ff"><b>{</b></font>-start<font color="#0000ff"><b>}</b></font> == 0<font color="#0000ff"><b>)</b></font> or
	      <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;subpart2 and <font color="#1f32ff">$self</font>-&gt;subpart2-&gt;<font color="#0000ff"><b>{</b></font>-start<font color="#0000ff"><b>}</b></font> == 0<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#ff0000">## ^^^ If one of the subparts is a gap, there's no point in searching</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj1</font> = <font color="#8000ff"><b>Bio::Seq</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-<font color="#ff8204">seq</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">alignseq1</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>,
				-id =&gt; <font color="#007400">"Seq1"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$siteset1</font> =
	<font color="#1f32ff">$MATRIXSET</font>-&gt;<font color="#ff8204">search_seq</font><font color="#0000ff"><b>(</b></font>-seqobj =&gt; <font color="#1f32ff">$seqobj1</font>,
			    -threshold =&gt; <font color="#1f32ff">$THRESHOLD</font>,
			      -subpart =&gt; <font color="#1f32ff">$self</font>-&gt;subpart1<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$siteset1_itr</font> = <font color="#1f32ff">$siteset1</font>-&gt;<font color="#ff8204">Iterator</font><font color="#0000ff"><b>(</b></font>-sort_by =&gt; <font color="#007400">"start"</font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj2</font> = <font color="#8000ff"><b>Bio::Seq</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-<font color="#ff8204">seq</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">alignseq2</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>,
				-id =&gt; <font color="#007400">"Seq2"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$siteset2</font> =
	<font color="#1f32ff">$MATRIXSET</font>-&gt;<font color="#ff8204">search_seq</font><font color="#0000ff"><b>(</b></font>-seqobj =&gt; <font color="#1f32ff">$seqobj2</font>,
			    -threshold =&gt; <font color="#1f32ff">$THRESHOLD</font>,
			      -subpart =&gt; <font color="#1f32ff">$self</font>-&gt;subpart2<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$siteset2_itr</font> = <font color="#1f32ff">$siteset2</font>-&gt;<font color="#ff8204">Iterator</font><font color="#0000ff"><b>(</b></font>-sort_by =&gt; <font color="#007400">"start"</font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$site1</font> = <font color="#1f32ff">$siteset1_itr</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$site2</font> = <font color="#1f32ff">$siteset2_itr</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$site1</font> and <font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$site2</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pos1_in_aln</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">pdlindex</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$site1</font>-&gt;<font color="#ff8204">start</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>, 1=&gt;0<font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pos2_in_aln</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">pdlindex</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$site2</font>-&gt;<font color="#ff8204">start</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>, 2=&gt;0<font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$cmp</font> = <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$pos1_in_aln</font> &lt;=&gt; <font color="#1f32ff">$pos2_in_aln</font><font color="#0000ff"><b>)</b></font>
		    or <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$site1</font>-&gt;<font color="#ff8204">pattern</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font> cmp <font color="#1f32ff">$site2</font>-&gt;<font color="#ff8204">pattern</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>
		    or <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$site1</font>-&gt;<font color="#ff8204">strand</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font> cmp <font color="#1f32ff">$site2</font>-&gt;<font color="#ff8204">strand</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;

	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$cmp</font>==0<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font> <font color="#ff0000">#### match</font><BR>	    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#ff0000">## threshold test:</font><BR>		<font color="#1f32ff">$self</font>-&gt;conservation1-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$site1</font>-&gt;<font color="#ff8204">start</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>]</b></font>
		&gt;=
		<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">cutoff</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>
		<font color="#0000ff"><b>)</b></font>
	    <font color="#0000ff"><b>{</b></font>
		<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$site_pair</font> = <A HREF="../SitePair.html"><font color="#8000ff"><b>TFBS::SitePair</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$site1</font>, <font color="#1f32ff">$site2</font><font color="#0000ff"><b>)</b></font>;
		<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">site_pair_set</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$site_pair</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>}</b></font>
	    <font color="#1f32ff">$site1</font> = <font color="#1f32ff">$siteset1_itr</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$site2</font> = <font color="#1f32ff">$siteset2_itr</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
	<font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$cmp</font>&lt;0<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font> <font color="#ff0000">#### $siteset1 is behind</font><BR>	    <font color="#1f32ff">$site1</font> = <font color="#1f32ff">$siteset1_itr</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
	<font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$cmp</font>&gt;0<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font> <font color="#ff0000">#### $siteset2 is behind</font><BR>	    <font color="#1f32ff">$site2</font> = <font color="#1f32ff">$siteset2_itr</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE17"></A><B>end_at</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE16">prev</A></TD><TD WIDTH="30"><A HREF="#CODE18">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>end_at</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'end_at'</font><font color="#0000ff"><b>}</b></font>        = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'end_at'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE18"></A><B>exclude_orf</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE17">prev</A></TD><TD WIDTH="30"><A HREF="#CODE19">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>exclude_orf</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'exclude_orf'</font><font color="#0000ff"><b>}</b></font>   = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'exclude_orf'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE19"></A><B>higher_pdlindex</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE18">prev</A></TD><TD WIDTH="30"><A HREF="#CODE20">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>higher_pdlindex</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$input</font>, <font color="#1f32ff">$p1</font>, <font color="#1f32ff">$p2</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$p2</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Wrong number of parameters passed to lower_pdlindex"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$result</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> = <font color="#1f32ff">$input</font>;
    <font color="#0000ff"><b>until</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$result</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">pdlindex</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$i</font>, <font color="#1f32ff">$p1</font> =&gt; <font color="#1f32ff">$p2</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$i</font>++;
	<font color="#0000ff"><b>last</b></font> <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">pdlindex</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$i</font>, <font color="#1f32ff">$p1</font>=&gt;0<font color="#0000ff"><b>)</b></font> &gt; 0<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$result</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE20"></A><B>lower_pdlindex</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE19">prev</A></TD><TD WIDTH="30"><A HREF="#CODE21">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>lower_pdlindex</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$input</font>, <font color="#1f32ff">$p1</font>, <font color="#1f32ff">$p2</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$p2</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Wrong number of parameters passed to lower_pdlindex"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$result</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> = <font color="#1f32ff">$input</font>;

    <font color="#0000ff"><b>until</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$result</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">pdlindex</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$i</font>, <font color="#1f32ff">$p1</font> =&gt; <font color="#1f32ff">$p2</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$i</font>--;

		<font color="#0000ff"><b>last</b></font> <font color="#0000ff"><b>if</b></font> <font color="#1f32ff">$i</font>==0;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$result</font> or 1;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE21"></A><B>new</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE20">prev</A></TD><TD WIDTH="30"><A HREF="#CODE22">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>new</b></font>
 {<pre>
    <font color="#ff0000">## this is ugly; OK, OK, I'll rewrite it as soon as I can</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>bless</b></font> <font color="#0000ff"><b>{</b></font><font color="#0000ff"><b>}</b></font>, <font color="#4169e1"><b>ref</b></font> <font color="#1f32ff">$caller</font> || <font color="#1f32ff">$caller</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">window</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-window<font color="#0000ff"><b>}</b></font> or DEFAULT_WINDOW<font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_parse_alignment</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">seq1length</font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>length</b></font><font color="#0000ff"><b>(</b></font><font color="#ff8204">_strip_gaps</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">alignseq1</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">seq2length</font><font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>length</b></font><font color="#0000ff"><b>(</b></font><font color="#ff8204">_strip_gaps</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">alignseq2</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_set_subpart_bounds</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-subpart<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">##</font><BR>    <font color="#ff0000">## If a conservation profile is provided, no need to compute it again.</font><BR>    <font color="#ff0000">## NOTE: conservation2 never seems to be used anywhere else so don't worry</font><BR>    <font color="#ff0000">## about the fact we are ignoring it if conservation is passed in :)</font><BR>    <font color="#ff0000">##</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$cp</font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-conservation<font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$cp</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">conservation1</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$cp</font>-&gt;<font color="#ff8204">conservation</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">conservation1</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_calculate_conservation</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">window</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>,1<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
		<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">conservation2</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_calculate_conservation</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">window</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>,2<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>

	<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">cutoff</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-cutoff<font color="#0000ff"><b>}</b></font> or DEFAULT_CUTOFF<font color="#0000ff"><b>)</b></font>;
	<font color="#ff0000">##$self-&gt;threshold($args{-threshold} or DEFAULT_THRESHOLD);</font><BR>    <font color="#ff0000">##$self-&gt;_do_sitesearch</font><BR>	<font color="#ff0000">##(($args{-pattern_set} or $self-&gt;throw(&quot;No -matrixset parameter&quot;)),</font><BR>	<font color="#ff0000">## ($args{-threshold} or DEFAULT_THRESHOLD),</font><BR>	<font color="#ff0000">## ());</font><BR>
    <font color="#ff0000">## $self-&gt;_set_start_end(%args);  # Maybe later...</font><BR>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE22"></A><B>pdlindex</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE21">prev</A></TD><TD WIDTH="30"><A HREF="#CODE23">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>pdlindex</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$input</font>, <font color="#1f32ff">$p1</font>, <font color="#1f32ff">$p2</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font> ;
    <font color="#ff0000">## print (&quot;PARAMS &quot;, join(&quot;:&quot;, @_), &quot;\n&quot;);</font><BR>    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$input</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"PDL"</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>pdlindex<font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$input</font>;
    <font color="#0000ff"><b>}</b></font>

    <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$p2</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>pdlindex<font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@results</font> = list
	    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>pdlindex<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">xchg</font><font color="#0000ff"><b>(</b></font>0,1<font color="#0000ff"><b>)</b></font>-&gt;<font color="#ff8204">slice</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$p2</font><font color="#0000ff"><b>)</b></font>-&gt;where
		<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>pdlindex<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">xchg</font><font color="#0000ff"><b>(</b></font>0,1<font color="#0000ff"><b>)</b></font>-&gt;<font color="#ff8204">slice</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$p1</font><font color="#0000ff"><b>)</b></font>==<font color="#1f32ff">$input</font><font color="#0000ff"><b>)</b></font>;
	<font color="#4169e1"><b>wantarray</b></font> ? <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">@results</font> : <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$results</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>;
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE23"></A><B>seq1length</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE22">prev</A></TD><TD WIDTH="30"><A HREF="#CODE24">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>seq1length</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq1length'</font><font color="#0000ff"><b>}</b></font>    = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq1length'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE24"></A><B>seq1name</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE23">prev</A></TD><TD WIDTH="30"><A HREF="#CODE25">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>seq1name</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq1name'</font><font color="#0000ff"><b>}</b></font>      = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq1name'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE25"></A><B>seq2length</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE24">prev</A></TD><TD WIDTH="30"><A HREF="#CODE26">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>seq2length</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq2length'</font><font color="#0000ff"><b>}</b></font>    = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq2length'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE26"></A><B>seq2name</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE25">prev</A></TD><TD WIDTH="30"><A HREF="#CODE27">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>seq2name</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq2name'</font><font color="#0000ff"><b>}</b></font>      = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq2name'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE27"></A><B>site_pair_set</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE26">prev</A></TD><TD WIDTH="30"><A HREF="#CODE28">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>site_pair_set</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'site_pair_set'</font><font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'site_pair_set'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE28"></A><B>start_at</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE27">prev</A></TD><TD WIDTH="30"><A HREF="#CODE29">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>start_at</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'start_at'</font><font color="#0000ff"><b>}</b></font>      = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'start_at'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE29"></A><B>subpart1</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE28">prev</A></TD><TD WIDTH="30"><A HREF="#CODE30">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>subpart1</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'subpart1'</font><font color="#0000ff"><b>}</b></font>  = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'subpart1'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE30"></A><B>subpart2</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE29">prev</A></TD><TD WIDTH="30"><A HREF="#CODE31">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>subpart2</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'subpart2'</font><font color="#0000ff"><b>}</b></font>  = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'subpart2'</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE31"></A><B>window</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE30">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>window</b></font>
 {<pre> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'window '</font><font color="#0000ff"><b>}</b></font>       = <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>if</b></font> <font color="#4169e1"><b>exists</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>; <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'window '</font><font color="#0000ff"><b>}</b></font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
</TABLE>
<B>No general documentation available.</B><BR>
</body>
</html>
