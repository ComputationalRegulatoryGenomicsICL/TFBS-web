<head>
<!-- Generated by perlmod2www.pl -->
<title>
ICM documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS::Matrix</H4>
<H3>ICM</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#SUMMARY">Summary</A></TD>
<TD><A HREF="#libs">Included libraries</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#SYNOPSIS">Synopsis</A></TD>
<TD><A HREF="#DESCRIPTION">Description</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR><TD BGCOLOR="#ffae84"><B>Summary</B></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD><pre>    <BR><B>TFBS::Matrix::ICM</B> - class for information content matrices of nucleotide<BR>patterns<BR></pre></TD></TR>
</TABLE>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR><TD COLSPAN="2">No package variables defined.</TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Root::Root</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::SeqIO</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">File::Temp</font></b> qw /:POSIX/ </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">PDL</font></b></TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../Matrix.html">TFBS::Matrix</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
</TABLE>
<A NAME="libs"></A><TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Inherit</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD><b><font color="#0000ff">Bio::Root::Root</font></b> <b><font color="#0000ff"><a href="../Matrix.html">TFBS::Matrix</a></font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><BR><A NAME="_pod_* creating a <B>TFBS::Matrix::ICM</B> object manually:">    * creating a <B>TFBS::Matrix::ICM</B> object manually:</A><BR>        my $matrixref = [ [ 0.00, 0.30, 0.00, 0.00, 0.24, 0.00 ],<BR>		      [ 0.00, 0.00, 0.00, 1.45, 0.42, 0.00 ],<BR>		      [ 0.00, 0.89, 2.00, 0.00, 0.00, 0.00 ],<BR>		      [ 0.00, 0.00, 0.00, 0.13, 0.06, 2.00 ]<BR>		    ];	<BR>    my $icm = <B>TFBS::Matrix::ICM</B>-&gt;new(-matrix =&gt; $matrixref,<BR>				     -name   =&gt; &quot;MyProfile&quot;,<BR>				     -ID     =&gt; &quot;M0001&quot;<BR>				    );<BR> <BR>    # or<BR> <BR>    my $matrixstring = &lt;&lt;ENDMATRIX<BR>    2.00   0.30   0.00   0.00   0.24   0.00<BR>    0.00   0.00   0.00   1.45   0.42   0.00<BR>    0.00   0.89   2.00   0.00   0.00   0.00<BR>    0.00   0.00   0.00   0.13   0.06   2.00<BR>    ENDMATRIX<BR>    ;<BR>    my $icm = <B>TFBS::Matrix::ICM</B>-&gt;new(-matrixstring =&gt; $matrixstring,<BR>				     -name   	   =&gt; &quot;MyProfile&quot;,<BR>				     -ID           =&gt; &quot;M0001&quot;<BR>				    );<BR><BR><A NAME="_pod_* retrieving a TFBS::Matix::ICM object from a database:">    * retrieving a TFBS::Matix::ICM object from a database:</A><BR>    (See documentation of individual TFBS::DB::* modules to learn<BR>how to connect to different types of pattern databases and retrieve<BR>TFBS::Matrix::* objects from them.)<BR>    <BR>    my $db_obj = TFBS::DB::JASPAR2-&gt;new<BR>		    (-connect =&gt; [&quot;dbi:mysql:JASPAR2:myhost&quot;,<BR>				  &quot;myusername&quot;, &quot;mypassword&quot;]);<BR>    my $pfm = $db_obj-&gt;get_Matrix_by_ID(&quot;M0001&quot;, &quot;ICM&quot;);<BR>    # or<BR>    my $pfm = $db_obj-&gt;get_Matrix_by_name(&quot;MyProfile&quot;, &quot;ICM&quot;);<BR><BR><A NAME="_pod_">    </A><BR>    (see decumentation of TFBS::MatrixSet to learn how to create <BR>objects for storage and manipulation of multiple matrices)<BR><BR>        my @icm_list = $matrixset-&gt;all_patterns(-sort_by=&gt;&quot;name&quot;);<BR><BR>    * drawing a sequence logo<BR>          <BR>    $icm-&gt;draw_logo(-file=&gt;&quot;logo.png&quot;, <BR>		    -full_scale =&gt;2.25,<BR>		    -xsize=&gt;500,<BR>		    -ysize =&gt;250, <BR>		    -graph_title=&gt;&quot;C/EBPalpha binding site logo&quot;, <BR>		    -x_title=&gt;&quot;position&quot;, <BR>		    -y_title=&gt;&quot;bits&quot;);<BR><BR><BR></pre>
</TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><B>TFBS::Matrix::ICM</B> is a class whose instances are objects representing<BR>position weight matrices (PFMs). An ICM is normally calculated from a<BR>raw position frequency matrix (see <a href="PFM.html" target="urlWin"><b>TFBS::Matrix::PFM</b></a><BR>for the explanation of position frequency matrices). For example, given<BR>the following position frequency matrix,<BR><BR>    A:[ 12     3     0     0     4     0  ]<BR>    C:[  0     0     0    11     7     0  ]<BR>    G:[  0     9    12     0     0     0  ]<BR>    T:[  0     0     0     1     1    12  ]<BR><BR>the standard computational procedure is applied to convert it into the<BR>following information content matrix:<BR><BR>    A:[2.00  0.30  0.00  0.00  0.24  0.00]<BR>    C:[0.00  0.00  0.00  1.45  0.42  0.00]<BR>    G:[0.00  0.89  2.00  0.00  0.00  0.00]<BR>    T:[0.00  0.00  0.00  0.13  0.06  2.00]<BR><BR>which contains the &quot;weights&quot; associated with the occurence of each<BR>nucleotide at the given position in a pattern.<BR><BR>A TFBS::Matrix::PWM object is equipped with methods to search nucleotide<BR>sequences and pairwise alignments of nucleotide sequences with the<BR>pattern they represent, and return a set of sites in nucleotide<BR>sequence (a TFBS::SiteSet object for single sequence search, and a<BR>TFBS::SitePairSet for the alignment search).<BR></pre>
</TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>DESTROY</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>_check_ic_validity</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>_draw_ps_logo</B></TD><TD><A HREF="#POD1">Description</A></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>draw_A</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>draw_C</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>draw_G</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
<TR><TD><B>draw_T</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE7">Code</A></TD></TR>
<TR><TD><B>draw_logo</B></TD><TD><A HREF="#POD2">Description</A></TD><TD><A HREF="#CODE8">Code</A></TD></TR>
<TR><TD><B>new</B></TD><TD><A HREF="#POD3">Description</A></TD><TD><A HREF="#CODE9">Code</A></TD></TR>
<TR><TD><B>to_PWM</B></TD><TD><A HREF="#POD4">Description</A></TD><TD><A HREF="#CODE10">Code</A></TD></TR>
<TR><TD><B>total_ic</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE11">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod__draw_ps_logo"></A><A NAME="POD1"></A><B>_draw_ps_logo</B></TD><TD><A HREF="#CODE3">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD>prev</TD><TD><A HREF="#POD2">next</A></TD></TR></TABLE>
<pre> Title   : _draw_ps_logo <BR> Usage   : my $postscript_string = $icm-&gt;_draw_ps_logo(%args)<BR>           Internal method, should be accessed using draw_logo()<BR> Function: Draws a &quot;sequence logo&quot;, a graphical representation<BR>	   of a possibly degenerate fixed-width nucleotide<BR>	   sequence pattern, from the information content matrix<BR> Returns : a postscript string;<BR>	   if you only need the image file you can ignore it<BR> Args    : -file,       # the name of the output PNG image file<BR>		        # OPTIONAL: default none<BR>	   -xsize       # width of the image in pixels<BR>		        # OPTIONAL: default 600<BR>	   -ysize       # height of the image in pixels<BR>		        # OPTIONAL: default 5/8 of -x_size<BR>	   -full_scale  # the maximum value on the y-axis, in bits<BR>		        # OPTIONAL: default 2.25<BR>	   -graph_title,# the graph title<BR>			# OPTIONAL: default none<BR>	   -x_title,    # x-axis title; OPTIONAL: default none<BR>	   -y_title     # y-axis title; OPTIONAL: default none<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_draw_logo"></A><A NAME="POD2"></A><B>draw_logo</B></TD><TD><A HREF="#CODE8">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD1">prev</A></TD><TD><A HREF="#POD3">next</A></TD></TR></TABLE>
<pre> Title   : draw_logo<BR> Usage   : my $gdImageObj = $icm-&gt;draw_logo(%args)<BR> Function: Draws a &quot;sequence logo&quot;, a graphical representation<BR>	   of a possibly degenerate fixed-width nucleotide<BR>	   sequence pattern, from the information content matrix<BR> Returns : a GD::Image object;<BR>	   if you only need the image file you can ignore it<BR> Args    : -file,       # the name of the output PNG image file<BR>		        # OPTIONAL: default none<BR>	   -xsize       # width of the image in pixels<BR>		        # OPTIONAL: default 600<BR>	   -ysize       # height of the image in pixels<BR>		        # OPTIONAL: default 5/8 of -x_size<BR>	   -margin      # size of image margins in pixels<BR>		        # OPTIONAL: default 15% of -y_size<BR>	   -full_scale  # the maximum value on the y-axis, in bits<BR>		        # OPTIONAL: default 2.25<BR>	   -graph_title,# the graph title<BR>			# OPTIONAL: default none<BR>	   -x_title,    # x-axis title; OPTIONAL: default none<BR>	   -y_title     # y-axis title; OPTIONAL: default none<BR>           -error_bars  # reference to an array of S.D. values for each column; OPTIONAL<BR>           -ps          # if true, produces a postscript string instead of a GD::Image object<BR>            -pdf          # if true AND the -file argumant is used, produces an output pdf file<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_new"></A><A NAME="POD3"></A><B>new</B></TD><TD><A HREF="#CODE9">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD2">prev</A></TD><TD><A HREF="#POD4">next</A></TD></TR></TABLE>
<pre> Title   : new<BR> Usage   : my $icm = <B>TFBS::Matrix::ICM</B>-&gt;new(%args)<BR> Function: constructor for the <B>TFBS::Matrix::ICM</B> object<BR> Returns : a new <B>TFBS::Matrix::ICM</B> object<BR> Args    : # you must specify either one of the following three:<BR> <BR>	   -matrix,      # reference to an array of arrays of integers<BR>	      #or<BR>	   -matrixstring,# a string containing four lines<BR>	                 # of tab- or space-delimited integers<BR>	      #or<BR>	   -matrixfile,  # the name of a file containing four lines<BR>	                 # of tab- or space-delimited integers<BR>	   #######<BR> <BR>           -name,        # string, OPTIONAL<BR>           -ID,          # string, OPTIONAL<BR>           -class,       # string, OPTIONAL<BR>           -tags         # an array reference, OPTIONAL<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_to_PWM"></A><A NAME="POD4"></A><B>to_PWM</B></TD><TD><A HREF="#CODE10">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD3">prev</A></TD><TD><A HREF="#POD5">next</A></TD></TR></TABLE>
<pre> Title   : to_PWM<BR> Usage   : my $pwm = $icm-&gt;to_PWM()<BR> Function: converts an  information content matrix (a <B>TFBS::Matrix::ICM</B> object)<BR>	   to position weight matrix. At present it assumes uniform<BR>	   background distribution of nucleotide frequencies.<BR> Returns : a new TFBS::Matrix::PWM object<BR> Args    : none; in the future releases, it should be able to accept<BR>	   a user defined background probability of the four<BR>	   nucleotides<BR></pre>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>DESTROY</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>DESTROY</b></font>
 {<pre>    <font color="#ff0000">## nothing</font><BR></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>_check_ic_validity</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_check_ic_validity</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#ff0000">## to do</font><BR></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>_draw_ps_logo</B></TD><TD><A HREF="#POD1">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_draw_ps_logo</b></font>
 {<pre> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>shift</b></font>;
 <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%args</font> = <font color="#0000ff"><b>(</b></font>-xsize      =&gt; 600,
	     -full_scale =&gt; 2.25,
	     -graph_title=&gt; <font color="#007400">""</font>,
	     -x_title    =&gt; <font color="#007400">""</font>,
	     -y_title    =&gt; <font color="#007400">""</font>,
	     <font color="#1f32ff">@_</font><font color="#0000ff"><b>)</b></font>;   
    
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$xsize</font>= <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-xsize'</font><font color="#0000ff"><b>}</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$max_ysize</font>= <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-ysize'</font><font color="#0000ff"><b>}</b></font> ||<font color="#4169e1"><b>int</b></font>  5* <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-xsize'</font><font color="#0000ff"><b>}</b></font>/8;<BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ysize</font>=  <font color="#1f32ff">$max_ysize</font>*<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-full_scale'</font><font color="#0000ff"><b>}</b></font>-<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-full_scale'</font><font color="#0000ff"><b>}</b></font>-2<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font><font color="#006400"><b>/</b></font><font color="#1f32ff">$args</font>{'-full_scale'};<BR>   
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$x</font>=100; <font color="#ff0000">## nternal, for placement on 'paper'</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$y</font>=100; 
   
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$out</font>= <font color="#007400">"%!PS-Adobe-2.0 
%%Orientation: Portrait
%%Pages: 1
%%BoundingBox: 0 0 "</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-xsize'</font><font color="#0000ff"><b>}</b></font>*1.2<font color="#0000ff"><b>)</b></font>.<font color="#007400">" "</font>.<font color="#0000ff"><b>(</b></font> <font color="#1f32ff">$max_ysize</font>*1.5<font color="#0000ff"><b>)</b></font>.<font color="#007400">"
%%BeginSetup
%%EndSetup
%%Magnification: 1.0000
%%EndProlog
%%end
%%save
gsave\n"</font>;

    <font color="#ff0000">##colors and correction definitions</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%color</font>;
    <font color="#1f32ff">$color</font><font color="#0000ff"><b>{</b></font><font color="#007400">'black'</font><font color="#0000ff"><b>}</b></font>=<font color="#007400">"0.000 0.000 0.000 setrgbcolor"</font>;
    <font color="#1f32ff">$color</font><font color="#0000ff"><b>{</b></font><font color="#007400">'A'</font><font color="#0000ff"><b>}</b></font>=<font color="#007400">"0.000 1.000 0.000 setrgbcolor"</font>;
    <font color="#1f32ff">$color</font><font color="#0000ff"><b>{</b></font><font color="#007400">'C'</font><font color="#0000ff"><b>}</b></font>=<font color="#007400">"0.000 0.000 1.000 setrgbcolor"</font>;
    <font color="#1f32ff">$color</font><font color="#0000ff"><b>{</b></font><font color="#007400">'G'</font><font color="#0000ff"><b>}</b></font>=<font color="#007400">"1.000 0.860 0.000 setrgbcolor"</font>;
    <font color="#1f32ff">$color</font><font color="#0000ff"><b>{</b></font><font color="#007400">'T'</font><font color="#0000ff"><b>}</b></font>=<font color="#007400">"1.000 0.000 0.000 setrgbcolor"</font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$fontsize</font>= <font color="#4169e1"><b>int</b></font> <font color="#1f32ff">$ysize</font>*0.68;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$fontwidth</font>=<font color="#ff8204">1</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>/</b></font><font color="#1f32ff">$self</font>-&gt;length());<BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%w_correct</font>; <font color="#ff0000">## correction of font widths</font><BR>    <font color="#1f32ff">$w_correct</font><font color="#0000ff"><b>{</b></font><font color="#007400">'A'</font><font color="#0000ff"><b>}</b></font>=0.95;
    <font color="#1f32ff">$w_correct</font><font color="#0000ff"><b>{</b></font><font color="#007400">'T'</font><font color="#0000ff"><b>}</b></font>=1.05;
    <font color="#1f32ff">$w_correct</font><font color="#0000ff"><b>{</b></font><font color="#007400">'C'</font><font color="#0000ff"><b>}</b></font>=0.90;
    <font color="#1f32ff">$w_correct</font><font color="#0000ff"><b>{</b></font><font color="#007400">'G'</font><font color="#0000ff"><b>}</b></font>=0.90;
    
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%y_next</font>;<font color="#ff0000">##correction of font heights</font><BR>    <font color="#1f32ff">$y_next</font><font color="#0000ff"><b>{</b></font><font color="#007400">'A'</font><font color="#0000ff"><b>}</b></font>=1;
    <font color="#1f32ff">$y_next</font><font color="#0000ff"><b>{</b></font><font color="#007400">'T'</font><font color="#0000ff"><b>}</b></font>=1;           
    <font color="#1f32ff">$y_next</font><font color="#0000ff"><b>{</b></font><font color="#007400">'C'</font><font color="#0000ff"><b>}</b></font>=0.94;
    <font color="#1f32ff">$y_next</font><font color="#0000ff"><b>{</b></font><font color="#007400">'G'</font><font color="#0000ff"><b>}</b></font>=0.94;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%y_correct</font>; <font color="#ff0000">##correction of font bounding boxes</font><BR>    <font color="#1f32ff">$y_correct</font><font color="#0000ff"><b>{</b></font><font color="#007400">'A'</font><font color="#0000ff"><b>}</b></font>=0;
    <font color="#1f32ff">$y_correct</font><font color="#0000ff"><b>{</b></font><font color="#007400">'C'</font><font color="#0000ff"><b>}</b></font>=0.035*<font color="#1f32ff">$fontsize</font>;
    <font color="#1f32ff">$y_correct</font><font color="#0000ff"><b>{</b></font><font color="#007400">'G'</font><font color="#0000ff"><b>}</b></font>=0.035*<font color="#1f32ff">$fontsize</font>;
    <font color="#1f32ff">$y_correct</font><font color="#0000ff"><b>{</b></font><font color="#007400">'T'</font><font color="#0000ff"><b>}</b></font>=0;
 
 
    <font color="#ff0000">##define y axis,tickmarks and scaling</font><BR> 
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$font</font>= <font color="#1f32ff">$fontwidth</font>/5;  <BR>    <font color="#1f32ff">$out</font>.=<font color="#007400">"newpath\n "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>-10<font color="#0000ff"><b>)</b></font>.<font color="#007400">" "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$y</font>+2*<font color="#1f32ff">$ysize</font><font color="#006400"><b>/4 ).&quot; moveto\n&quot;. &quot;</b></font><font color="#1f32ff">$x</font><font color="#006400"><b> &quot;. (</b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+2*</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>4 <font color="#0000ff"><b>)</b></font> .<font color="#007400">" lineto\n stroke\n"</font>;
    <font color="#1f32ff">$out</font>.= <font color="#007400">"gsave\n/Times-Bold findfont <font color="#1f32ff">$color</font>{black} [<font color="#1f32ff">$font</font> 0 0 <font color="#1f32ff">$font</font> 0 0] makefont setfont\n"</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>-20<font color="#0000ff"><b>)</b></font>. <font color="#007400">" "</font>.<font color="#0000ff"><b>(</b></font> <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font>/2).&quot;  moveto\n&quot;;<BR>    <font color="#1f32ff">$out</font>.=<font color="#007400">" (1) show\n grestore\n"</font> ;
    <font color="#1f32ff">$out</font>.=<font color="#007400">"newpath\n "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>-10<font color="#0000ff"><b>)</b></font>.<font color="#007400">" "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font> <font color="#0000ff"><b>)</b></font>.<font color="#007400">" moveto\n"</font>. <font color="#007400">"<font color="#1f32ff">$x</font> "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font> .<font color="#007400">" lineto\n stroke\n"</font>;
    <font color="#1f32ff">$out</font>.=<font color="#007400">"newpath\n "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>-10<font color="#0000ff"><b>)</b></font>.<font color="#007400">" "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$y</font>+<font color="#1f32ff">$max_ysize</font> <font color="#0000ff"><b>)</b></font>.<font color="#007400">" moveto\n"</font>. <font color="#007400">"<font color="#1f32ff">$x</font> "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$y</font>+<font color="#1f32ff">$max_ysize</font><font color="#0000ff"><b>)</b></font> .<font color="#007400">" lineto\n stroke\n"</font>;
     <font color="#1f32ff">$out</font>.= <font color="#007400">"gsave\n/Times-Bold findfont <font color="#1f32ff">$color</font>{black} [<font color="#1f32ff">$font</font> 0 0 <font color="#1f32ff">$font</font> 0 0] makefont setfont\n"</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>-20<font color="#0000ff"><b>)</b></font>. <font color="#007400">" "</font>.<font color="#0000ff"><b>(</b></font> <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>.<font color="#007400">"  moveto\n"</font>;
    <font color="#1f32ff">$out</font>.=<font color="#007400">" (2) show\n grestore\n"</font> ;
    <font color="#1f32ff">$out</font>.=<font color="#007400">"newpath\n <font color="#1f32ff">$x</font> <font color="#1f32ff">$y</font>  moveto\n"</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font><font color="#0000ff"><b>)</b></font>. <font color="#007400">" "</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$y</font>+<font color="#1f32ff">$max_ysize</font><font color="#0000ff"><b>)</b></font> .<font color="#007400">" lineto\n stroke\n"</font>;
    <font color="#1f32ff">$out</font>.=<font color="#007400">"newpath\n <font color="#1f32ff">$x</font> <font color="#1f32ff">$y</font>  moveto\n"</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#0000ff"><b>)</b></font>. <font color="#007400">" "</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$y</font><font color="#0000ff"><b>)</b></font> .<font color="#007400">" lineto\n stroke\n"</font>;
    
    
    <font color="#ff0000">## draw titles if requested</font><BR>    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-y_title'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$out</font>.= <font color="#007400">"gsave\n/Times-Italic findfont <font color="#1f32ff">$color</font>{black} [<font color="#1f32ff">$font</font> 0 0 <font color="#1f32ff">$font</font> 0 0] makefont setfont\n"</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>-40<font color="#0000ff"><b>)</b></font>. <font color="#007400">" "</font>.<font color="#0000ff"><b>(</b></font> <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font>/2).&quot;  moveto\n&quot;;<BR>        <font color="#1f32ff">$out</font>.=<font color="#007400">" 90 rotate (<font color="#1f32ff">$args</font>{'-y_title'}) show\n grestore\n"</font> ;
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-x_title'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$out</font>.= <font color="#007400">"gsave\n/Times-Italic findfont <font color="#1f32ff">$color</font>{black} [<font color="#1f32ff">$font</font> 0 0 <font color="#1f32ff">$font</font> 0 0] makefont setfont\n"</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#006400"><b>/2.5). &quot; &quot;.( </b></font><font color="#1f32ff">$y</font>*(0.60)).&quot;  moveto\n&quot;;<BR>        <font color="#1f32ff">$out</font>.=<font color="#007400">" (<font color="#1f32ff">$args</font>{'-x_title'}) show\n grestore\n"</font> ;
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-title'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$out</font>.= <font color="#007400">"gsave\n/Times-Roman findfont <font color="#1f32ff">$color</font>{black} ["</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$font</font>*2<font color="#0000ff"><b>)</b></font>.<font color="#007400">" 0 0 <font color="#1f32ff">$font</font> 0 0] makefont setfont\n"</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#006400"><b>/3). &quot; &quot;.( </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$max_ysize</font>*1.1).&quot;  moveto\n&quot;;<BR>         
        <font color="#1f32ff">$out</font>.=<font color="#007400">" (<font color="#1f32ff">$args</font>{'-title'}) show\n grestore\n"</font> ;
    <font color="#0000ff"><b>}</b></font>
    

    <font color="#ff0000">## define x axis and x tickmarks</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$col_width</font>=<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>/</b></font><font color="#1f32ff">$self</font><font color="#006400"><b>-&gt;length()) -0.006*</b></font><font color="#1f32ff">$xsize</font>;<BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$x_now</font>;

    <font color="#0000ff"><b>for</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font>=1; <font color="#1f32ff">$i</font>&lt;=<font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>length</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>; <font color="#1f32ff">$i</font>++<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$x_now</font>=<font color="#1f32ff">$x</font>+<font color="#1f32ff">$col_width</font>*<font color="#1f32ff">$i</font>;    
        <font color="#1f32ff">$out</font>.=<font color="#007400">"newpath\n "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x_now</font><font color="#0000ff"><b>)</b></font>.<font color="#007400">" "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$y</font><font color="#0000ff"><b>)</b></font>.<font color="#007400">" moveto\n"</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x_now</font><font color="#0000ff"><b>)</b></font>.<font color="#007400">" "</font>. <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$y</font>-<font color="#1f32ff">$ysize</font>/20 ) .&quot; lineto\n stroke\n&quot;;<BR>        <font color="#1f32ff">$out</font>.= <font color="#007400">"gsave\n/Times-Bold findfont <font color="#1f32ff">$color</font>{black} [<font color="#1f32ff">$font</font> 0 0 <font color="#1f32ff">$font</font> 0 0] makefont setfont\n"</font>.<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x_now</font>-<font color="#1f32ff">$col_width</font><font color="#006400"><b>/2). &quot; &quot;.( </b></font><font color="#1f32ff">$y</font>-20).&quot;  moveto\n&quot;;<BR>        <font color="#1f32ff">$out</font>.=<font color="#007400">" (<font color="#1f32ff">$i</font>) show\n grestore\n"</font> ;
    <font color="#0000ff"><b>}</b></font>
    
    <font color="#ff0000">## draw the logo</font><BR>    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> <font color="#0000ff"><b>(</b></font>0..<font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>length</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>-1 <font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font> <font color="#ff0000">## get the $i-th column of matrix</font><BR>        
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%ic</font>; 
	<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font>A<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font>C<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font>G<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font>T<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> = list <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">pdl_matrix</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>)</b></font>;  
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@draw_order</font> = <font color="#4169e1"><b>sort</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$a</font><font color="#0000ff"><b>}</b></font>&lt;=&gt;<font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$b</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font> <font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>A C G T<font color="#0000ff"><b>)</b></font>;

        <font color="#ff0000">##draw this position</font><BR>        
        <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$letter</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@draw_order</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$letter</font><font color="#0000ff"><b>}</b></font>=0.0000001 <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font> <font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$letter</font><font color="#0000ff"><b>}</b></font>==0<font color="#0000ff"><b>)</b></font>; <font color="#ff0000">## some interpretors do not uderstand size 0</font><BR>            <font color="#1f32ff">$out</font>.= <font color="#007400">"gsave\n/Helvetica-Bold findfont   <font color="#1f32ff">$color</font>{<font color="#1f32ff">$letter</font>} ["</font>.<font color="#1f32ff">$fontwidth</font>*<font color="#1f32ff">$w_correct</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$letter</font><font color="#0000ff"><b>}</b></font>.<font color="#007400">" 0 0 "</font>;
            <font color="#1f32ff">$out</font>.= <font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$letter</font><font color="#0000ff"><b>}</b></font>*<font color="#1f32ff">$fontsize</font>*<font color="#1f32ff">$y_next</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$letter</font><font color="#0000ff"><b>}</b></font> ;
            <font color="#1f32ff">$y</font>+=<font color="#1f32ff">$y_correct</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$letter</font><font color="#0000ff"><b>}</b></font>*<font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$letter</font><font color="#0000ff"><b>}</b></font>; <font color="#ff0000">##movement that isletter specific, due to bounding boxes</font><BR>            <font color="#1f32ff">$out</font>.= <font color="#007400">" 0 0] makefont setfont\n<font color="#1f32ff">$x</font>  <font color="#1f32ff">$y</font>  moveto\n"</font>;       
            <font color="#1f32ff">$out</font>.= <font color="#007400">" (<font color="#1f32ff">$letter</font>) show\n grestore\n"</font>  ;    
            <font color="#1f32ff">$y</font>+=<font color="#1f32ff">$fontsize</font>*<font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$letter</font><font color="#0000ff"><b>}</b></font>*0.75; <font color="#ff0000">##ic content move</font><BR>        <font color="#0000ff"><b>}</b></font>
        <font color="#1f32ff">$x</font>+=<font color="#1f32ff">$fontwidth</font>/1.6;<BR>        <font color="#1f32ff">$y</font>=100;

  <font color="#0000ff"><b>}</b></font>
    <font color="#ff0000">## save as file if requested </font><BR>    <font color="#0000ff"><b>if</b></font>  <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>  
	<font color="#4169e1"><b>open</b></font> <font color="#0000ff"><b>(</b></font>PSFILE, <font color="#007400">"&gt;"</font>.<font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
	    or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Could not write to "</font>.<font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
        <font color="#4169e1"><b>print</b></font> PSFILE <font color="#1f32ff">$out</font>;
	<font color="#4169e1"><b>close</b></font> PSFILE;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-pdf<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
       
	<font color="#4169e1"><b>system</b></font> <font color="#007400">"ps2pdf <font color="#1f32ff">$args</font>{-file} "</font>.<font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font>.<font color="#007400">".pdf "</font>; 
        <font color="#4169e1"><b>system</b></font> <font color="#007400">" mv <font color="#1f32ff">$args</font>{-file}.pdf <font color="#1f32ff">$args</font>{-file}"</font>; 
    <font color="#0000ff"><b>}</b></font>
    
    
    
    
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$out</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>draw_A</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>draw_A</b></font>
 {<pre>    
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$im</font>, <font color="#1f32ff">$x</font>, <font color="#1f32ff">$y</font>, <font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$ysize</font>, <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$green</font> = <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">colorAllocate</font><font color="#0000ff"><b>(</b></font>0,255,0<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$outPoly</font> = <font color="#8000ff"><b>GD::Polygon</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$outPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$outPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*.42, <font color="#1f32ff">$y</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$outPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*.58, <font color="#1f32ff">$y</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$outPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$outPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+0.85*<font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$outPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+0.725*<font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$y</font>+0.75*<font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$outPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+0.275*<font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$y</font>+0.75*<font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$outPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+0.15*<font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">filledPolygon</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$outPoly</font>, <font color="#1f32ff">$green</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ysize</font>&gt;8<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$inPoly</font> = <font color="#8000ff"><b>GD::Polygon</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$inPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*.5, <font color="#1f32ff">$y</font>+0.2*<font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$inPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*.34, <font color="#1f32ff">$y</font>+0.6*<font color="#1f32ff">$ysize</font>-1<font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$inPoly</font>-&gt;<font color="#ff8204">addPt</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*.64, <font color="#1f32ff">$y</font>+0.6*<font color="#1f32ff">$ysize</font>-1<font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">filledPolygon</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$inPoly</font>, <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> 1;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>draw_C</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>draw_C</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$im</font>, <font color="#1f32ff">$x</font>, <font color="#1f32ff">$y</font>, <font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$ysize</font>, <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$blue</font> = <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">colorAllocate</font><font color="#0000ff"><b>(</b></font>0,0,255<font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">arc</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*0.54, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2,1.08*</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>,</b></font><font color="#1f32ff">$ysize</font>,0,360<font color="#006400"><b>,</b></font><font color="#1f32ff">$blue</font>);<BR>    <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">fill</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#006400"><b>/2, </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>2, <font color="#1f32ff">$blue</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ysize</font>&gt;12<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">arc</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*0.53, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2, <BR>		 0.75*</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>, (0.725-0.725/</b></font><font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>*<font color="#1f32ff">$ysize</font>,
		 0,360,<font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">fill</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#006400"><b>/2, </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>2, <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#006400"><b>/2, </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>4+1, 
			     <font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*1.1, <font color="#1f32ff">$y</font>+<font color="#0000ff"><b>(</b></font>3*<font color="#1f32ff">$ysize</font><font color="#006400"><b>/4)-1,<BR>			     </b></font><font color="#1f32ff">$white</font>);<BR>    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ysize</font>&gt;3<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">arc</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*0.53, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2, <BR>		 (0.75-0.75/</b></font><font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>*<font color="#1f32ff">$xsize</font>, <font color="#0000ff"><b>(</b></font>0.725-0.725<font color="#006400"><b>/</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>)*</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>,<BR>		 0,360,</b></font><font color="#1f32ff">$white</font>);<BR>	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">fill</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#006400"><b>/2, </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>2, <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*0.25, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2, <BR>			     </b></font><font color="#1f32ff">$x</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>*1.1, </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>2,
			     <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>}</b></font>
   <font color="#0000ff"><b>return</b></font> 1;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>draw_G</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30"><A HREF="#CODE7">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>draw_G</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$im</font>, <font color="#1f32ff">$x</font>, <font color="#1f32ff">$y</font>, <font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$ysize</font>, <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$yellow</font> = <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">colorAllocate</font><font color="#0000ff"><b>(</b></font>200,200,0<font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">arc</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*0.54, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2,1.08*</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>,</b></font><font color="#1f32ff">$ysize</font>,0,360<font color="#006400"><b>,</b></font><font color="#1f32ff">$yellow</font>);<BR>    <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">fill</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#006400"><b>/2, </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>2, <font color="#1f32ff">$yellow</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ysize</font>&gt;20<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">arc</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*0.53, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2, <BR>		 0.75*</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>, (0.725-0.725/</b></font><font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>*<font color="#1f32ff">$ysize</font>,
		 0,360,<font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">fill</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#006400"><b>/2, </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>2, <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#006400"><b>/2, </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>4+1, 
			     <font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*1.1, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2-1,<BR>			     </b></font><font color="#1f32ff">$white</font>);<BR>    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>elsif</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ysize</font>&gt;3<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">arc</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*0.53, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2, <BR>		 (0.75-0.75/</b></font><font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>*<font color="#1f32ff">$xsize</font>, <font color="#0000ff"><b>(</b></font>0.725-0.725<font color="#006400"><b>/</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>)*</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>,<BR>		 0,360,</b></font><font color="#1f32ff">$white</font>);<BR>	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">fill</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font><font color="#006400"><b>/2, </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>2, <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>*0.25, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2, <BR>			     </b></font><font color="#1f32ff">$x</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>*1.1, </b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>2,
			     <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>}</b></font>
    <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+0.85*<font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2,<BR>			 </b></font><font color="#1f32ff">$x</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>,</b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+(3*</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>4<font color="#0000ff"><b>)</b></font>-1,
			  <font color="#1f32ff">$yellow</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+0.6*<font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font><font color="#006400"><b>/2,<BR>			 </b></font><font color="#1f32ff">$x</font><font color="#006400"><b>+</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>,</b></font><font color="#1f32ff">$y</font><font color="#006400"><b>+(5*</b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b>/</b></font>8<font color="#0000ff"><b>)</b></font>-1,
			  <font color="#1f32ff">$yellow</font><font color="#0000ff"><b>)</b></font>;
   <font color="#0000ff"><b>return</b></font> 1;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE7"></A><B>draw_T</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE6">prev</A></TD><TD WIDTH="30"><A HREF="#CODE8">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>draw_T</b></font>
 {<pre>    
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$im</font>, <font color="#1f32ff">$x</font>, <font color="#1f32ff">$y</font>, <font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$ysize</font>, <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$red</font> = <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">colorAllocate</font><font color="#0000ff"><b>(</b></font>255,0,0<font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>, <font color="#1f32ff">$y</font>, <font color="#1f32ff">$x</font>+<font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$y</font>+0.16*<font color="#1f32ff">$ysize</font>, <font color="#1f32ff">$red</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$im</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$x</font>+0.42*<font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$y</font>, <font color="#1f32ff">$x</font>+0.58*<font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$y</font>+<font color="#1f32ff">$ysize</font>, <font color="#1f32ff">$red</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> 1;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE8"></A><B>draw_logo</B></TD><TD><A HREF="#POD2">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE7">prev</A></TD><TD WIDTH="30"><A HREF="#CODE9">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>draw_logo</b></font>
 {<pre>    
    <font color="#4169e1"><b>no</b></font> strict;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%args</font> = <font color="#0000ff"><b>(</b></font>-xsize      =&gt; 600,
		-full_scale =&gt; 2.25,
		-graph_title=&gt; <font color="#007400">""</font>,
		-x_title    =&gt; <font color="#007400">""</font>,
		-y_title    =&gt; <font color="#007400">""</font>,
		<font color="#1f32ff">@_</font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">## Other parameters that can be specified:</font><BR>    <font color="#ff0000">##       -ysize -line_width -margin</font><BR>    <font color="#ff0000">## do not have a fixed default value </font><BR>    <font color="#ff0000">##   - they are calculated from xsize if not specified</font><BR>    
        <font color="#ff0000">## draw postscript logo if asked for</font><BR>    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-ps'</font><font color="#0000ff"><b>}</b></font> || <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-pdf'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
      <font color="#0000ff"><b>return</b></font> <font color="#ff8204">_draw_ps_logo</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">@_</font><font color="#0000ff"><b>)</b></font>;  
    <font color="#0000ff"><b>}</b></font>
    
    <font color="#0000ff"><b>require</b></font> GD;
    

    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$xsize</font>,<font color="#1f32ff">$FULL_SCALE</font>, <font color="#1f32ff">$x_title</font>, <font color="#1f32ff">$y_title</font><font color="#0000ff"><b>)</b></font>   
	= <font color="#1f32ff">@args</font><font color="#0000ff"><b>{</b></font><font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>-xsize -full_scale -x_title y_title<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>}</b></font> ;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$PER_PIXEL_LINE</font> = 300;
    
    <font color="#ff0000">## calculate other parameters if not specified</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$line_width</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-line_width<font color="#0000ff"><b>}</b></font> or <font color="#4169e1"><b>int</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$xsize</font><font color="#006400"><b>/</b></font><font color="#1f32ff">$PER_PIXEL_LINE</font>) or 1);<BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ysize</font>      = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-ysize<font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$xsize</font>/1.6); <BR>    <font color="#ff0000">## remark (the line above): 1.6 is a standard screen x:y ratio</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$margin</font>     = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-margin<font color="#0000ff"><b>}</b></font> or <font color="#1f32ff">$ysize</font>*0.15<font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$image</font> = <font color="#8000ff"><b>GD::Image</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$xsize</font>, <font color="#1f32ff">$ysize</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$white</font> = <font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">colorAllocate</font><font color="#0000ff"><b>(</b></font>255,255,255<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$black</font> = <font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">colorAllocate</font><font color="#0000ff"><b>(</b></font>0,0,0<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$motif_size</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">pdl_matrix</font><font color="#0000ff"><b>(</b></font>0<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$font</font> = <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font>&amp;<font color="#8000ff"><b>GD</b></font>::<font color="#ff8204">gdTinyFont</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>, &amp;<font color="#8000ff"><b>GD</b></font>::<font color="#ff8204">gdSmallFont</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>, &amp;<font color="#8000ff"><b>GD</b></font>::<font color="#ff8204">gdMediumBoldFont</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>, 
		&amp;<font color="#8000ff"><b>GD</b></font>::<font color="#ff8204">gdLargeFont</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>, &amp;<font color="#8000ff"><b>GD</b></font>::<font color="#ff8204">gdGiantFont</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>int</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ysize</font>-50<font color="#0000ff"><b>)</b></font>/100)]<BR>	or &amp;GD::gdGiantFont());<BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$title_font</font> = <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font>&amp;<font color="#8000ff"><b>GD</b></font>::<font color="#ff8204">gdSmallFont</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>, &amp;<font color="#8000ff"><b>GD</b></font>::<font color="#ff8204">gdMediumBoldFont</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>, 
		&amp;<font color="#8000ff"><b>GD</b></font>::<font color="#ff8204">gdLargeFont</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>, &amp;<font color="#8000ff"><b>GD</b></font>::<font color="#ff8204">gdGiantFont</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>int</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ysize</font>-50<font color="#0000ff"><b>)</b></font>/100)]<BR>	or &amp;GD::gdGiantFont());<BR>

   <font color="#ff0000">## WRITE LABELS AND TITLE</font><BR>
    <font color="#ff0000">## graph title   #&amp;GD::Font::MediumBold</font><BR>    <font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">string</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$title_font</font>,
		   <font color="#1f32ff">$xsize</font><font color="#006400"><b>/2-length(</b></font><font color="#1f32ff">$args</font><font color="#006400"><b>{-graph_title})* </b></font><font color="#1f32ff">$title_font</font><font color="#006400"><b>-&gt;width() /</b></font>2,
		   <font color="#1f32ff">$margin</font><font color="#006400"><b>/2 - </b></font><font color="#1f32ff">$title_font</font><font color="#006400"><b>-&gt;height()/</b></font>2,
		   <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-graph_title<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;
    
    <font color="#ff0000">## x_title</font><BR>    <font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">string</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$font</font>,
		   <font color="#1f32ff">$xsize</font><font color="#006400"><b>/2-length(</b></font><font color="#1f32ff">$args</font><font color="#006400"><b>{-x_title})*</b></font><font color="#1f32ff">$font</font><font color="#006400"><b>-&gt;width()/</b></font>2,
		   <font color="#1f32ff">$ysize</font>-<font color="#0000ff"><b>(</b></font> <font color="#1f32ff">$margin</font> - <font color="#1f32ff">$font</font>-&gt;<font color="#ff8204">height</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>*0  - 5*<font color="#1f32ff">$line_width</font><font color="#0000ff"><b>)</b></font><font color="#006400"><b>/2 <BR>		     - </b></font><font color="#1f32ff">$font</font><font color="#006400"><b>-&gt;height()/</b></font>2*0,
		   <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-x_title<font color="#0000ff"><b>}</b></font>, 
		   <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">## y_title</font><BR>    <font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">stringUp</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$font</font>,
		     <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$margin</font> -<font color="#1f32ff">$font</font>-&gt;<font color="#ff8204">width</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>- 5*<font color="#1f32ff">$line_width</font><font color="#0000ff"><b>)</b></font><font color="#006400"><b>/2 <BR>		       - </b></font><font color="#1f32ff">$font</font><font color="#006400"><b>-&gt;height()/</b></font>2 ,
		     <font color="#1f32ff">$ysize</font><font color="#006400"><b>/2+length(</b></font><font color="#1f32ff">$args</font><font color="#006400"><b>{'-y_title'})*</b></font><font color="#1f32ff">$font</font><font color="#006400"><b>-&gt;width()/</b></font>2,
		     <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-y_title'</font><font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;
    

    <font color="#ff0000">## DRAW AXES</font><BR>
    <font color="#ff0000">## vertical: (top left to bottom right)</font><BR>    <font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$margin</font>-<font color="#1f32ff">$line_width</font>, <font color="#1f32ff">$margin</font>-<font color="#1f32ff">$line_width</font>, 
			 <font color="#1f32ff">$margin</font>-1, <font color="#1f32ff">$ysize</font>-<font color="#1f32ff">$margin</font>+<font color="#1f32ff">$line_width</font>, 
			 <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">## horizontal: (ditto)</font><BR>    <font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$margin</font>-<font color="#1f32ff">$line_width</font>, <font color="#1f32ff">$ysize</font>-<font color="#1f32ff">$margin</font>+1, 
			 <font color="#1f32ff">$xsize</font>-<font color="#1f32ff">$margin</font>+<font color="#1f32ff">$line_width</font>,<font color="#1f32ff">$ysize</font>-<font color="#1f32ff">$margin</font>+<font color="#1f32ff">$line_width</font>,
			 <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;

    <font color="#ff0000">## DRAW VERTICAL TICKS AND LABELS</font><BR>
    <font color="#ff0000">## vertical axis (IC 1 and 2) </font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ic_1</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ysize</font> - 2* <font color="#1f32ff">$margin</font><font color="#0000ff"><b>)</b></font> <font color="#006400"><b>/ </b></font><font color="#1f32ff">$FULL_SCALE</font>;<BR>    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> <font color="#0000ff"><b>(</b></font>1..<font color="#1f32ff">$FULL_SCALE</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	<font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$margin</font>-3*<font color="#1f32ff">$line_width</font>, 
			     <font color="#1f32ff">$ysize</font>-<font color="#1f32ff">$margin</font> - <font color="#1f32ff">$i</font>*<font color="#1f32ff">$ic_1</font>, 
			     <font color="#1f32ff">$margin</font>-1, 
			     <font color="#1f32ff">$ysize</font>-<font color="#1f32ff">$margin</font>+<font color="#1f32ff">$line_width</font> - <font color="#1f32ff">$i</font>*<font color="#1f32ff">$ic_1</font>, 
			     <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;
	<font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">string</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$font</font>, 
		       <font color="#1f32ff">$margin</font>-5*<font color="#1f32ff">$line_width</font> - <font color="#1f32ff">$font</font>-&gt;width,
		       <font color="#1f32ff">$ysize</font> - <font color="#1f32ff">$margin</font> - <font color="#1f32ff">$i</font>*<font color="#1f32ff">$ic_1</font> - <font color="#1f32ff">$font</font>-&gt;<font color="#ff8204">height</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#006400"><b>/2,<BR>		       </b></font><font color="#1f32ff">$i</font><font color="#006400"><b>,<BR>		       </b></font><font color="#1f32ff">$black</font>);<BR>    <font color="#0000ff"><b>}</b></font>
    
    <font color="#ff0000">## DRAW HORIZONTAL TICKS AND LABELS, AND THE LOGO ITSELF </font><BR>
    <font color="#ff0000">## define function refs as hash elements</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%draw_letter</font> = <font color="#0000ff"><b>(</b></font> A =&gt;\&amp; draw_A,
			C =&gt;\&amp; draw_C,
			G =&gt;\&amp; draw_G,
			T =&gt;\&amp; draw_T <font color="#0000ff"><b>)</b></font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$horiz_step</font> = <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$xsize</font> -2*<font color="#1f32ff">$margin</font><font color="#0000ff"><b>)</b></font> <font color="#006400"><b>/ </b></font><font color="#1f32ff">$motif_size</font>;<BR>    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> <font color="#0000ff"><b>(</b></font>0..<font color="#1f32ff">$motif_size</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	
	<font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">filledRectangle</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$margin</font> + <font color="#1f32ff">$i</font>*<font color="#1f32ff">$horiz_step</font>, 
			     <font color="#1f32ff">$ysize</font>-<font color="#1f32ff">$margin</font>+1, 
			     <font color="#1f32ff">$margin</font> + <font color="#1f32ff">$i</font>*<font color="#1f32ff">$horiz_step</font>+ <font color="#1f32ff">$line_width</font>, 
			     <font color="#1f32ff">$ysize</font>-<font color="#1f32ff">$margin</font>+3*<font color="#1f32ff">$line_width</font>, 
			     <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;
	<font color="#0000ff"><b>last</b></font> <font color="#0000ff"><b>if</b></font> <font color="#1f32ff">$i</font>==<font color="#1f32ff">$motif_size</font>;

	<font color="#ff0000">## get the $i-th column of matrix</font><BR>	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%ic</font>; 
	<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font>A<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font>C<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font>G<font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font>T<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> = list <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">pdl_matrix</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>)</b></font>;

	<font color="#ff0000">## sort nucleotides by increasing information content</font><BR>	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@draw_order</font> = <font color="#4169e1"><b>sort</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$a</font><font color="#0000ff"><b>}</b></font>&lt;=&gt;<font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$b</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font> <font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>A C G T<font color="#0000ff"><b>)</b></font>;

	<font color="#ff0000">## draw logo column</font><BR>	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$xlettersize</font> = <font color="#1f32ff">$horiz_step</font> /1.1;<BR>	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ybottom</font> = <font color="#1f32ff">$ysize</font> - <font color="#1f32ff">$margin</font>;
	<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$base</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@draw_order</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ylettersize</font> = <font color="#4169e1"><b>int</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ic</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$base</font><font color="#0000ff"><b>}</b></font>*<font color="#1f32ff">$ic_1</font> +0.5<font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>next</b></font> <font color="#0000ff"><b>if</b></font> <font color="#1f32ff">$ylettersize</font> ==0;

	    <font color="#ff0000">## draw letter</font><BR>	    <font color="#1f32ff">$draw_letter</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$base</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$image</font>,
				  <font color="#1f32ff">$margin</font> + <font color="#1f32ff">$i</font>*<font color="#1f32ff">$horiz_step</font>,
				  <font color="#1f32ff">$ybottom</font> - <font color="#1f32ff">$ylettersize</font>,
			  <font color="#1f32ff">$xlettersize</font>, <font color="#1f32ff">$ylettersize</font>, <font color="#1f32ff">$white</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$ybottom</font> = <font color="#1f32ff">$ybottom</font> - <font color="#1f32ff">$ylettersize</font>-1;
	<font color="#0000ff"><b>}</b></font>	    
    
	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-error_bars'</font><font color="#0000ff"><b>}</b></font> and <font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-error_bars'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"ARRAY"</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sd_pix</font>   = <font color="#4169e1"><b>int</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-error_bars'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font>*<font color="#1f32ff">$ic_1</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$yt</font>     = <font color="#1f32ff">$ybottom</font> - <font color="#1f32ff">$sd_pix</font>+1;
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$yb</font>  = <font color="#1f32ff">$ybottom</font> + <font color="#1f32ff">$sd_pix</font>-1;
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$xpos</font>     = <font color="#1f32ff">$margin</font> + <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$i</font>+0.45<font color="#0000ff"><b>)</b></font>*<font color="#1f32ff">$horiz_step</font>;
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$half_width</font>;
	    
	    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$yb</font> &gt; <font color="#1f32ff">$ysize</font>-<font color="#1f32ff">$margin</font>+<font color="#1f32ff">$line_width</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$yb</font> = <font color="#1f32ff">$ysize</font>-<font color="#1f32ff">$margin</font>+<font color="#1f32ff">$line_width</font>
		<font color="#0000ff"><b>}</b></font>
	    <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
		<font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">line</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$xpos</font> - <font color="#1f32ff">$xlettersize</font><font color="#006400"><b>/8, </b></font><font color="#1f32ff">$yb</font><font color="#006400"><b>, <BR>			     </b></font><font color="#1f32ff">$xpos</font><font color="#006400"><b> + </b></font><font color="#1f32ff">$xlettersize</font><font color="#006400"><b>/</b></font>8, <font color="#1f32ff">$yb</font>, 
			     <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#0000ff"><b>}</b></font>
	   	
	    <font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">line</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$xpos</font>, <font color="#1f32ff">$yt</font>, <font color="#1f32ff">$xpos</font>, <font color="#1f32ff">$yb</font>, <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">line</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$xpos</font> - 1 , <font color="#1f32ff">$ybottom</font>, <font color="#1f32ff">$xpos</font>+1, <font color="#1f32ff">$ybottom</font>, <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;
	    <font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">line</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$xpos</font> - <font color="#1f32ff">$xlettersize</font><font color="#006400"><b>/8, </b></font><font color="#1f32ff">$yt</font><font color="#006400"><b>, <BR>			 </b></font><font color="#1f32ff">$xpos</font><font color="#006400"><b> + </b></font><font color="#1f32ff">$xlettersize</font><font color="#006400"><b>/</b></font>8, <font color="#1f32ff">$yt</font>, 
			 <font color="#1f32ff">$black</font><font color="#0000ff"><b>)</b></font>;
	    
	    
	<font color="#0000ff"><b>}</b></font>
	
	<font color="#ff0000">## print position number on x axis</font><BR>	<font color="#1f32ff">$image</font>-&gt;<font color="#ff8204">string</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$font</font>,
		       <font color="#1f32ff">$margin</font> + <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$i</font>+0.5<font color="#0000ff"><b>)</b></font>*<font color="#1f32ff">$horiz_step</font> - <font color="#1f32ff">$font</font>-&gt;<font color="#ff8204">width</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#006400"><b>/2,<BR>		       </b></font><font color="#1f32ff">$ysize</font><font color="#006400"><b> - </b></font><font color="#1f32ff">$margin</font><font color="#006400"><b> +5*</b></font><font color="#1f32ff">$line_width</font><font color="#006400"><b>,<BR>		       </b></font><font color="#1f32ff">$i</font><font color="#006400"><b>+1,<BR>		       </b></font><font color="#1f32ff">$black</font>);<BR>    <font color="#0000ff"><b>}</b></font>
    
    <font color="#ff0000">## print $args{-file};</font><BR>    <font color="#0000ff"><b>if</b></font>  <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>  
	<font color="#4169e1"><b>open</b></font> <font color="#0000ff"><b>(</b></font>PNGFILE, <font color="#007400">"&gt;"</font>.<font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
	    or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Could not write to "</font>.<font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font>-file<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
        <font color="#4169e1"><b>print</b></font> PNGFILE <font color="#1f32ff">$image</font>-&gt;png;
	<font color="#4169e1"><b>close</b></font> PNGFILE;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$image</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE9"></A><B>new</B></TD><TD><A HREF="#POD3">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE8">prev</A></TD><TD WIDTH="30"><A HREF="#CODE10">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>new</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$class</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrix</font> = <A HREF="../Matrix.html"><font color="#8000ff"><b>TFBS::Matrix</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font>, -matrixtype=&gt;<font color="#007400">"ICM"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>bless</b></font> <font color="#1f32ff">$matrix</font>, <font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$class</font><font color="#0000ff"><b>)</b></font> || <font color="#1f32ff">$class</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_check_ic_validity</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE10"></A><B>to_PWM</B></TD><TD><A HREF="#POD4">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE9">prev</A></TD><TD WIDTH="30"><A HREF="#CODE11">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>to_PWM</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;throw <font color="#0000ff"><b>(</b></font><font color="#007400">"Method to_PWM not yet implemented."</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE11"></A><B>total_ic</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE10">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>total_ic</b></font>
 {<pre>    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;<font color="#ff8204">pdl_matrix</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_FEEDBACK"><B>FEEDBACK</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Please send bug reports and other comments to the author.<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_AUTHOR - Boris Lenhard"><B>AUTHOR - Boris Lenhard</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Boris Lenhard <a href="mailto:Boris.Lenhard@cgb.ki.seE">Boris.Lenhard@cgb.ki.seE</a>i.se&gt;<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_APPENDIX"><B>APPENDIX</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>The rest of the documentation details each of the object<BR>methods. Internal methods are preceded with an underscore.<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_name"><B>name</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_ID"><B>ID</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_class"><B>class</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_matrix"><B>matrix</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_length"><B>length</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_revcom"><B>revcom</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_rawprint"><B>rawprint</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_prettyprint"><B>prettyprint</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>The above methods are common to all matrix objects. Please consult<BR><a href="../Matrix.html" target="urlWin"><b>TFBS::Matrix</b></a> to find out how to use them.<BR></pre>
</TD></TR>
</TABLE>
</body>
</html>
