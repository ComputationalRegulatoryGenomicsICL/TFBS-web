<head>
<!-- Generated by perlmod2www.pl -->
<title>
Consensus documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS::Word</H4>
<H3>Consensus</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#SUMMARY">Summary</A></TD>
<TD><A HREF="#libs">Included libraries</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#DESCRIPTION">Description</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR><TD BGCOLOR="#ffae84"><B>Summary</B></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD><pre>TFBS::Word - IUPAC DNA consensus word-based pattern class<BR></pre></TD></TR>
</TABLE>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR><TD COLSPAN="2">No package variables defined.</TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../Matrix/PWM.html">TFBS::Matrix::PWM</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../Word.html">TFBS::Word</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
</TABLE>
<A NAME="libs"></A><TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Inherit</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD><b><font color="#0000ff"><a href="../Word.html">TFBS::Word</a></font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><FONT COLOR="RED">No synopsis!</FONT></TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre>TFBS::Word is a base class consisting of universal constructor called by<BR>its subclasses (TFBS::Matrix::*), and word pattern manipulation methods that<BR>are independent of the word type. It is not meant to be instantiated itself.<BR></pre>
</TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>_consensus2matrixref</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>_replace_patterns_in_sitepairset</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>_replace_patterns_in_siteset</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>_transpose_arrayref</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>length</B></TD><TD><A HREF="#POD1">Description</A></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>search_aln</B></TD><TD><A HREF="#POD2">Description</A></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
<TR><TD><B>search_seq</B></TD><TD><A HREF="#POD3">Description</A></TD><TD><A HREF="#CODE7">Code</A></TD></TR>
<TR><TD><B>to_PWM</B></TD><TD><A HREF="#POD4">Description</A></TD><TD><A HREF="#CODE8">Code</A></TD></TR>
<TR><TD><B>validate_word</B></TD><TD><A HREF="#POD5">Description</A></TD><TD><A HREF="#CODE9">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_length"></A><A NAME="POD1"></A><B>length</B></TD><TD><A HREF="#CODE5">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD>prev</TD><TD><A HREF="#POD2">next</A></TD></TR></TABLE>
<pre></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_search_aln"></A><A NAME="POD2"></A><B>search_aln</B></TD><TD><A HREF="#CODE6">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD1">prev</A></TD><TD><A HREF="#POD3">next</A></TD></TR></TABLE>
<pre> Title   : search_aln<BR> Usage   : my $site_pair_set = $pwm-&gt;search_aln(%args)<BR> Function: Scans a pairwise alignment of nucleotide sequences<BR>	   with the pattern represented by the word: it reports only<BR>           those hits that are present in equivalent positions of both<BR>	   sequences and exceed a specified threshold score in both, AND<BR>	   are found in regions of the alignment above the specified<BR>	   conservation cutoff value.<BR> Returns : a TFBS::SitePairSet object<BR> Args    : # you must specify either one of the following three:<BR><BR>	   -file,       # the name of the alignment file in Clustal<BR>			       format<BR>	      #or<BR>	   -alignobj      # a Bio::SimpleAlign object<BR>		        # (more accurately, a Bio::PrimarySeqobject or a<BR>		        #  subclass thereof)<BR>	      #or<BR>	   -alignstring # a multi-line string containing the alignment<BR>			# in clustal format<BR>	   #############<BR><BR>	   -max_mismatches,  # number of allowed positions in the site that do<BR>	                      # not match the consensus<BR>			              # OPTIONAL: default 0<BR><BR>	   -window,     # size of the sliding window (inn nucleotides)<BR>			# for calculating local conservation in the<BR>			# alignment<BR>			# OPTIONAL: default 50<BR><BR>	   -cutoff      # conservation cutoff (%) for including the<BR>			# region in the results of the pattern search<BR>			# OPTIONAL: default &quot;70%&quot;<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_search_seq"></A><A NAME="POD3"></A><B>search_seq</B></TD><TD><A HREF="#CODE7">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD2">prev</A></TD><TD><A HREF="#POD4">next</A></TD></TR></TABLE>
<pre> Title   : search_seq<BR> Usage   : my $siteset = $pwm-&gt;search_seq(%args)<BR> Function: scans a nucleotide sequence with the pattern represented<BR>	   by the PWM<BR> Returns : a TFBS::SiteSet object<BR> Args    : # you must specify either one of the following three:<BR><BR>	   -file,       # the name od a fasta file (single sequence)<BR>	      #or<BR>	   -seqobj      # a Bio::Seq object<BR>		        # (more accurately, a Bio::PrimarySeqobject or a<BR>		        #  subclass thereof)<BR>	      #or<BR>	   -seqstring # a string containing the sequence<BR><BR>	   -max_mismatches,  # number of allowed positions in the site that do<BR>	                     # not match the consensus<BR>			             # OPTIONAL: default 0<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_to_PWM"></A><A NAME="POD4"></A><B>to_PWM</B></TD><TD><A HREF="#CODE8">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD3">prev</A></TD><TD><A HREF="#POD5">next</A></TD></TR></TABLE>
<pre></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_validate_word"></A><A NAME="POD5"></A><B>validate_word</B></TD><TD><A HREF="#CODE9">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD4">prev</A></TD><TD><A HREF="#POD6">next</A></TD></TR></TABLE>
<pre></pre>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>_consensus2matrixref</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_consensus2matrixref</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$word</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%iupac</font> = <font color="#0000ff"><b>(</b></font> T =&gt; <font color="#0000ff"><b>[</b></font>0,0,0,1<font color="#0000ff"><b>]</b></font>,
                  G =&gt; <font color="#0000ff"><b>[</b></font>0,0,1,0<font color="#0000ff"><b>]</b></font>,
                  K =&gt; <font color="#0000ff"><b>[</b></font>0,0,1,1<font color="#0000ff"><b>]</b></font>,
                  C =&gt; <font color="#0000ff"><b>[</b></font>0,1,0,0<font color="#0000ff"><b>]</b></font>,
                  Y =&gt; <font color="#0000ff"><b>[</b></font>0,1,0,1<font color="#0000ff"><b>]</b></font>,
                  S =&gt; <font color="#0000ff"><b>[</b></font>0,1,1,0<font color="#0000ff"><b>]</b></font>,
                  B =&gt; <font color="#0000ff"><b>[</b></font>0,1,1,1<font color="#0000ff"><b>]</b></font>,
                  A =&gt; <font color="#0000ff"><b>[</b></font>1,0,0,0<font color="#0000ff"><b>]</b></font>,
                  W =&gt; <font color="#0000ff"><b>[</b></font>1,0,0,1<font color="#0000ff"><b>]</b></font>,
                  R =&gt; <font color="#0000ff"><b>[</b></font>1,0,1,0<font color="#0000ff"><b>]</b></font>,
                  D =&gt; <font color="#0000ff"><b>[</b></font>1,0,1,1<font color="#0000ff"><b>]</b></font>,
                  M =&gt; <font color="#0000ff"><b>[</b></font>1,1,0,0<font color="#0000ff"><b>]</b></font>,
                  H =&gt; <font color="#0000ff"><b>[</b></font>1,1,0,1<font color="#0000ff"><b>]</b></font>,
                  V =&gt; <font color="#0000ff"><b>[</b></font>1,1,1,0<font color="#0000ff"><b>]</b></font>,
                  N =&gt; <font color="#0000ff"><b>[</b></font>1,1,1,1<font color="#0000ff"><b>]</b></font>
                <font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@vert_array</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$letter</font> <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>split</b></font> <font color="#007400">''</font>, <font color="#1f32ff">$word</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@vert_array</font>,
                <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$iupac</font><font color="#0000ff"><b>{</b></font><font color="#4169e1"><b>uc</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$letter</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>}</b></font>
                 or croak <font color="#0000ff"><b>(</b></font><font color="#007400">"<font color="#1f32ff">$letter</font> is not a legal IUPAC DNA character"</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#ff8204">_transpose_arrayref</font><font color="#0000ff"><b>(</b></font>\<font color="#1f32ff">@vert_array</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>_replace_patterns_in_sitepairset</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_replace_patterns_in_sitepairset</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$sitepairset</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$iter</font> = <font color="#1f32ff">$sitepairset</font>-&gt;Iterator;
    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sitepair</font> = <font color="#1f32ff">$iter</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$sitepair</font>-&gt;<font color="#ff8204">feature1</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font>;
        <font color="#1f32ff">$sitepair</font>-&gt;<font color="#ff8204">feature2</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>_replace_patterns_in_siteset</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_replace_patterns_in_siteset</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$siteset</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$iter</font> = <font color="#1f32ff">$siteset</font>-&gt;Iterator;
    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$site</font> = <font color="#1f32ff">$iter</font>-&gt;<font color="#0000ff"><b>next</b></font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$site</font>-&gt;<font color="#ff8204">pattern</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font></pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>_transpose_arrayref</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_transpose_arrayref</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$vert_arrayref</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$maxcol</font> = <font color="#4169e1"><b>scalar</b></font><font color="#0000ff"><b>(</b></font>@$vert_arrayref<font color="#0000ff"><b>)</b></font> - 1;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@horiz_array</font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$row</font> <font color="#0000ff"><b>(</b></font>0..3<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@horiz_array</font>, <font color="#0000ff"><b>[</b></font> <font color="#4169e1"><b>map</b></font> <font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$vert_arrayref</font>-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$_</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$row</font><font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>}</b></font> 0..<font color="#1f32ff">$maxcol</font> <font color="#0000ff"><b>]</b></font>;

    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font>\@ horiz_array;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>length</B></TD><TD><A HREF="#POD1">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>length</b></font>
 {<pre>    <font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>length</b></font> <font color="#1f32ff">$_</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>-&gt;word;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>search_aln</B></TD><TD><A HREF="#POD2">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30"><A HREF="#CODE7">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>search_aln</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,  <font color="#1f32ff">@args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$max_mismatch</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_rearrange</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>MAX_MISMATCHES<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>]</b></font>, <font color="#1f32ff">@args</font><font color="#0000ff"><b>)</b></font> or 0;
    <font color="#1f32ff">$max_mismatch</font> = 0 <font color="#0000ff"><b>unless</b></font> <font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$max_mismatch</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwm</font> = <font color="#1f32ff">$self</font>-&gt;to_PWM;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sitepairset</font> = <font color="#1f32ff">$pwm</font>-&gt;<font color="#ff8204">search_aln</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@args</font>,
                                       -threshold =&gt; <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>length</b></font> - <font color="#1f32ff">$max_mismatch</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_replace_patterns_in_sitepairset</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$sitepairset</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$sitepairset</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE7"></A><B>search_seq</B></TD><TD><A HREF="#POD3">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE6">prev</A></TD><TD WIDTH="30"><A HREF="#CODE8">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>search_seq</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,  <font color="#1f32ff">@args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$max_mismatch</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_rearrange</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>MAX_MISMATCHES<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>]</b></font>, <font color="#1f32ff">@args</font><font color="#0000ff"><b>)</b></font> or 0;
    <font color="#1f32ff">$max_mismatch</font> = 0 <font color="#0000ff"><b>unless</b></font> <font color="#4169e1"><b>defined</b></font> <font color="#1f32ff">$max_mismatch</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwm</font> = <font color="#1f32ff">$self</font>-&gt;to_PWM;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$siteset</font> = <font color="#1f32ff">$pwm</font>-&gt;<font color="#ff8204">search_seq</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@args</font>,
                                   -threshold =&gt; <font color="#1f32ff">$self</font>-&gt;<font color="#4169e1"><b>length</b></font> - <font color="#1f32ff">$max_mismatch</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_replace_patterns_in_siteset</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$siteset</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$siteset</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE8"></A><B>to_PWM</B></TD><TD><A HREF="#POD4">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE7">prev</A></TD><TD WIDTH="30"><A HREF="#CODE9">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>to_PWM</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,  <font color="#1f32ff">@args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pwm</font> = <A HREF="../Matrix/PWM.html"><font color="#8000ff"><b>TFBS::Matrix::PWM</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-ID     =&gt; <font color="#1f32ff">$self</font>-&gt;ID,
                                     -name   =&gt; <font color="#1f32ff">$self</font>-&gt;name,
                                     -class  =&gt; <font color="#1f32ff">$self</font>-&gt;class,
                                     -matrix =&gt; <font color="#ff8204">_consensus2matrixref</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;word<font color="#0000ff"><b>)</b></font>,
                                     -tags   =&gt; <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$self</font>-&gt;all_tags<font color="#0000ff"><b>}</b></font>
                                    <font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$pwm</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE9"></A><B>validate_word</B></TD><TD><A HREF="#POD5">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE8">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>validate_word</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$word</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$word</font> =~ <font color="#006400"><b>s/[ACGTSWKMRYBDHVN]//gi</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$word</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">""</font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_FEEDBACK"><B>FEEDBACK</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Please send bug reports and other comments to the author.<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_AUTHOR - Boris Lenhard"><B>AUTHOR - Boris Lenhard</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>Boris Lenhard <a href="mailto:Boris.Lenhard@cgb.ki.seE">Boris.Lenhard@cgb.ki.seE</a>i.se&gt;<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_APPENDIX"><B>APPENDIX</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>The rest of the documentation details each of the object<BR>methods. Internal methods are preceded with an underscore.<BR></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_new"><B>new</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre> Title   : new<BR> Usage   : my $pwm = TFBS::Matrix::PWM-&gt;new(%args)<BR> Function: constructor for the TFBS::Matrix::PWM object<BR> Returns : a new TFBS::Matrix::PWM object<BR> Args    : # you must specify the -word argument:<BR>           -word,       # a strig consisting of letters in<BR>                        # IUPAC degenerate DNA alphabet<BR>                        # (any of ACGTSWKMPYBDHVN)<BR><BR>	   #######<BR><BR>           -name,        # string, OPTIONAL<BR>           -ID,          # string, OPTIONAL<BR>           -class,       # string, OPTIONAL<BR>           -tags         # a hash reference reference, OPTIONAL<BR></pre>
</TD></TR>
</TABLE>
</body>
</html>
