<head>
<!-- Generated by perlmod2www.pl -->
<title>
SimplePFM documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS::PatternGen</H4>
<H3>SimplePFM</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#SUMMARY">Summary</A></TD>
<TD><A HREF="#libs">Included libraries</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#SYNOPSIS">Synopsis</A></TD>
<TD><A HREF="#DESCRIPTION">Description</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR><TD BGCOLOR="#ffae84"><B>Summary</B></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD><pre><B>TFBS::PatternGen::SimplePFM</B> - a simple position frequency matrix factory<BR></pre></TD></TR>
</TABLE>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR><TD COLSPAN="2">No package variables defined.</TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../PatternGen.html">TFBS::PatternGen</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="Motif/Matrix.html">TFBS::PatternGen::Motif::Matrix</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
</TABLE>
<A NAME="libs"></A><TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Inherit</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD><b><font color="#0000ff"><a href="../PatternGen.html">TFBS::PatternGen</a></font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre>  <BR>    my @sequences = qw( AAGCCT AGGCAT AAGCCT<BR>                        AAGCCT AGGCAT AGGCCT<BR>                        AGGCAT AGGTTT AGGCAT<BR>                        AGGCCT AGGCCT );<BR>    my $patterngen =<BR>            <B>TFBS::PatternGen::SimplePFM</B>-&gt;new(-seq_list=&gt;\@sequences);<BR>  <BR>    my $pfm = $patterngen-&gt;pattern(); # $pfm is now a TFBS::Matrix::PFM object<BR></pre>
</TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><B>TFBS::PatternGen::SimplePFM</B> generates a position frequency matrix from a set<BR>of nucleotide sequences of equal length, The sequences can be passed either<BR>as strings, as Bio::Seq objects or as a fasta file.<BR><BR>This pattern generator always creates only one pattern from a given set<BR>of sequences.<BR></pre>
</TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>_create_motif</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>_validate_seq</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>new</B></TD><TD><A HREF="#POD1">Description</A></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_new"></A><A NAME="POD1"></A><B>new</B></TD><TD><A HREF="#CODE3">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD>prev</TD><TD><A HREF="#POD2">next</A></TD></TR></TABLE>
<pre> Title   : new<BR> Usage   : my $db = <B>TFBS::PatternGen::SimplePFM</B>-&gt;new(%args);<BR> Function: the constructor for the TFBS::PatternGen::SimplePFM<BR>	    object<BR> Returns : a <B>TFBS::PatternGen::SimplePFM</B> obkect<BR> Args    : This method takes named arguments;<BR>            you must specify one of the following<BR>            -seq_list     # a reference to an array of strings<BR>                          # and/or Bio::Seq objects<BR>              # or<BR>            -seq_stream   # A Bio::SeqIO object<BR>              # or<BR>            -seq_file     # the name of the fasta file containing<BR>                          # all the sequences<BR></pre>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>_create_motif</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_create_motif</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font>  <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$length</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq_set'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>[</b></font>-1<font color="#0000ff"><b>]</b></font>-&gt;<font color="#4169e1"><b>length</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">## initialize the matrix</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrixref</font> = <font color="#0000ff"><b>[</b></font><font color="#0000ff"><b>]</b></font>;
    <font color="#0000ff"><b>for</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> <font color="#0000ff"><b>(</b></font>0..3<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>for</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$j</font> <font color="#0000ff"><b>(</b></font>0..<font color="#1f32ff">$length</font>-1<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#1f32ff">$matrixref</font>-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$j</font><font color="#0000ff"><b>]</b></font> = 0;
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#ff0000">##fill the matrix</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@base</font> = <font color="#4169e1"><b>qw</b></font><font color="#0000ff"><b>(</b></font>A C G T<font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj</font> <font color="#0000ff"><b>(</b></font> @<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>seq_set<font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>for</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> <font color="#0000ff"><b>(</b></font>0..3<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
	    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqstring</font> = <font color="#1f32ff">$seqobj</font>-&gt;seq;
            <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@seqbase</font> = <font color="#4169e1"><b>split</b></font> <font color="#007400">""</font>, <font color="#4169e1"><b>uc</b></font> <font color="#1f32ff">$seqstring</font>;
            <font color="#0000ff"><b>for</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$j</font> <font color="#0000ff"><b>(</b></font>0..<font color="#1f32ff">$length</font>-1<font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
                <font color="#1f32ff">$matrixref</font>-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$j</font><font color="#0000ff"><b>]</b></font> += <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$base</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font> <font color="#0000ff"><b>eq</b></font> <font color="#1f32ff">$seqbase</font><font color="#0000ff"><b>[</b></font><font color="#1f32ff">$j</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>?1:0;
            <font color="#0000ff"><b>}</b></font>
        <font color="#0000ff"><b>}</b></font>

    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$nrhits</font> =0; <font color="#0000ff"><b>for</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$i</font> <font color="#0000ff"><b>(</b></font>0..3<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$nrhits</font> += <font color="#1f32ff">$matrixref</font>-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$i</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>;<font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$motif</font> =
        <A HREF="Motif/Matrix.html"><font color="#8000ff"><b>TFBS::PatternGen::Motif::Matrix</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-matrix =&gt; <font color="#1f32ff">$matrixref</font>,
                                       -nr_hits=&gt; <font color="#1f32ff">$nrhits</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$motif</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>_validate_seq</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_validate_seq</b></font>
 {<pre>    <font color="#ff0000">## a utility function</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$sequence</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$sequence</font>=~ <font color="#006400"><b>s/[ACGT]//g</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$sequence</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">""</font> ? 1 : 0<font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>new</B></TD><TD><A HREF="#POD1">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>new</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>bless</b></font> <font color="#0000ff"><b>{</b></font><font color="#0000ff"><b>}</b></font>, <font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font><font color="#0000ff"><b>)</b></font> || <font color="#1f32ff">$caller</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_create_seq_set</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> or <font color="#4169e1"><b>die</b></font> <font color="#0000ff"><b>(</b></font><font color="#007400">'Error creating sequence set'</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_check_seqs_for_uniform_length</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'motifs'</font><font color="#0000ff"><b>}</b></font> = <font color="#0000ff"><b>[</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_create_motif</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>]</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_pattern"><B>pattern</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_all_patterns"><B>all_patterns</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_patternSet"><B>patternSet</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>The three above methods are used fro the retrieval of patterns,<BR>and are common to all TFBS::PatternGen::* classes. Please<BR>see <a href="../PatternGen.html" target="urlWin"><b>TFBS::PatternGen</b></a> for details.<BR></pre>
</TD></TR>
</TABLE>
</body>
</html>
