<head>
<!-- Generated by perlmod2www.pl -->
<title>
Gibbs documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>TFBS::PatternGen</H4>
<H3>Gibbs</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#SUMMARY">Summary</A></TD>
<TD><A HREF="#libs">Included libraries</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#SYNOPSIS">Synopsis</A></TD>
<TD><A HREF="#DESCRIPTION">Description</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR><TD BGCOLOR="#ffae84"><B>Summary</B></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD><pre><B>TFBS::PatternGen::Gibbs</B> - a pattern factory that uses Chip Lawrences Gibbs program<BR></pre></TD></TR>
</TABLE>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR><TD COLSPAN="2">No package variables defined.</TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Seq</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::SeqIO</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">File::Temp</font></b> qw ( :POSIX ) </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../PatternGen.html">TFBS::PatternGen</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="Gibbs/Motif.html">TFBS::PatternGen::Gibbs::Motif</a></font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">strict</font></b></TD></TR>
</TABLE>
<A NAME="libs"></A><TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Inherit</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD><b><font color="#0000ff"><a href="../PatternGen.html">TFBS::PatternGen</a></font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre>    my $patterngen =<BR>            <B>TFBS::PatternGen::Gibbs</B>-&gt;new(-seq_file=&gt;'sequences.fa',<BR>                                         -binary =&gt; '/Programs/Gibbs-1.0/bin/Gibbs'<BR>                                         -nr_hits =&gt; 24,<BR>                                         -motif_length =&gt; [8, 9, 10],<BR>                                         -additional_params =&gt; '-x -r -e');<BR><BR>    my $pfm = $patterngen-&gt;pattern(); # $pfm is now a TFBS::Matrix::PFM object<BR></pre>
</TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre><B>TFBS::PatternGen::Gibbs</B> builds position frequency matrices<BR>using an advanced Gibbs sampling algorithm implemented in external<BR><i>Gibbs</i> program by Chip Lawrence. The algorithm can produce<BR>multiple patterns from a single set of sequences.<BR></pre>
</TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>_parse_Gibbs_output</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>_parse_raw_matrix</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>_parse_raw_motif</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>_run_Gibbs</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>_site_props</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>new</B></TD><TD><A HREF="#POD1">Description</A></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_new"></A><A NAME="POD1"></A><B>new</B></TD><TD><A HREF="#CODE6">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD>prev</TD><TD><A HREF="#POD2">next</A></TD></TR></TABLE>
<pre> Title   : new<BR> Usage   : my $db = <B>TFBS::PatternGen::Gibbs</B>-&gt;new(%args);<BR> Function: the constructor for the <B>TFBS::PatternGen::Gibbs</B> object<BR> Returns : a <B>TFBS::PatternGen::Gibbs</B> object<BR> Args    : This method takes named arguments;<BR>            you must specify one of the following three<BR>            -seq_list     # a reference to an array of strings<BR>                          #   and/or Bio::Seq objects<BR>              # or<BR>            -seq_stream   # A Bio::SeqIO object<BR>              # or<BR>            -seq_file     # the name of the fasta file containing<BR>                          #   all the sequences<BR>           Other arguments are:<BR>            -binary       # a fully qualified path to Gibbs executable<BR>                          #  OPTIONAL: default 'Gibbs'<BR>            -nr_hits      # a presumed number of pattern occurences in the<BR>                          #   sequence set: it can be a single integer, e.g.<BR>                          #   -nr_hits =&gt; 24 , or a reference to an array of<BR>                          #   integers, e.g -nr_hits =&gt; [12, 24, 36]<BR>            -motif_length # an expected length of motif in nucleotides:<BR>                          #   it can be a single integer, e.g.<BR>                          #   -motif_length =&gt; 8 , or a reference to an<BR>                          #   array ofintegers, e.g -motif_length =&gt; [8..12]<BR>            -additional_params  # a string containing additional<BR>                                #   command-line switches for the<BR>                                #   Gibbs program<BR></pre>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>_parse_Gibbs_output</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_parse_Gibbs_output</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>, <font color="#1f32ff">$resultstring</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#ff0000">##print $resultstring;</font><BR>    <font color="#ff0000">##print&quot;===========END_RESULTSTRING===============================\n&quot;;</font><BR>    <font color="#1f32ff">$resultstring</font> =~ <font color="#006400"><b>s/.*=== MAP MAXIMIZATION RESULTS ===//s</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@raw_motifs</font> = <font color="#4169e1"><b>split</b></font> <font color="#006400"><b>/\-+\n\s+MOTIF \w\n/s</b></font>, <font color="#1f32ff">$resultstring</font>;
    <font color="#4169e1"><b>shift</b></font> <font color="#1f32ff">@raw_motifs</font>; <font color="#ff0000">## discard the first one</font><BR>    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$raw_motif</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@raw_motifs</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#ff0000">##print $raw_motif;</font><BR>        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$motif</font> =<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_parse_raw_motif</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$raw_motif</font><font color="#0000ff"><b>)</b></font> || <font color="#0000ff"><b>next</b></font>;
        <font color="#4169e1"><b>push</b></font> @<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'motifs'</font><font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font>, <font color="#1f32ff">$motif</font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> 1;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>_parse_raw_matrix</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_parse_raw_matrix</b></font>
 {<pre>    <font color="#ff0000">## a utility function</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$raw_matrix</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@lines</font> = <font color="#4169e1"><b>split</b></font> <font color="#007400">"\n"</font>, <font color="#1f32ff">$raw_matrix</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@A</font>, <font color="#1f32ff">@C</font>, <font color="#1f32ff">@G</font>, <font color="#1f32ff">@T</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$line</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@lines</font><font color="#0000ff"><b>)</b></font>  <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$value_string</font>;
        <font color="#0000ff"><b>next</b></font> <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$value_string</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">$line</font> =~ <font color="#006400"><b>/\s+\d+\s+\|\s+(.+)/</b></font>;
        <font color="#1f32ff">$value_string</font> =~ <font color="#006400"><b>s/\./0/g</b></font>;
        <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$a</font>, <font color="#1f32ff">$t</font>, <font color="#1f32ff">$c</font>, <font color="#1f32ff">$g</font><font color="#0000ff"><b>)</b></font> = <font color="#4169e1"><b>split</b></font> <font color="#006400"><b>/\s+/</b></font>, <font color="#1f32ff">$value_string</font>;
        <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@A</font>, <font color="#1f32ff">$a</font>;
        <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@C</font>, <font color="#1f32ff">$c</font>;
        <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@G</font>, <font color="#1f32ff">$g</font>;
        <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@T</font>, <font color="#1f32ff">$t</font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#ff0000">## print STDERR join(&quot; &quot;,@A, &quot;\n&quot;, @C, &quot;\n&quot;, @G, &quot;\n&quot;, @T, &quot;\n&quot;);</font><BR>    <font color="#0000ff"><b>return</b></font> <font color="#0000ff"><b>[</b></font>\<font color="#1f32ff">@A</font>,\@ C,\@ G,\@ T<font color="#0000ff"><b>]</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>_parse_raw_motif</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_parse_raw_motif</b></font>
 {<pre>    <font color="#ff0000">## a utility function</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$raw_motif</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
<font color="#ff0000">##    print $raw_motif;</font><BR>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$raw_matrix</font>, <font color="#1f32ff">$raw_bp</font>, <font color="#1f32ff">$length</font>, <font color="#1f32ff">$nr_hits</font>, <font color="#1f32ff">$MAP_score</font><font color="#0000ff"><b>)</b></font> =
        <font color="#1f32ff">$raw_motif</font> =~ <font color="#006400"><b>/Motif model \(residue frequency x 100\)\n(.+)Motif probability model\n.+Background probability model\n\s+(.+?)\n.+\D(\d+) columns\nNum Motifs\: (\d+).+Difference of Logs of Maps = ([\-\.\d]+)\n/s</b></font>;
    
<font color="#ff0000">##print $raw_matrix;    </font><BR><font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>undef</b></font> <font color="#0000ff"><b>unless</b></font> <font color="#1f32ff">$raw_matrix</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sites</font> = <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_site_props</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$raw_motif</font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">## print STDERR</font><BR>        <font color="#ff0000">## join &quot;:&quot;, ($raw_matrix, $raw_bp, $length, $nr_hits); print &quot;\n&quot;;</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$matrix</font> = <font color="#ff8204">_parse_raw_matrix</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$raw_matrix</font><font color="#0000ff"><b>)</b></font>;
<font color="#ff0000">##print $matrix;    </font><BR><font color="#0000ff"><b>return</b></font>
      <A HREF="Gibbs/Motif.html"><font color="#8000ff"><b>TFBS::PatternGen::Gibbs::Motif</b></font></A>-&gt;<font color="#0000ff"><b>new</b></font>
<font color="#ff0000">##This object does not contain a new method. Instead the new method is than searched in the first ISA package. Remember that the object is still a TFBS::PatternGen::Gibbs::Motif.    </font><BR><font color="#ff0000">##The only ISA in the package is TFBS::PatternGen::Motif.pm. This package indeed contains the new method </font><BR>     <font color="#0000ff"><b>(</b></font>-<font color="#4169e1"><b>length</b></font> =&gt; <font color="#1f32ff">$length</font>.<font color="#007400">""</font>,
           -bg_probabilities =&gt; <font color="#0000ff"><b>[</b></font><font color="#4169e1"><b>split</b></font> <font color="#006400"><b>/\s+/</b></font>, <font color="#1f32ff">$raw_bp</font><font color="#0000ff"><b>]</b></font>,
           -MAP_score =&gt; <font color="#1f32ff">$MAP_score</font>,
           -tags =&gt; <font color="#0000ff"><b>{</b></font>MAP_score =&gt; <font color="#1f32ff">$MAP_score</font><font color="#0000ff"><b>}</b></font>,
           -nr_hits =&gt; <font color="#1f32ff">$nr_hits</font>,
           -sites=&gt;<font color="#1f32ff">$sites</font>,
           -matrix =&gt; <font color="#1f32ff">$matrix</font> <font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>_run_Gibbs</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_run_Gibbs</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>shift</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$tmp_file</font> = <font color="#ff8204">tmpnam</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$outstream</font> = <font color="#8000ff"><b>Bio::SeqIO</b></font>-&gt;<font color="#0000ff"><b>new</b></font><font color="#0000ff"><b>(</b></font>-file=&gt;<font color="#007400">"&gt;<font color="#1f32ff">$tmp_file</font>"</font>, -<font color="#4169e1"><b>format</b></font>=&gt;<font color="#007400">"fasta"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$seqobj</font> <font color="#0000ff"><b>(</b></font>@<font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq_set'</font><font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$outstream</font>-&gt;<font color="#ff8204">write_seq</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seqobj</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#1f32ff">$outstream</font>-&gt;<font color="#4169e1"><b>close</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$command_line</font> =
        <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'binary'</font><font color="#0000ff"><b>}</b></font>.<font color="#007400">" "</font>.
        <font color="#007400">" -PBernoulli "</font>.
        <font color="#1f32ff">$tmp_file</font>.<font color="#007400">" "</font>.
        <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'motif_length_string'</font><font color="#0000ff"><b>}</b></font>.<font color="#007400">" "</font>.
        <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'nr_hits_string'</font><font color="#0000ff"><b>}</b></font>.<font color="#007400">" "</font>.
        <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'additional_params'</font><font color="#0000ff"><b>}</b></font>.<font color="#007400">" -n"</font>;

    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$resultstring</font> = `<font color="#1f32ff">$command_line</font>`;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_parse_Gibbs_output</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$resultstring</font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">##print STDERR &quot;$command_line\n&quot;;</font><BR>    <font color="#ff0000">##print STDERR $resultstring;</font><BR>   
    <font color="#4169e1"><b>unlink</b></font> <font color="#1f32ff">$tmp_file</font>;
    <font color="#0000ff"><b>return</b></font> 1</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>_site_props</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_site_props</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$raw_motif</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@sites</font>;
<font color="#ff0000">##    print $raw_motif;</font><BR>    <font color="#1f32ff">$raw_motif</font>=~s<font color="#006400"><b>/.*Num Motifs:\s+\d+\n/</b></font>/s;<BR><font color="#ff0000">##    print $raw_motif;</font><BR>    <font color="#ff0000">##print &quot;#####################################################\n&quot;;</font><BR>    <font color="#1f32ff">$raw_motif</font>=~s<font color="#006400"><b>/\n\s+\*+.*/</b></font>/s;<BR>    <font color="#ff0000">##print $raw_motif,&quot;\n&quot;;</font><BR>    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@site_lines</font>=<font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">"\n"</font>, <font color="#1f32ff">$raw_motif</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$site</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@site_lines</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$start_seq</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$end_seq</font>;
	<font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$seq_nr</font>,<font color="#1f32ff">$pattern_nr</font>,<font color="#1f32ff">$start</font>,<font color="#1f32ff">$seq</font>,<font color="#1f32ff">$end</font>,<font color="#1f32ff">$score</font>,<font color="#1f32ff">$strand</font>,<font color="#1f32ff">$desc</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">$site</font>=~<font color="#006400"><b>/\s+(\d+),\s+(\d+)\s+(\d+)\s+([\w,\s]+)\s+(\d+)\s+(\d\.\d+)\s+([F,R])(.*)/</b></font>;
<font color="#ff0000">##	print $seq_nr,$pattern_nr,$start,$seq;</font><BR>	<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$strand</font> <font color="#0000ff"><b>eq</b></font> <font color="#007400">"F"</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$strand</font>=1;
	    <font color="#1f32ff">$start_seq</font>=<font color="#1f32ff">$start</font>;
	    <font color="#1f32ff">$end_seq</font>=<font color="#1f32ff">$end</font>;
	<font color="#0000ff"><b>}</b></font>
	<font color="#0000ff"><b>else</b></font><font color="#0000ff"><b>{</b></font>
	    <font color="#1f32ff">$strand</font>=-1;
	    <font color="#1f32ff">$start_seq</font>=<font color="#1f32ff">$end</font>;
	    <font color="#1f32ff">$end_seq</font>=<font color="#1f32ff">$start</font>;
	<font color="#0000ff"><b>}</b></font>
       <font color="#ff0000">##print $site;</font><BR>        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$site</font> = <font color="#8000ff"><b>Bio::SeqFeature::Generic</b></font>-&gt;<font color="#0000ff"><b>new</b></font> <font color="#0000ff"><b>(</b></font> -start =&gt; <font color="#1f32ff">$start_seq</font>,
						   -end =&gt; <font color="#1f32ff">$end_seq</font>,
						   -strand =&gt; <font color="#1f32ff">$strand</font>,
						   -source =&gt; <font color="#007400">'Gibbs sampler'</font>,
						   -score  =&gt; <font color="#1f32ff">$score</font>,
						   <font color="#0000ff"><b>)</b></font>;

        <font color="#1f32ff">$site</font>-&gt;attach_seq <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'seq_set'</font><font color="#0000ff"><b>}</b></font>-&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$seq_nr</font>-1<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
        <font color="#4169e1"><b>push</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@sites</font>,<font color="#1f32ff">$site</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$site</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">@sites</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>{</b></font>
        <font color="#ff0000">##print $site-&gt;start.&quot;\n&quot;;</font><BR>    <font color="#0000ff"><b>}</b></font>

    <font color="#0000ff"><b>return</b></font>\@ sites;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>new</B></TD><TD><A HREF="#POD1">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>new</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font>, <font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> = <font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font> = <font color="#4169e1"><b>bless</b></font> <font color="#0000ff"><b>{</b></font><font color="#0000ff"><b>}</b></font>, <font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$caller</font><font color="#0000ff"><b>)</b></font> || <font color="#1f32ff">$caller</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'motif_length_string'</font><font color="#0000ff"><b>}</b></font> =
        <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-motif_length'</font><font color="#0000ff"><b>}</b></font>
         ? <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-motif_length'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
            ? <font color="#4169e1"><b>join</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">','</font>, @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-motif_length'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
            : <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-motif_length'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
         : 8 <font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'nr_hits_string'</font><font color="#0000ff"><b>}</b></font> =
        <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-nr_hits'</font><font color="#0000ff"><b>}</b></font>
         ? <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-nr_hits'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
            ? <font color="#4169e1"><b>join</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">','</font>, @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-nr_hits'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
            : <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-nr_hits'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
         : <font color="#007400">""</font> <font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'additional_params'</font><font color="#0000ff"><b>}</b></font> =
        <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-additional_params'</font><font color="#0000ff"><b>}</b></font>
         ? <font color="#0000ff"><b>(</b></font><font color="#4169e1"><b>ref</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-additional_params'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
            ? <font color="#4169e1"><b>join</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">' '</font>, @<font color="#0000ff"><b>{</b></font><font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-additional_params'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
            : <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-additional_params'</font><font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>
         : <font color="#007400">""</font> <font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'binary'</font><font color="#0000ff"><b>}</b></font> = <font color="#1f32ff">$args</font><font color="#0000ff"><b>{</b></font><font color="#007400">'-binary'</font><font color="#0000ff"><b>}</b></font> || <font color="#007400">'Gibbs'</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font><font color="#007400">'motifs'</font><font color="#0000ff"><b>}</b></font> = <font color="#0000ff"><b>[</b></font><font color="#0000ff"><b>]</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_create_seq_set</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">%args</font><font color="#0000ff"><b>)</b></font> or <font color="#4169e1"><b>die</b></font> <font color="#0000ff"><b>(</b></font><font color="#007400">'Error creating sequence set'</font><font color="#0000ff"><b>)</b></font>;
    <font color="#ff0000">##print $self-&gt;{'seq_set'}-&gt;[0]-&gt;seq;</font><BR>    <font color="#ff0000">##$self-&gt;_seq_props;</font><BR>    <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_run_Gibbs</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font> or <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">throw</font><font color="#0000ff"><b>(</b></font><font color="#007400">"Error running Gibbs."</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_pattern"><B>pattern</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_all_patterns"><B>all_patterns</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_patternSet"><B>patternSet</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre>The three methods listed above are used for the retrieval of patterns,<BR>and are common to all TFBS::PatternGen::* classes. Please<BR>see <a href="../PatternGen.html" target="urlWin"><b>TFBS::PatternGen</b></a> for details.<BR></pre>
</TD></TR>
</TABLE>
</body>
</html>
