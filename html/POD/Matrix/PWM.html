<head>
<!-- Generated by perlmod2www.pl -->
<title>
PWM documentation.
</title>
<link rel="stylesheet" type="text/css" href="../perl.css">
</head>
<body bgcolor="white">
<span id="modRootPath">TFBS::Matrix</span>
<span id="modName">PWM</span>
<div id="sep"></div>
<a name="TOP" id="TOP"></a>
<table id="daArea" width="100%"><tr><td id="daEntry" ><a href="#SUMMARY">Summary</a></td><td id="daEntry" ><a href="#libs">Included libraries</a></td><td id="daEntry" ><a href="#vardefs">Package variables</a></td><td id="daEntry" ><a href="#SYNOPSIS">Synopsis</a></td><td id="daEntry" ><a href="#DESCRIPTION">Description</a></td><td id="daEntry" ><a href="#General">General documentation</a></td><td id="daEntry" ><a href="#Methods">Methods</a></td></tr></table>
<div id="sep"></div>
<div id="descTitle">Summary</div>
<div id="descArea"><B>TFBS::Matrix::PWM</B> - class for position weight matrices of nucleotide<br />patterns</div>
<div id="sep"></div>
<a name="vardefs" id="vardefs"></a><div id="descTitle">Package variables</div>
<div id="descArea"><div id="libEntry">No package variables defined.</div>
</div>
<div id="sep"></div>
<div id="descTitle">Included modules</div>
<div id="descArea"><div id="libEntry"><span id="use">Bio::Root::Root</span> </div>
<div id="libEntry"><span id="use">Bio::Seq</span> </div>
<div id="libEntry"><span id="use">Bio::SeqIO</span> </div>
<div id="libEntry"><span id="use">File::Temp</span> qw /:POSIX/ </div>
<div id="libEntry"><span id="use">PDL</span></div>
<div id="libEntry"><span id="use">TFBS::Ext::pwmsearch</span> </div>
<div id="libEntry"><span id="use"><a href="../Matrix.html">TFBS::Matrix</a></span> </div>
<div id="libEntry"><span id="use"><a href="_Alignment.html">TFBS::Matrix::_Alignment</a></span> </div>
<div id="libEntry"><span id="use"><a href="../SiteSet.html">TFBS::SiteSet</a></span> </div>
<div id="libEntry"><span id="use">strict</span></div>
</div>
<div id="sep"></div>
<a name="libs" id="libs"></a>
<div id="descTitle">Inherit</div>
<div id="descArea"><span id="isa">Bio::Root::Root</span> <span id="isa"><a href="../Matrix.html">TFBS::Matrix</a></span> </div>
<div id="sep"></div>
<a name="SYNOPSIS" id="SYNOPSIS"></a>
<div id="descTitle">Synopsis</div>
<div id="descArea"><div id="podItem">&nbsp;&nbsp;&nbsp;&nbsp;* creating a <B>TFBS::Matrix::PWM</B> object manually:</div>&nbsp;&nbsp;&nbsp;&nbsp;<div id="podItemEntry">    my $matrixstring = &lt;&lt;ENDMATRIX<br />     0.61 -3.16  1.83 -3.16  1.21 -0.06<br />    -0.15 -2.57 -3.16 -3.16 -2.57 -1.83<br />    -1.57  1.85 -2.57 -1.34 -1.57  1.14<br />     0.31 -3.16 -2.57  1.76  0.24 -0.83<br />    ENDMATRIX<br />    ;<br />    my $pwm = <B>TFBS::Matrix::PWM</B>-&gt;new(-matrixstring =&gt; $matrixstring,<br />				     -name   	   =&gt; &quot;MyProfile&quot;,<br />				     -ID           =&gt; &quot;M0001&quot;<br />				    );<br /></div><br /><div id="podItem">&nbsp;&nbsp;&nbsp;&nbsp;* retrieving a TFBS::Matix::PWM object from a database:</div>&nbsp;&nbsp;&nbsp;&nbsp;(See documentation of individual TFBS::DB::* modules to learn<br />how to connect to different types of pattern databases and retrieve<br />TFBS::Matrix::* objects from them.)<br /><pre id="podParagraph">    my $db_obj = TFBS::DB::JASPAR2-&gt;new<br />		    (-connect =&gt; [&quot;dbi:mysql:JASPAR2:myhost&quot;,<br />				  &quot;myusername&quot;, &quot;mypassword&quot;]);<br />    my $pwm = $db_obj-&gt;get_Matrix_by_ID(&quot;M0001&quot;, &quot;PWM&quot;);<br />    # or<br />    my $pwm = $db_obj-&gt;get_Matrix_by_name(&quot;MyProfile&quot;, &quot;PWM&quot;);<br /></pre><div id="podItem">&nbsp;&nbsp;&nbsp;&nbsp;* retrieving list of individual <B>TFBS::Matrix::PWM</B> objects</div>&nbsp;&nbsp;&nbsp;&nbsp;(see decumentation of TFBS::MatrixSet to learn how to create<br />objects for storage and manipulation of multiple matrices)<br /><pre id="podParagraph">    my @pwm_list = $matrixset-&gt;all_patterns(-sort_by=&gt;&quot;name&quot;);<br /></pre><div id="podItem">&nbsp;&nbsp;&nbsp;&nbsp;* scanning a nucleotide sequence with a matrix</div>&nbsp;&nbsp;&nbsp;&nbsp;<div id="podItemEntry">    my $siteset = $pwm-&gt;search_seq(-file      =&gt;&quot;myseq.fa&quot;,<br />				   -threshold =&gt; &quot;80%&quot;);<br /></div><br /><div id="podItem">&nbsp;&nbsp;&nbsp;&nbsp;* scanning a pairwise alignment with a matrix</div>&nbsp;&nbsp;&nbsp;&nbsp;<div id="podItemEntry">    my $site_pair_set = $pwm-&gt;search_aln(-file      =&gt;&quot;myalign.aln&quot;,<br />				         -threshold =&gt; &quot;80%&quot;,<br />				         -cutoff    =&gt; &quot;70%&quot;,<br />					 -window    =&gt; 50);<br /></div><br />
</div>
<div id="sep"></div>
<a name="DESCRIPTION" id="DESCRIPTION"></a>
<div id="descTitle">Description</div>
<div id="descArea"><B>TFBS::Matrix::PWM</B> is a class whose instances are objects representing<br />position weight matrices (PWMs). A PWM is normally calculated from a<br />raw position frequency matrix (see <a href="PFM.html" target="urlWin" id="podUrl"><b>TFBS::Matrix::PFM</b></a><br />for the explanation of position frequency matrices). For example, given<br />the following position frequency matrix:<br /><pre id="podParagraph">    A:[ 12     3     0     0     4     0  ]<br />    C:[  0     0     0    11     7     0  ]<br />    G:[  0     9    12     0     0     0  ]<br />    T:[  0     0     0     1     1    12  ]<br /></pre>The standard computational procedure is applied to convert it into the<br />following position weight matrix:<br /><pre id="podParagraph">    A:[ 0.61 -3.16  1.83 -3.16  1.21 -0.06]<br />    C:[-0.15 -2.57 -3.16 -3.16 -2.57 -1.83]<br />    G:[-1.57  1.85 -2.57 -1.34 -1.57  1.14]<br />    T:[ 0.31 -3.16 -2.57  1.76  0.24 -0.83]<br /></pre>which contains the &quot;weights&quot; associated with the occurence of each<br />nucleotide at the given position in a pattern.<br />A <B>TFBS::Matrix::PWM</B> object is equipped with methods to search nucleotide<br />sequences and pairwise alignments of nucleotide sequences with the<br />pattern they represent, and return a set of sites in nucleotide<br />sequence (a TFBS::SiteSet object for single sequence search, and a<br />TFBS::SitePairSet for the alignment search).
</div>
<div id="sep"></div>
<a name="Methods" id="Methods"></a>
<div id="descTitle">Methods</div>
<table id="methIndArea" width="100%" cellspacing="0"><tr><td id="methIndEntry">DESTROY</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE1">Code</a></td></tr>
<tr><td id="methIndEntry">_bsearch</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE2">Code</a></td></tr>
<tr><td id="methIndEntry">_csearch</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE3">Code</a></td></tr>
<tr><td id="methIndEntry">_search</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE4">Code</a></td></tr>
<tr><td id="methIndEntry">_seq_to_pdlmatrix</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE5">Code</a></td></tr>
<tr><td id="methIndEntry">_set_min_max_score</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE6">Code</a></td></tr>
<tr><td id="methIndEntry">_to_seqobj</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE7">Code</a></td></tr>
<tr><td id="methIndEntry">max_score</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE8">Code</a></td></tr>
<tr><td id="methIndEntry">min_score</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE9">Code</a></td></tr>
<tr><td id="methIndEntry">new</td><td id="methIndEntry"><a href="#POD1">Description</a></td><td id="methIndEntry"><a href="#CODE10">Code</a></td></tr>
<tr><td id="methIndEntry">search_aln</td><td id="methIndEntry"><a href="#POD2">Description</a></td><td id="methIndEntry"><a href="#CODE11">Code</a></td></tr>
<tr><td id="methIndEntry">search_seq</td><td id="methIndEntry"><a href="#POD3">Description</a></td><td id="methIndEntry"><a href="#CODE12">Code</a></td></tr>
</table>
<div id="sep"></div>
<a name="MethDesc" id="MethDesc"></a>
<div id="mainTitle">Methods description</div>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_new" id="_pod_new"></a><a name="POD1" id="POD1"></a>new</td><td ><a href="#CODE10">code</a></td><td >&nbsp;&nbsp;&nbsp;&nbsp;</td><td ><a href="#POD2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : new<br /> Usage   : my $pwm = <B>TFBS::Matrix::PWM</B>-&gt;new(%args)<br /> Function: constructor for the <B>TFBS::Matrix::PWM</B> object<br /> Returns : a new <B>TFBS::Matrix::PWM</B> object<br /> Args    : # you must specify either one of the following three:<br />
	   -matrix,      # reference to an array of arrays of integers
	      #or
	   -matrixstring,# a string containing four lines
	                 # of tab- or space-delimited integers
	      #or
	   -matrixfile,  # the name of a file containing four lines
	                 # of tab- or space-delimited integers
	   #######

           -name,        # string, OPTIONAL
           -ID,          # string, OPTIONAL
           -class,       # string, OPTIONAL
           -tags         # an array reference, OPTIONAL</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_search_aln" id="_pod_search_aln"></a><a name="POD2" id="POD2"></a>search_aln</td><td ><a href="#CODE11">code</a></td><td ><a href="#POD1">prev</a></td><td ><a href="#POD3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : search_aln<br /> Usage   : my $site_pair_set = $pwm-&gt;search_aln(%args)<br /> Function: Scans a pairwise alignment of nucleotide sequences<br />	   with the pattern represented by the PWM: it reports only<br />           those hits that are present in equivalent positions of both<br />	   sequences and exceed a specified threshold score in both, AND<br />	   are found in regions of the alignment above the specified<br />	   conservation cutoff value.<br /> Returns : a TFBS::SitePairSet object<br /> Args    : # you must specify either one of the following three:<br />
	   -file,       # the name of the alignment file in Clustal
			       format
	      #or
	   -alignobj      # a Bio::SimpleAlign object
		        # (more accurately, a Bio::PrimarySeqobject or a
		        #  subclass thereof)
	      #or
	   -alignstring # a multi-line string containing the alignment
			# in clustal format
	   #############

	   -threshold,  # minimum score for the hit, either absolute
			# (e.g. 11.2) or relative (e.g. "75%")
			# OPTIONAL: default "80%"

	   -window,     # size of the sliding window (inn nucleotides)
			# for calculating local conservation in the
			# alignment
			# OPTIONAL: default 50

	   -cutoff      # conservation cutoff (%) for including the
			# region in the results of the pattern search
			# OPTIONAL: default "70%"

	   -subpart	# subpart of the alignment to search, given as e.g.
			# -subpart => { relative_to => 1,
			#		start       => 140,
			#		end	    => 180 }
			# where start and end are coordinates in the
			# sequence indicated by relative_to (1 for the
			# 1st sequence in the alignment, 2 for the 2nd)
			# OPTIONAL: by default searches entire alignment

	   -conservation
			# conservation profile, a TFBS::ConservationProfile
			# OPTIONAL: by default the conservation profile is
			# computed internally on the fly (less efficient)</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_search_seq" id="_pod_search_seq"></a><a name="POD3" id="POD3"></a>search_seq</td><td ><a href="#CODE12">code</a></td><td ><a href="#POD2">prev</a></td><td ><a href="#POD4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : search_seq<br /> Usage   : my $siteset = $pwm-&gt;search_seq(%args)<br /> Function: scans a nucleotide sequence with the pattern represented<br />	   by the PWM<br /> Returns : a TFBS::SiteSet object<br /> Args    : # you must specify either one of the following three:<br />
	   -file,       # the name od a fasta file (single sequence)
	      #or
	   -seqobj      # a Bio::Seq object
		        # (more accurately, a Bio::PrimarySeqobject or a
		        #  subclass thereof)
	      #or
	   -seqstring # a string containing the sequence

	   -threshold,  # minimum score for the hit, either absolute
			# (e.g. 11.2) or relative (e.g. "75%")
			# OPTIONAL: default "80%"

	   -subpart	# subpart of the sequence to search, given as
			# -subpart => { start => 140,
			#		end   => 180 }
			# where start and end are coordinates in the
			# sequence; the coordinate range is interpreted
			# in the BioPerl tradition (1-based, inclusive)
			# OPTIONAL: by default searches entire alignment</pre></td></tr></table>
<div id="sep"></div>
<a name="MethCode" id="MethCode"></a>
<div id="mainTitle">Methods code</div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE1" id="CODE1"></a>DESTROY</td><td >description</td><td >prev</td><td ><a href="#CODE2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">DESTROY</span>
{<pre>    <span id="comment"># nothing</span><br /><span id="braces">}</span>


1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE2" id="CODE2"></a>_bsearch</td><td >description</td><td ><a href="#CODE1">prev</a></td><td ><a href="#CODE3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_bsearch</span>
{<pre>
    <span id="comment"># this is Perl/PDL only search routine. For experimental purposes only</span><br />
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">%args</span><span id="braces">)</span> = <span id="var">@_</span>; <span id="comment">#the rest of @_ goes to _to_seqob;</span><br />    <span id="perlKey">my</span> <span id="var">@PWMs</span>;

    <span id="comment"># prepare the sequence</span><br />
    <span id="perlKey">my</span> <span id="var">$seqobj</span> = <span id="var">$self</span>-&gt;<span id="method">_to_seqobj</span><span id="braces">(</span><span id="var">%args</span><span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">$seqmatrix</span> = <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$seqobj</span>-&gt;<span id="braces">{</span>_pdl_matrix<span id="braces">}</span><span id="braces">)</span>
	              ? <span id="var">$seqobj</span>-&gt;<span id="braces">{</span>_pdl_matrix<span id="braces">}</span>
                      : <span id="method">_seq_to_pdlmatrix</span><span id="braces">(</span><span id="var">$seqobj</span><span id="braces">)</span>;

    <span id="comment"># calculate threshold</span><br />
    <span id="perlKey">my</span> <span id="var">$threshold</span>;
    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-threshold<span id="braces">}</span><span id="braces">)</span>  <span id="braces">{</span>
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-threshold<span id="braces">}</span> =~ <span id="regExp">/(.+)%/</span><span id="braces">)</span>  <span id="braces">{</span>
	    <span id="comment"># percentage</span><br />	    <span id="var">$threshold</span> = <span id="var">$self</span>-&gt;<span id="braces">{</span>min_score<span id="braces">}</span> +
		<span id="braces">(</span><span id="var">$self</span>-&gt;<span id="braces">{</span>max_score<span id="braces">}</span> - <span id="var">$self</span>-&gt;<span id="braces">{</span>min_score<span id="braces">}</span><span id="braces">)</span>* <span id="var">$1</span>/100;<br />	<span id="braces">}</span>
	<span id="perlKey">else</span>  <span id="braces">{</span>
	    <span id="comment"># absolute value</span><br />	    <span id="var">$threshold</span> = <span id="var">$args</span><span id="braces">{</span>-threshold<span id="braces">}</span>;
	<span id="braces">}</span>
    <span id="braces">}</span>
    <span id="perlKey">else</span> <span id="braces">{</span>
	<span id="comment"># no threshold given</span><br />	<span id="var">$threshold</span> = <span id="var">$self</span>-&gt;<span id="braces">{</span>min_score<span id="braces">}</span> -1;
    <span id="braces">}</span>

    <span id="comment"># do the analysis</span><br />
    <span id="perlKey">my</span> <span id="var">$hitlist</span> = <span id="module"><a href="../SiteSet.html">TFBS::SiteSet</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">)</span>;
    <span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$pwm</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$self</span>-&gt;<span id="method">revcom</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span>  <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="var">$TFlength</span> = <span id="var">$pwm</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">getdim</span><span id="braces">(</span>0<span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">$position_score_pdl</span> = <span id="method">zeroes</span><span id="braces">(</span><span id="var">$seqmatrix</span>-&gt;<span id="method">getdim</span><span id="braces">(</span>0<span id="braces">)</span> - <span id="var">$TFlength</span> + 1<span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">$position_index_pdl</span> = <span id="method">sequence</span><span id="braces">(</span><span id="var">$seqmatrix</span>-&gt;<span id="method">getdim</span><span id="braces">(</span>0<span id="braces">)</span> - <span id="var">$TFlength</span> + 1<span id="braces">)</span>+1;

	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$i</span> <span id="braces">(</span>0..<span id="braces">(</span><span id="var">$TFlength</span>-1<span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
	    <span id="perlKey">my</span> <span id="var">$columnproduct</span> = <span id="var">$seqmatrix</span> * <span id="var">$pwm</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">slice</span><span id="braces">(</span><span id="dqStr">"<span id="var">$i</span>,:"</span><span id="braces">)</span>;
	    <span id="var">$position_score_pdl</span> +=
	      <span id="var">$columnproduct</span>-&gt;<span id="method">xchg</span><span id="braces">(</span>0,1<span id="braces">)</span>-&gt;<span id="method">sumover</span>-&gt;<span id="method">slice</span><span id="braces">(</span><span id="var">$i</span>.<span id="dqStr">":"</span>.<span id="braces">(</span><span id="var">$i</span>-<span id="var">$TFlength</span><span id="braces">)</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">my</span> <span id="var">@hitpositions</span> =
	    list <span id="var">$position_index_pdl</span>-&gt;<span id="method">where</span><span id="braces">(</span><span id="var">$position_score_pdl</span> &gt;= <span id="var">$threshold</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">@hitscores</span>    =
	    list <span id="var">$position_score_pdl</span>-&gt;<span id="method">where</span><span id="braces">(</span><span id="var">$position_score_pdl</span> &gt;= <span id="var">$threshold</span><span id="braces">)</span>;

	<span id="perlKey">for</span> <span id="perlKey">my</span> <span id="var">$i</span><span id="braces">(</span>0..$#hitpositions<span id="braces">)</span> <span id="braces">{</span>
	    <span id="perlKey">my</span><span id="braces">(</span><span id="var">$pos</span>,<span id="var">$score</span><span id="braces">)</span> = <span id="braces">(</span><span id="var">$hitpositions</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>, <span id="var">$hitscores</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span><span id="braces">)</span>;
	    <span id="perlKey">my</span> <span id="var">$siteseq</span> = <span id="perlFunc">scalar</span><span id="braces">(</span><span id="var">$seqobj</span>-&gt;<span id="method">subseq</span><span id="braces">(</span><span id="var">$pos</span>, <span id="var">$pos</span>+<span id="var">$TFlength</span>-1<span id="braces">)</span><span id="braces">)</span>;
	    <span id="perlKey">my</span> <span id="var">$site</span> = <span id="module"><a href="../Site.html">TFBS::Site</a></span>-&gt;<span id="perlKey">new</span> <span id="braces">(</span> -seq_id =&gt; <span id="var">$seqobj</span>-&gt;<span id="method">display_id</span><span id="braces">(</span><span id="braces">)</span>,
					 -seqobj  =&gt; <span id="var">$seqobj</span>,
					 -strand  =&gt; <span id="var">$pwm</span>-&gt;<span id="braces">{</span>strand<span id="braces">}</span>,
					 -Matrix  =&gt; <span id="var">$pwm</span>,
					 -siteseq =&gt; <span id="var">$siteseq</span>,
					 -score   =&gt; <span id="var">$score</span>,
					 -start   =&gt; <span id="var">$pos</span><span id="braces">)</span>;
	    <span id="var">$hitlist</span>-&gt;<span id="method">add_site</span><span id="braces">(</span><span id="var">$site</span><span id="braces">)</span>;
	<span id="braces">}</span>
    <span id="braces">}</span>
    <span id="perlKey">return</span> <span id="var">$hitlist</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE3" id="CODE3"></a>_csearch</td><td >description</td><td ><a href="#CODE2">prev</a></td><td ><a href="#CODE4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_csearch</span>
{<pre>
    <span id="comment"># this is a wrapper around Wyeth Wasserman's's pwm_searchPFF program</span><br />    <span id="comment"># until we do a proper extension</span><br />
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="perlFunc">shift</span>; <span id="comment">#the rest of @_ goes to _to_seqob;</span><br />    <span id="perlKey">my</span> <span id="var">%args</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$PWM_SEARCH</span> = <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-binary'</span><span id="braces">}</span>
                     || <span id="dqStr">"pwm_searchPFF"</span>;

    <span id="comment"># dump the sequence into a tempfile</span><br />
    <span id="perlKey">my</span> <span id="var">$seqobj</span> = <span id="var">$self</span>-&gt;<span id="method">_to_seqobj</span><span id="braces">(</span><span id="var">@_</span><span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$fastaFH</span>, <span id="var">$fastafile</span><span id="braces">)</span>;
    <span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$seqobj</span>-&gt;<span id="braces">{</span>_fastaFH<span id="braces">}</span> and <span id="perlFunc">defined</span> <span id="var">$seqobj</span>-&gt;<span id="braces">{</span>_fastafile<span id="braces">}</span><span id="braces">)</span>  <span id="braces">{</span>
	<span id="braces">(</span><span id="var">$fastaFH</span>, <span id="var">$fastafile</span><span id="braces">)</span> = <span id="braces">(</span><span id="var">$seqobj</span>-&gt;<span id="braces">{</span>_fastaFH<span id="braces">}</span>, <span id="var">$seqobj</span>-&gt;<span id="braces">{</span>_fastafile<span id="braces">}</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">else</span> <span id="braces">{</span>
	<span id="braces">(</span><span id="var">$fastaFH</span>, <span id="var">$fastafile</span><span id="braces">)</span> = <span id="method">tmpnam</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">$seqFH</span> = <span id="module">Bio::SeqIO</span>-&gt;<span id="method">newFh</span><span id="braces">(</span>-fh =&gt;<span id="var">$fastaFH</span>, -<span id="perlFunc">format</span>=&gt;<span id="dqStr">"Fasta"</span><span id="braces">)</span>;
	<span id="perlFunc">print</span> <span id="var">$seqFH</span> <span id="var">$seqobj</span>;
     <span id="braces">}</span>
    <span id="comment"># we need $fastafile below</span><br />

    <span id="comment"># calculate threshold</span><br />
    <span id="perlKey">my</span> <span id="var">$threshold</span>;
    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-threshold<span id="braces">}</span><span id="braces">)</span>  <span id="braces">{</span>
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-threshold<span id="braces">}</span> =~ <span id="regExp">/(.+)%/</span><span id="braces">)</span>  <span id="braces">{</span>
	    <span id="comment"># percentage</span><br />	    <span id="var">$threshold</span> = <span id="var">$self</span>-&gt;<span id="braces">{</span>min_score<span id="braces">}</span> +
		<span id="braces">(</span><span id="var">$self</span>-&gt;<span id="braces">{</span>max_score<span id="braces">}</span> - <span id="var">$self</span>-&gt;<span id="braces">{</span>min_score<span id="braces">}</span><span id="braces">)</span>* <span id="var">$1</span>/100;<br />	<span id="braces">}</span>
	<span id="perlKey">else</span>  <span id="braces">{</span>
	    <span id="comment"># absolute value</span><br />	    <span id="var">$threshold</span> = <span id="var">$args</span><span id="braces">{</span>-threshold<span id="braces">}</span>;
	<span id="braces">}</span>
    <span id="braces">}</span>
    <span id="perlKey">else</span> <span id="braces">{</span>
	<span id="comment"># no threshold given</span><br />	<span id="var">$threshold</span> = <span id="var">$self</span>-&gt;<span id="braces">{</span>min_score<span id="braces">}</span> -1;
    <span id="braces">}</span>


    <span id="comment"># convert piddle to text (there MUST be a better way)</span><br />
    <span id="perlKey">my</span> <span id="var">$pwmstring</span> = <span id="perlFunc">sprintf</span> <span id="braces">(</span> <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span> <span id="braces">)</span>;
    <span id="var">$pwmstring</span> =~ <span id="regExp">s/\[|\]//g</span>;                <span id="comment"># lose []</span><br />    <span id="var">$pwmstring</span> =~ <span id="regExp">s/\n /\n/g</span>;                <span id="comment"># lose leading spaces</span><br />    <span id="perlKey">my</span> <span id="var">@pwmlines</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="dqStr">"\n"</span>, <span id="var">$pwmstring</span><span id="braces">)</span>; <span id="comment"># f</span><br />    <span id="var">$pwmstring</span> = <span id="perlFunc">join</span> <span id="braces">(</span><span id="dqStr">"\n"</span>, <span id="var">@pwmlines</span><span id="braces">[</span>2..5<span id="braces">]</span><span id="braces">)</span>.<span id="dqStr">"\n"</span>;

    <span id="comment"># dump pwm into a tempfile</span><br />
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pwmFH</span>, <span id="var">$pwmfile</span><span id="braces">)</span> = <span id="method">tmpnam</span><span id="braces">(</span><span id="braces">)</span>;  <span id="comment"># we need $pwmfile below</span><br />    <span id="perlFunc">print</span> <span id="var">$pwmFH</span> <span id="var">$pwmstring</span>;
    <span id="perlFunc">close</span> <span id="var">$pwmFH</span>;

    <span id="comment"># run pwmsearch</span><br />    <span id="perlKey">my</span> <span id="var">$hitlist</span> = <span id="module"><a href="../SiteSet.html">TFBS::SiteSet</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$TFname</span>, <span id="var">$TFclass</span><span id="braces">)</span> = <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="braces">{</span>name<span id="braces">}</span>, <span id="var">$self</span>-&gt;<span id="braces">{</span>class<span id="braces">}</span><span id="braces">)</span>;

    <span id="perlKey">my</span> <span id="var">@search_result_lines</span> =
	`<span id="var">$PWM_SEARCH</span> <span id="var">$pwmfile</span> <span id="var">$fastafile</span> <span id="var">$threshold</span> -n <span id="var">$TFname</span> -c <span id="var">$TFclass</span>`;
    <span id="perlKey">foreach</span> <span id="braces">(</span><span id="var">@search_result_lines</span><span id="braces">)</span>  <span id="braces">{</span>
	<span id="perlFunc">chomp</span>;
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$seq_id</span>, <span id="var">$factor</span>, <span id="var">$class</span>, <span id="var">$strand</span>, <span id="var">$score</span>, <span id="var">$pos</span>, <span id="var">$siteseq</span><span id="braces">)</span> =
	    <span id="braces">(</span><span id="perlFunc">split</span><span id="braces">)</span><span id="braces">[</span>0, 2, 3, 4, 5, 7, 9<span id="braces">]</span>;
	<span id="perlKey">my</span> <span id="var">$correct_strand</span> = <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="dqStr">"+"</span><span id="braces">)</span>? <span id="dqStr">"-1"</span> : <span id="dqStr">"1"</span>;
	<span id="perlKey">my</span> <span id="var">$site</span> = <span id="module"><a href="../Site.html">TFBS::Site</a></span>-&gt;<span id="perlKey">new</span> <span id="braces">(</span> -seq_id =&gt; <span id="var">$seqobj</span>-&gt;<span id="method">display_id</span><span id="braces">(</span><span id="braces">)</span>.<span id="dqStr">""</span>,
				     -seqobj  =&gt; <span id="var">$seqobj</span>,
				     -strand  =&gt; <span id="var">$correct_strand</span>.<span id="dqStr">""</span>,
				     -pattern =&gt; <span id="var">$self</span>,
				     -siteseq =&gt; <span id="var">$siteseq</span>.<span id="dqStr">""</span>,
				     -score   =&gt; <span id="var">$score</span>.<span id="dqStr">""</span>,
				     -start   =&gt; <span id="var">$pos</span>,
				     -end     =&gt; <span id="var">$pos</span> + <span id="perlFunc">length</span><span id="braces">(</span><span id="var">$siteseq</span><span id="braces">)</span> -1
				     <span id="braces">)</span>;
	<span id="var">$hitlist</span>-&gt;<span id="method">add_site</span><span id="braces">(</span><span id="var">$site</span><span id="braces">)</span>;
    <span id="braces">}</span>


    <span id="comment"># cleanup</span><br />    <span id="perlFunc">unlink</span> <span id="var">$fastafile</span> <span id="perlKey">unless</span> <span id="var">$seqobj</span>-&gt;<span id="braces">{</span>_fastafile<span id="braces">}</span>;
    <span id="perlFunc">unlink</span> <span id="var">$pwmfile</span>;
    <span id="perlKey">return</span> <span id="var">$hitlist</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE4" id="CODE4"></a>_search</td><td >description</td><td ><a href="#CODE3">prev</a></td><td ><a href="#CODE5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_search</span>
{<pre>    <span id="comment"># this method runs the pwmsearch C extension and parses the data</span><br />    <span id="comment"># similarly to _csearch, which will eventually be discontinued</span><br />    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">%args</span><span id="braces">)</span>  = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$seqobj</span> = <span id="var">$self</span>-&gt;<span id="method">_to_seqobj</span><span id="braces">(</span><span id="var">%args</span><span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$subseq_start</span>, <span id="var">$subseq_end</span><span id="braces">)</span> = <span id="braces">(</span>1,<span id="var">$seqobj</span>-&gt;<span id="perlFunc">length</span><span id="braces">)</span>;
    <span id="perlKey">if</span><span id="braces">(</span><span id="perlKey">my</span> <span id="var">$subpart</span> = <span id="var">$args</span><span id="braces">{</span>-subpart<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
	<span id="var">$subseq_start</span> = <span id="var">$subpart</span>-&gt;<span id="braces">{</span>-start<span id="braces">}</span>;
	<span id="var">$subseq_end</span> = <span id="var">$subpart</span>-&gt;<span id="braces">{</span>-end<span id="braces">}</span>;
	<span id="perlKey">unless</span><span id="braces">(</span><span id="var">$subseq_start</span> and <span id="var">$subseq_end</span><span id="braces">)</span> <span id="braces">{</span>
	    <span id="var">$self</span>-&gt;<span id="method">throw</span><span id="braces">(</span><span id="dqStr">"Option -subpart missing suboption -start or -end"</span><span id="braces">)</span>;
	<span id="braces">}</span>
    <span id="braces">}</span>
    <span id="perlKey">return</span> <span id="module">TFBS::Ext::pwmsearch</span>::<span id="method">pwmsearch</span><span id="braces">(</span><span id="var">$self</span>, <span id="var">$seqobj</span>,
					   <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-threshold<span id="braces">}</span> or 0<span id="braces">)</span>,
					   <span id="var">$subseq_start</span>, <span id="var">$subseq_end</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE5" id="CODE5"></a>_seq_to_pdlmatrix</td><td >description</td><td ><a href="#CODE4">prev</a></td><td ><a href="#CODE6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_seq_to_pdlmatrix</span>
{<pre>    <span id="comment"># called from ?search</span><br />
    <span id="comment"># not OO - help function for search</span><br />
    <span id="perlKey">my</span> <span id="var">$seqobj</span> = <span id="perlFunc">shift</span>;
    <span id="perlKey">my</span> <span id="var">$seqstring</span> = <span id="perlFunc">uc</span><span id="braces">(</span><span id="var">$seqobj</span>-&gt;<span id="method">seq</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span>;

    <span id="perlKey">my</span> <span id="var">@perlarray</span>;
    <span id="perlKey">foreach</span> <span id="braces">(</span><span id="perlFunc">qw</span><span id="braces">(</span>A C G T<span id="braces">)</span><span id="braces">)</span>  <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="var">$seqtobits</span> = <span id="var">$seqstring</span>;
	<span id="perlKey">eval</span> <span id="dqStr">"\<span id="var">$seqtobits</span> =~ tr/<span id="var">$_</span>/1/"</span>;  <span id="comment"># curr. letter $_ to 1</span><br />	<span id="perlKey">eval</span> <span id="dqStr">"\<span id="var">$seqtobits</span> =~ tr/1/0/c"</span>;  <span id="comment"># non-1s to 0</span><br />	<span id="perlFunc">push</span> <span id="var">@perlarray</span>, <span id="braces">[</span><span id="perlFunc">split</span><span id="braces">(</span><span id="dqStr">""</span>, <span id="var">$seqtobits</span><span id="braces">)</span><span id="braces">]</span>;
    <span id="braces">}</span>
    <span id="perlKey">return</span> byte <span id="braces">(</span>\<span id="var">@perlarray</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE6" id="CODE6"></a>_set_min_max_score</td><td >description</td><td ><a href="#CODE5">prev</a></td><td ><a href="#CODE7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_set_min_max_score</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$transpose</span> = <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">xchg</span><span id="braces">(</span>0,1<span id="braces">)</span>;
    <span id="var">$self</span>-&gt;<span id="braces">{</span>min_score<span id="braces">}</span> = <span id="method">sum</span><span id="braces">(</span>minimum <span id="var">$transpose</span><span id="braces">)</span>;
    <span id="var">$self</span>-&gt;<span id="braces">{</span>max_score<span id="braces">}</span> = <span id="method">sum</span><span id="braces">(</span>maximum <span id="var">$transpose</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE7" id="CODE7"></a>_to_seqobj</td><td >description</td><td ><a href="#CODE6">prev</a></td><td ><a href="#CODE8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_to_seqobj</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">%args</span><span id="braces">)</span> = <span id="var">@_</span>;

    <span id="perlKey">my</span> <span id="var">$seq</span>;
    <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span>  <span id="braces">{</span>    <span id="comment"># not a Bio::Seq</span><br />	<span id="perlKey">return</span> <span id="module">Bio::SeqIO</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span>-file =&gt; <span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span>,
			     -<span id="perlFunc">format</span> =&gt; <span id="sqStr">'fasta'</span>,
			     -moltype =&gt; <span id="sqStr">'dna'</span><span id="braces">)</span>-&gt;<span id="method">next_seq</span><span id="braces">(</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-seqstring<span id="braces">}</span>
	   or <span id="var">$args</span><span id="braces">{</span>-seq<span id="braces">}</span><span id="braces">)</span>
    <span id="braces">{</span>   <span id="comment"># I guess it's a string then</span><br />	<span id="perlKey">return</span> <span id="module">Bio::Seq</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span>-seq  =&gt; <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-seqstring<span id="braces">}</span> or <span id="var">$args</span><span id="braces">{</span>-seq<span id="braces">}</span><span id="braces">)</span>,
			     -id =&gt; <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-seq_id<span id="braces">}</span> or <span id="dqStr">"undefined"</span><span id="braces">)</span>,
			     -moltype =&gt; <span id="sqStr">'dna'</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-seqobj'</span><span id="braces">}</span> and <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-seqobj'</span><span id="braces">}</span><span id="braces">)</span> and <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-seqobj'</span><span id="braces">}</span>-&gt;<span id="method">can</span><span id="braces">(</span><span id="dqStr">"seq"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
	<span id="comment"># do nothing (maybe check later)</span><br />	<span id="perlKey">return</span> <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-seqobj'</span><span id="braces">}</span>;
    <span id="braces">}</span>
    <span id="comment">#elsif (ref($format) =~ /Bio\:\:Seq/ and !defined $seq)  {</span><br />	<span id="comment"># if only one parameter passed and it's a Bio::Seq</span><br />	<span id="comment">#return $format;</span><br />    <span id="comment">#}</span><br />    <span id="perlKey">else</span>  <span id="braces">{</span>
	<span id="var">$self</span>-&gt;<span id="method">throw</span> <span id="braces">(</span><span id="dqStr">"Wrong parametes passed to search method: "</span>.<span id="var">%args</span><span id="braces">)</span>;
    <span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE8" id="CODE8"></a>max_score</td><td >description</td><td ><a href="#CODE7">prev</a></td><td ><a href="#CODE9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">max_score</span>
{<pre>    <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>max_score<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE9" id="CODE9"></a>min_score</td><td >description</td><td ><a href="#CODE8">prev</a></td><td ><a href="#CODE10">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">min_score</span>
{<pre>    <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>min_score<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE10" id="CODE10"></a>new</td><td ><a href="#POD1">description</a></td><td ><a href="#CODE9">prev</a></td><td ><a href="#CODE11">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">new</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>, <span id="var">%args</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$matrix</span> = <span id="module"><a href="../Matrix.html">TFBS::Matrix</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="var">%args</span>, -matrixtype=&gt;<span id="dqStr">"PWM"</span><span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">bless</span> <span id="var">$matrix</span>, <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> || <span id="var">$class</span>;
    <span id="var">$self</span>-&gt;<span id="method">_set_min_max_score</span><span id="braces">(</span><span id="braces">)</span>;
    <span id="perlKey">return</span> <span id="var">$self</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE11" id="CODE11"></a>search_aln</td><td ><a href="#POD2">description</a></td><td ><a href="#CODE10">prev</a></td><td ><a href="#CODE12">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">search_aln</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">%args</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-alignstring<span id="braces">}</span> or <span id="var">$args</span><span id="braces">{</span>-alignobj<span id="braces">}</span> or <span id="var">$args</span><span id="braces">{</span>-file<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
	<span id="var">$self</span>-&gt;<span id="method">throw</span>
	    <span id="braces">(</span><span id="dqStr">"No alignment file, string or object passed to search_aln."</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="var">$args</span><span id="braces">{</span>-pattern_set<span id="braces">}</span> = <span id="var">$self</span>;
    <span id="perlKey">my</span> <span id="var">$aln</span> = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-alignment_setup<span id="braces">}</span> or <span id="module"><a href="_Alignment.html">TFBS::Matrix::_Alignment</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="var">%args</span><span id="braces">)</span><span id="braces">)</span>;
    <span id="var">$aln</span>-&gt;<span id="method">do_sitesearch</span><span id="braces">(</span><span id="var">%args</span><span id="braces">)</span>;
    <span id="perlKey">return</span> <span id="var">$aln</span>-&gt;<span id="method">site_pair_set</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE12" id="CODE12"></a>search_seq</td><td ><a href="#POD3">description</a></td><td ><a href="#CODE11">prev</a></td><td >next</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">search_seq</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">%args</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="var">$self</span>-&gt;<span id="method">_search</span><span id="braces">(</span><span id="var">%args</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<a name="General" id="General"></a>
<div id="mainTitle">General documentation</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_FEEDBACK" id="_pod_FEEDBACK"></a>FEEDBACK</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">Please send bug reports and other comments to the author.</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_AUTHOR - Boris Lenhard" id="_pod_AUTHOR - Boris Lenhard"></a>AUTHOR - Boris Lenhard</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">Boris Lenhard &lt;Boris.Lenhard@cgb.ki.se&gt;</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_APPENDIX" id="_pod_APPENDIX"></a>APPENDIX</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">The rest of the documentation details each of the object<br />methods. Internal methods are preceded with an underscore.</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_name" id="_pod_name"></a>name</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_ID" id="_pod_ID"></a>ID</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_class" id="_pod_class"></a>class</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_matrix" id="_pod_matrix"></a>matrix</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_length" id="_pod_length"></a>length</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_revcom" id="_pod_revcom"></a>revcom</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_rawprint" id="_pod_rawprint"></a>rawprint</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_prettyprint" id="_pod_prettyprint"></a>prettyprint</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">The above methods are common to all matrix objects. Please consult<br /><a href="../Matrix.html" target="urlWin" id="podUrl"><b>TFBS::Matrix</b></a> to find out how to use them.</div>
<div id="sep"></div>
</body>
</html>
