<head>
<!-- Generated by perlmod2www.pl -->
<title>
Matrix documentation.
</title>
<link rel="stylesheet" type="text/css" href="perl.css">
</head>
<body bgcolor="white">
<span id="modRootPath">TFBS</span>
<span id="modName">Matrix</span>
<div id="sep"></div>
<a name="TOP" id="TOP"></a>
<table id="daArea" width="100%"><tr><td id="daEntry" ><a href="#SUMMARY">Summary</a></td><td id="daEntry" ><a href="#libs">Included libraries</a></td><td id="daEntry" ><a href="#vardefs">Package variables</a></td><td id="daEntry" ><a href="#DESCRIPTION">Description</a></td><td id="daEntry" ><a href="#General">General documentation</a></td><td id="daEntry" ><a href="#Methods">Methods</a></td></tr></table>
<div id="sep"></div>
<div id="descTitle">Summary</div>
<div id="descArea"><B>TFBS::Matrix</B> - base class for matrix patterns, containing methods common<br />to all</div>
<div id="sep"></div>
<a name="vardefs" id="vardefs"></a><div id="descTitle">Package variables</div>
<div id="descArea"><div id="libEntry"><div id="descSubTitle">Privates (from <b>"my"</b> definitions)</div>
</div>
<div id="libEntry"><span id="var">%dna</span> = <span id="braces">(</span><span id="dqStr">"A"</span> =&gt; <span id="braces">[</span>12,0,0,0<span id="braces">]</span>,	   <span id="dqStr">"C"</span> =&gt; <span id="braces">[</span>0,12,0,0<span id="braces">]</span>,	   <span id="dqStr">"G"</span> =&gt; <span id="braces">[</span>0,0,12,0<span id="braces">]</span>,	   <span id="dqStr">"T"</span> =&gt; <span id="braces">[</span>0,0,0,12<span id="braces">]</span>,	   <span id="dqStr">"U"</span> =&gt; <span id="braces">[</span>0,0,0,12<span id="braces">]</span>,	   <span id="dqStr">"R"</span> =&gt; <span id="braces">[</span>6,0,6,0<span id="braces">]</span>,	   <span id="dqStr">"Y"</span> =&gt; <span id="braces">[</span>0,6,0,6<span id="braces">]</span>,	   <span id="dqStr">"M"</span> =&gt; <span id="braces">[</span>6,6,0,0<span id="braces">]</span>,	   <span id="dqStr">"K"</span> =&gt; <span id="braces">[</span>0,0,6,6<span id="braces">]</span>,	   <span id="dqStr">"W"</span> =&gt; <span id="braces">[</span>6,0,0,6<span id="braces">]</span>,	   <span id="dqStr">"S"</span> =&gt; <span id="braces">[</span>0,6,6,0<span id="braces">]</span>,	   <span id="dqStr">"B"</span> =&gt; <span id="braces">[</span>0,4,4,4<span id="braces">]</span>,	   <span id="dqStr">"D"</span> =&gt; <span id="braces">[</span>4,0,4,4<span id="braces">]</span>,	   <span id="dqStr">"H"</span> =&gt; <span id="braces">[</span>4,4,0,4<span id="braces">]</span>,	   <span id="dqStr">"V"</span> =&gt; <span id="braces">[</span>4,4,4,0<span id="braces">]</span>,	   <span id="dqStr">"N"</span> =&gt; <span id="braces">[</span>3,3,3,3<span id="braces">]</span><span id="braces">)</span></div>
</div>
<div id="sep"></div>
<div id="descTitle">Included modules</div>
<div id="descArea"><div id="libEntry"><span id="use">PDL</span></div>
<div id="libEntry"><span id="use"><a href="PatternI.html">TFBS::PatternI</a></span> </div>
</div>
<div id="sep"></div>
<a name="libs" id="libs"></a>
<div id="descTitle">Inherit</div>
<div id="descArea"><span id="isa"><a href="PatternI.html">TFBS::PatternI</a></span> </div>
<div id="sep"></div>
<a name="SYNOPSIS" id="SYNOPSIS"></a>
<div id="descTitle">Synopsis</div>
<div id="error">No synopsis!</div>
<div id="sep"></div>
<a name="DESCRIPTION" id="DESCRIPTION"></a>
<div id="descTitle">Description</div>
<div id="descArea"><B>TFBS::Matrix</B> is a base class consisting of universal constructor called by<br />its subclasses (TFBS::Matrix::*), and matrix manipulation methods that are<br />independent of the matrix type. It is not meant to be instantiated itself.
</div>
<div id="sep"></div>
<a name="Methods" id="Methods"></a>
<div id="descTitle">Methods</div>
<table id="methIndArea" width="100%" cellspacing="0"><tr><td id="methIndEntry">DESTROY</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE1">Code</a></td></tr>
<tr><td id="methIndEntry">STAMPprint</td><td id="methIndEntry"><a href="#POD1">Description</a></td><td id="methIndEntry"><a href="#CODE2">Code</a></td></tr>
<tr><td id="methIndEntry">_load</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE3">Code</a></td></tr>
<tr><td id="methIndEntry">_matrix_from_IUPAC_string</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE4">Code</a></td></tr>
<tr><td id="methIndEntry">_matrix_from_STAMP_string</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE5">Code</a></td></tr>
<tr><td id="methIndEntry">_matrix_from_string</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE6">Code</a></td></tr>
<tr><td id="methIndEntry">_pdl_to_matrixref</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE7">Code</a></td></tr>
<tr><td id="methIndEntry">_set_min_max_score</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE8">Code</a></td></tr>
<tr><td id="methIndEntry">length</td><td id="methIndEntry"><a href="#POD2">Description</a></td><td id="methIndEntry"><a href="#CODE9">Code</a></td></tr>
<tr><td id="methIndEntry">matrix</td><td id="methIndEntry"><a href="#POD3">Description</a></td><td id="methIndEntry"><a href="#CODE10">Code</a></td></tr>
<tr><td id="methIndEntry">new</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE11">Code</a></td></tr>
<tr><td id="methIndEntry">pdl_matrix</td><td id="methIndEntry"><a href="#POD4">Description</a></td><td id="methIndEntry"><a href="#CODE12">Code</a></td></tr>
<tr><td id="methIndEntry">prettyprint</td><td id="methIndEntry"><a href="#POD5">Description</a></td><td id="methIndEntry"><a href="#CODE13">Code</a></td></tr>
<tr><td id="methIndEntry">randomize_columns</td><td id="methIndEntry"><a href="#POD6">Description</a></td><td id="methIndEntry"><a href="#CODE14">Code</a></td></tr>
<tr><td id="methIndEntry">rawprint</td><td id="methIndEntry"><a href="#POD7">Description</a></td><td id="methIndEntry"><a href="#CODE15">Code</a></td></tr>
<tr><td id="methIndEntry">revcom</td><td id="methIndEntry"><a href="#POD8">Description</a></td><td id="methIndEntry"><a href="#CODE16">Code</a></td></tr>
<tr><td id="methIndEntry">set_matrix</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE17">Code</a></td></tr>
</table>
<div id="sep"></div>
<a name="MethDesc" id="MethDesc"></a>
<div id="mainTitle">Methods description</div>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_STAMPprint" id="_pod_STAMPprint"></a><a name="POD1" id="POD1"></a>STAMPprint</td><td ><a href="#CODE2">code</a></td><td >&nbsp;&nbsp;&nbsp;&nbsp;</td><td ><a href="#POD2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : STAMPprint<br /> Usage   : my $STAMPstring = $pfm-&gt;STAMPprint();<br /> Function: Convert the matrix to STAMP readable format<br /> Returns : A string of the matrix in a TRANSFAC like format for STAMP<br /> Args    : none</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_length" id="_pod_length"></a><a name="POD2" id="POD2"></a>length</td><td ><a href="#CODE9">code</a></td><td ><a href="#POD1">prev</a></td><td ><a href="#POD3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : length<br /> Usage   : my $pattern_length = $pfm-&gt;length;<br /> Function: gets the pattern length in nucleotides<br />	    (i.e. number of columns in the matrix)<br /> Returns : an integer<br /> Args    : none</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_matrix" id="_pod_matrix"></a><a name="POD3" id="POD3"></a>matrix</td><td ><a href="#CODE10">code</a></td><td ><a href="#POD2">prev</a></td><td ><a href="#POD4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : matrix<br /> Usage   : my $matrix = $pwm-&gt;matrix();<br />	   $pwm-&gt;matrix( [ [12, 3, 0, 0, 4, 0],<br />			   [ 0, 0, 0,11, 7, 0],<br />			   [ 0, 9,12, 0, 0, 0],<br />			   [ 0, 0, 0, 1, 1,12]<br />			 ]);<br />
 Function: get/set for the matrix data
 Returns : a reference to 2D array of integers(PFM) or floats (ICM, PWM)
 Args    : none for get;
	   a four line string, reference to 2D array, or a 2D piddle for set</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_pdl_matrix" id="_pod_pdl_matrix"></a><a name="POD4" id="POD4"></a>pdl_matrix</td><td ><a href="#CODE12">code</a></td><td ><a href="#POD3">prev</a></td><td ><a href="#POD5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : pdl_matrix<br /> Usage   : my $pdl = $pwm-&gt;pdl_matrix();<br /> Function: access the PDL matrix used to store the actual<br />	   matrix data directly<br /> Returns : a PDL object, aka a piddle<br /> Args    : none</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_prettyprint" id="_pod_prettyprint"></a><a name="POD5" id="POD5"></a>prettyprint</td><td ><a href="#CODE13">code</a></td><td ><a href="#POD4">prev</a></td><td ><a href="#POD6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : prettyprint<br /> Usage   : my $prettystring = $pfm-&gt;prettyprint();<br /> Function: convert matrix data to a human-readable string format<br /> Returns : a four-line string with nucleotides and aligned numbers<br /> Args    : none</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_randomize_columns" id="_pod_randomize_columns"></a><a name="POD6" id="POD6"></a>randomize_columns</td><td ><a href="#CODE14">code</a></td><td ><a href="#POD5">prev</a></td><td ><a href="#POD7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : randomize_columns<br /> Usage   : $pfm-&gt;randomize_columns();<br /> Function: Randomizes the columns of a matrix (in place).<br /> Returns : Nothing<br /> Args    : none</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_rawprint" id="_pod_rawprint"></a><a name="POD7" id="POD7"></a>rawprint</td><td ><a href="#CODE15">code</a></td><td ><a href="#POD6">prev</a></td><td ><a href="#POD8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : rawprint<br /> Usage   : my $rawstring = $pfm-&gt;rawprint);<br /> Function: convert matrix data to a simple tab-separated format<br /> Returns : a four-line string of tab-separated integers or floats<br /> Args    : none</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_revcom" id="_pod_revcom"></a><a name="POD8" id="POD8"></a>revcom</td><td ><a href="#CODE16">code</a></td><td ><a href="#POD7">prev</a></td><td ><a href="#POD9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph"> Title   : revcom<br /> Usage   : my $revcom_pfm = $pfm-&gt;revcom();<br /> Function: create a matrix pattern object which is reverse complement<br />	    of the current one<br /> Returns : a TFBS::Matrix::* object of the same type as the one<br />	    the method acted upon<br /> Args    : none</pre></td></tr></table>
<div id="sep"></div>
<a name="MethCode" id="MethCode"></a>
<div id="mainTitle">Methods code</div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE1" id="CODE1"></a>DESTROY</td><td >description</td><td >prev</td><td ><a href="#CODE2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">DESTROY</span>
{<pre>    <span id="comment"># nothing</span><br /><span id="braces">}</span>



1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE2" id="CODE2"></a>STAMPprint</td><td ><a href="#POD1">description</a></td><td ><a href="#CODE1">prev</a></td><td ><a href="#CODE3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">STAMPprint</span>
{<pre>    <span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">shift</span>;
    <span id="perlKey">my</span> <span id="var">$pwmstring</span> = <span id="perlFunc">sprintf</span> <span id="braces">(</span> <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span> <span id="braces">)</span>;
    <span id="var">$pwmstring</span> =~ <span id="regExp">s/\[|\]//g</span>;                <span id="comment"># lose []</span><br />    <span id="var">$pwmstring</span> =~ <span id="regExp">s/\n\s+/\n/g</span>;              <span id="comment"># lose leading spaces</span><br />    <span id="perlKey">my</span> <span id="var">@pwmlines</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\n+/</span>, <span id="var">$pwmstring</span><span id="braces">)</span>; 
    <span id="var">@pwmlines</span> = <span id="perlFunc">map</span> <span id="braces">{</span> <span id="braces">[</span> <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\s+/</span>, <span id="var">$_</span><span id="braces">)</span> <span id="braces">]</span> <span id="braces">}</span> <span id="var">@pwmlines</span>;

    <span id="var">$pwmstring</span> = <span id="dqStr">"DE "</span>.<span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'ID'</span><span id="braces">}</span>.<span id="dqStr">"\t"</span>.<span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'name'</span><span id="braces">}</span>.<span id="dqStr">"\t"</span>.<span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'class'</span><span id="braces">}</span>.<span id="dqStr">"\n"</span>;

    <span id="perlKey">for</span> <span id="perlKey">my</span> <span id="var">$row</span> <span id="braces">(</span>0..$#<span id="braces">{</span> <span id="var">$pwmlines</span><span id="braces">[</span>1<span id="braces">]</span> <span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
	<span id="var">$pwmstring</span> .= <span id="perlFunc">sprintf</span> <span id="dqStr">"%02d\t"</span>, <span id="var">$row</span>;
	<span id="var">$pwmstring</span> .= <span id="var">$pwmlines</span><span id="braces">[</span><span id="var">$_</span><span id="braces">]</span>-&gt;<span id="braces">[</span><span id="var">$row</span><span id="braces">]</span>.<span id="dqStr">"\t"</span> <span id="perlKey">for</span> <span id="braces">(</span>1..$#pwmlines<span id="braces">)</span>;
	<span id="var">$pwmstring</span> .= <span id="dqStr">"\n"</span>;
    <span id="braces">}</span>
    <span id="var">$pwmstring</span> .=  <span id="dqStr">"XX\n"</span>;

    <span id="perlKey">return</span> <span id="var">$pwmstring</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE3" id="CODE3"></a>_load</td><td >description</td><td ><a href="#CODE2">prev</a></td><td ><a href="#CODE4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_load</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$field</span>, <span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span>-&gt;<span id="braces">{</span>db<span id="braces">}</span><span id="braces">)</span>,0,5<span id="braces">)</span> <span id="perlKey">eq</span> <span id="dqStr">"DBI::"</span><span id="braces">)</span>  <span id="braces">{</span>
	<span id="comment"># database retrieval</span><br />    <span id="braces">}</span>
    <span id="perlKey">elsif</span> <span id="braces">(</span>-d <span id="var">$self</span>-&gt;<span id="braces">{</span>dbh<span id="braces">}</span><span id="braces">)</span>  <span id="braces">{</span>
	<span id="comment"># retrieval from .pwm files in a directory</span><br />	<span id="var">$self</span>-&gt;<span id="method">_lookup_in_matrixlist</span><span id="braces">(</span><span id="var">$field</span>, <span id="var">$value</span><span id="braces">)</span>
	    or <span id="perlKey">do</span> <span id="braces">{</span>
		<span id="perlFunc">warn</span> <span id="braces">(</span><span id="dqStr">"Matrix with <span id="var">$field</span>=&gt;<span id="var">$value</span> not found."</span><span id="braces">)</span>;
		<span id="perlKey">return</span> <span id="perlFunc">undef</span>;
	    <span id="braces">}</span>;
	<span id="perlKey">my</span> <span id="var">$ID</span> = <span id="var">$self</span>-&gt;<span id="braces">{</span>ID<span id="braces">}</span>;
	<span id="perlKey">my</span> <span id="var">$DIR</span> = <span id="var">$self</span>-&gt;<span id="braces">{</span>dbh<span id="braces">}</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_matrix</span><span id="braces">(</span><span id="perlFunc">scalar</span> `cat <span id="var">$DIR</span><span id="regExp">/</span><span id="var">$ID</span><span id="regExp">.pwm`); # FIXME - temporary<br /><br />    }<br />    else  {<br />	</span><span id="var">$self</span>-&gt;throw(&quot;-dbh is not a valid database handle or a directory.&quot;);<br />    <span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE4" id="CODE4"></a>_matrix_from_IUPAC_string</td><td >description</td><td ><a href="#CODE3">prev</a></td><td ><a href="#CODE5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_matrix_from_IUPAC_string</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$matrixstring</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="var">$matrixstring</span> =~ <span id="regExp">s/^\s+//</span>;
    <span id="var">$matrixstring</span> =~ <span id="regExp">s/\s+$//</span>;
    <span id="perlKey">my</span> <span id="var">@str</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">//</span>, <span id="var">$matrixstring</span><span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="var">@matrix</span>;

    <span id="perlKey">for</span> <span id="perlKey">my</span> <span id="var">$ltr</span> <span id="braces">(</span>0..3<span id="braces">)</span> <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="var">@l</span> = <span id="perlFunc">map</span> <span id="braces">{</span><span id="var">$dna</span><span id="braces">{</span><span id="perlFunc">uc</span><span id="braces">(</span><span id="var">$_</span><span id="braces">)</span><span id="braces">}</span>-&gt;<span id="braces">[</span><span id="var">$ltr</span><span id="braces">]</span><span id="braces">}</span> <span id="var">@str</span>;
	<span id="perlFunc">push</span> <span id="var">@matrix</span>,\@ l; 
    <span id="braces">}</span>

    <span id="perlKey">return</span>\@ matrix;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE5" id="CODE5"></a>_matrix_from_STAMP_string</td><td >description</td><td ><a href="#CODE4">prev</a></td><td ><a href="#CODE6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_matrix_from_STAMP_string</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$matrixstring</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">@lines</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="dqStr">"\n"</span>, <span id="var">$matrixstring</span><span id="braces">)</span>;
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">@a</span>, <span id="var">@c</span>, <span id="var">@g</span>, <span id="var">@t</span><span id="braces">)</span>;

    <span id="comment"># Remove garbage</span><br />    <span id="perlFunc">shift</span><span id="braces">(</span><span id="var">@lines</span><span id="braces">)</span>;
    <span id="perlFunc">pop</span><span id="braces">(</span><span id="var">@lines</span><span id="braces">)</span>;

    <span id="perlKey">for</span> <span id="braces">(</span><span id="var">@lines</span><span id="braces">)</span> <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="var">@l</span> = <span id="perlFunc">split</span>;
	<span id="perlFunc">push</span> <span id="var">@a</span>, <span id="var">$l</span><span id="braces">[</span>1<span id="braces">]</span>;
	<span id="perlFunc">push</span> <span id="var">@c</span>, <span id="var">$l</span><span id="braces">[</span>2<span id="braces">]</span>;
	<span id="perlFunc">push</span> <span id="var">@g</span>, <span id="var">$l</span><span id="braces">[</span>3<span id="braces">]</span>;
	<span id="perlFunc">push</span> <span id="var">@t</span>, <span id="var">$l</span><span id="braces">[</span>4<span id="braces">]</span>;
    <span id="braces">}</span>

    <span id="perlKey">return</span> <span id="braces">[</span>\<span id="var">@a</span>,\@ c,\@ g,\@ t<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE6" id="CODE6"></a>_matrix_from_string</td><td >description</td><td ><a href="#CODE5">prev</a></td><td ><a href="#CODE7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_matrix_from_string</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$matrixstring</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">@array</span> = <span id="braces">(</span><span id="braces">)</span>;
    <span id="perlKey">foreach</span> <span id="braces">(</span><span id="braces">(</span><span id="perlFunc">split</span> <span id="dqStr">"\n"</span>, <span id="var">$matrixstring</span><span id="braces">)</span><span id="braces">[</span>0..3<span id="braces">]</span><span id="braces">)</span>  <span id="braces">{</span>
	<span id="regExp">s/^\s+//</span>;
	<span id="regExp">s/\s+$//</span>;
	<span id="perlFunc">push</span> <span id="var">@array</span>, <span id="braces">[</span><span id="perlFunc">split</span><span id="braces">]</span>;
    <span id="braces">}</span>
    <span id="perlKey">return</span>\@  array;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE7" id="CODE7"></a>_pdl_to_matrixref</td><td >description</td><td ><a href="#CODE6">prev</a></td><td ><a href="#CODE8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_pdl_to_matrixref</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$matrixdata</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$matrixdata</span>-&gt;<span id="method">isa</span><span id="braces">(</span><span id="dqStr">"PDL"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
	<span id="perlFunc">die</span> <span id="dqStr">"A non-PDL object passed to _pdl_to_matrixref"</span>;
    <span id="braces">}</span>
    <span id="perlKey">my</span> <span id="var">@list</span> = list <span id="var">$matrixdata</span>;
    <span id="perlKey">my</span> <span id="var">@array</span>;
    <span id="perlKey">my</span> <span id="var">$matrix_width</span> = <span id="perlFunc">scalar</span><span id="braces">(</span><span id="var">@list</span><span id="braces">)</span> / 4;<br />    <span id="perlKey">for</span> <span id="braces">(</span>0..3<span id="braces">)</span>  <span id="braces">{</span>
	<span id="perlFunc">push</span> <span id="var">@array</span>, <span id="braces">[</span><span id="perlFunc">splice</span><span id="braces">(</span><span id="var">@list</span>, 0, <span id="var">$matrix_width</span><span id="braces">)</span><span id="braces">]</span>;
    <span id="braces">}</span>
    <span id="perlKey">return</span>\@ array;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE8" id="CODE8"></a>_set_min_max_score</td><td >description</td><td ><a href="#CODE7">prev</a></td><td ><a href="#CODE9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_set_min_max_score</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$transpose</span> = <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">xchg</span><span id="braces">(</span>0,1<span id="braces">)</span>;
    <span id="var">$self</span>-&gt;<span id="braces">{</span>min_score<span id="braces">}</span> = <span id="method">sum</span><span id="braces">(</span>minimum <span id="var">$transpose</span><span id="braces">)</span>;
    <span id="var">$self</span>-&gt;<span id="braces">{</span>max_score<span id="braces">}</span> = <span id="method">sum</span><span id="braces">(</span>maximum <span id="var">$transpose</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE9" id="CODE9"></a>length</td><td ><a href="#POD2">description</a></td><td ><a href="#CODE8">prev</a></td><td ><a href="#CODE10">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">length</span>
{<pre>    <span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">shift</span>;
    <span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">getdim</span><span id="braces">(</span>0<span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE10" id="CODE10"></a>matrix</td><td ><a href="#POD3">description</a></td><td ><a href="#CODE9">prev</a></td><td ><a href="#CODE11">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">matrix</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$matrixdata</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="var">$self</span>-&gt;<span id="method">set_matrix</span><span id="braces">(</span><span id="var">$matrixdata</span><span id="braces">)</span> <span id="perlKey">if</span> <span id="var">$matrixdata</span>;
    <span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'matrix'</span><span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE11" id="CODE11"></a>new</td><td >description</td><td ><a href="#CODE10">prev</a></td><td ><a href="#CODE12">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">new</span>
{<pre>    <span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">shift</span>;
    <span id="perlKey">my</span> <span id="var">%args</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">bless</span> <span id="braces">{</span><span id="braces">}</span>, <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> || <span id="var">$class</span>;

    <span id="comment"># first figure out how it was called</span><br />    <span id="comment"># we need (-dbh and (-ID or -name) for fetching it from a database</span><br />    <span id="comment">#         or -matrix for direct matrix input</span><br />
    <span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-matrix'</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
        <span id="var">$self</span>-&gt;<span id="method">set_matrix</span><span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-matrix'</span><span id="braces">}</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-matrixstring'</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
        <span id="var">$self</span>-&gt;<span id="method">set_matrix</span><span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-matrixstring'</span><span id="braces">}</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$args</span><span id="braces">{</span>-matrixfile<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="var">$matrixstring</span>;
	<span id="perlFunc">open</span> <span id="braces">(</span>FILE,  <span id="var">$args</span><span id="braces">{</span>-matrixfile<span id="braces">}</span><span id="braces">)</span>
	    or <span id="var">$self</span>-&gt;<span id="method">throw</span><span id="braces">(</span><span id="dqStr">"Could not open <span id="var">$args</span>{-matrixfile}"</span><span id="braces">)</span>;
	<span id="braces">{</span>
	    <span id="perlKey">local</span> $/ = <span id="perlFunc">undef</span>;
	    <span id="var">$matrixstring</span> = &lt;FILE&gt;;
	<span id="braces">}</span>
	<span id="var">$self</span>-&gt;<span id="method">set_matrix</span><span id="braces">(</span><span id="var">$matrixstring</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">else</span>  <span id="braces">{</span>
	<span id="var">$self</span>-&gt;<span id="method">throw</span><span id="braces">(</span><span id="dqStr">"No matrix or db object provided."</span><span id="braces">)</span>;
    <span id="braces">}</span>

    <span id="comment"># Set the object data.</span><br />    <span id="comment"># Parameters specified in constructor call override those</span><br />    <span id="comment"># fetched from the database.</span><br />
    <span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'ID'</span><span id="braces">}</span>       = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-ID<span id="braces">}</span> or
			 <span id="var">$self</span>-&gt;<span id="braces">{</span>ID<span id="braces">}</span> or
			 <span id="dqStr">"Unknown"</span><span id="braces">)</span>;
    <span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'name'</span><span id="braces">}</span>     = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-name<span id="braces">}</span> or
			 <span id="var">$self</span>-&gt;<span id="braces">{</span>name<span id="braces">}</span> or
			 <span id="dqStr">"Unknown"</span><span id="braces">)</span>;
    <span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'class'</span><span id="braces">}</span> = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-class<span id="braces">}</span> or
			 <span id="var">$self</span>-&gt;<span id="braces">{</span>class<span id="braces">}</span> or
			 <span id="dqStr">"Unknown"</span><span id="braces">)</span>;
    <span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'strand'</span><span id="braces">}</span> = <span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-strand<span id="braces">}</span> or
			 <span id="var">$self</span>-&gt;<span id="braces">{</span>strand<span id="braces">}</span> or
			 <span id="dqStr">"+"</span><span id="braces">)</span>;
    <span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'bg_probabilities'</span><span id="braces">}</span> =
	<span id="braces">(</span><span id="var">$args</span><span id="braces">{</span><span id="sqStr">'-bg_probabilities'</span><span id="braces">}</span> || <span id="braces">{</span>A =&gt; 0.25,
					C =&gt; 0.25,
					G =&gt; 0.25,
					T =&gt; 0.25<span id="braces">}</span><span id="braces">)</span>;

    <span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'tags'</span><span id="braces">}</span> = <span id="var">$args</span><span id="braces">{</span>-tags<span id="braces">}</span> ? <span id="braces">(</span><span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$args</span><span id="braces">{</span>-tags<span id="braces">}</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="dqStr">"HASH"</span><span id="braces">)</span> ? <span id="var">$args</span><span id="braces">{</span>-tags<span id="braces">}</span> : <span id="braces">{</span><span id="braces">}</span> <span id="braces">)</span> :<span id="braces">{</span><span id="braces">}</span>;
    
    <span id="perlKey">return</span> <span id="var">$self</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE12" id="CODE12"></a>pdl_matrix</td><td ><a href="#POD4">description</a></td><td ><a href="#CODE11">prev</a></td><td ><a href="#CODE13">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">pdl_matrix</span>
{<pre>    pdl <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'matrix'</span><span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE13" id="CODE13"></a>prettyprint</td><td ><a href="#POD5">description</a></td><td ><a href="#CODE12">prev</a></td><td ><a href="#CODE14">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">prettyprint</span>
{<pre>    <span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">shift</span>;
    <span id="perlKey">my</span> <span id="var">$pwmstring</span> = <span id="perlFunc">sprintf</span> <span id="braces">(</span> <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span> <span id="braces">)</span>;
    <span id="var">$pwmstring</span> =~ <span id="regExp">s/\[|\]//g</span>;                <span id="comment"># lose []</span><br />    <span id="var">$pwmstring</span> =~ <span id="regExp">s/\n /\n/g</span>;                <span id="comment"># lose leading spaces</span><br />    <span id="perlKey">my</span> <span id="var">@pwmlines</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="dqStr">"\n"</span>, <span id="var">$pwmstring</span><span id="braces">)</span>; <span id="comment">#</span><br />    <span id="var">@pwmlines</span> = <span id="braces">(</span><span id="dqStr">"A  [<span id="var">$pwmlines</span>[2] ]"</span>,
		 <span id="dqStr">"C  [<span id="var">$pwmlines</span>[3] ]"</span>,
		 <span id="dqStr">"G  [<span id="var">$pwmlines</span>[4] ]"</span>,
		 <span id="dqStr">"T  [<span id="var">$pwmlines</span>[5] ]"</span><span id="braces">)</span>;
    <span id="var">$pwmstring</span> = <span id="perlFunc">join</span> <span id="braces">(</span><span id="dqStr">"\n"</span>, <span id="var">@pwmlines</span><span id="braces">)</span>.<span id="dqStr">"\n"</span>;
    <span id="perlKey">return</span> <span id="var">$pwmstring</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE14" id="CODE14"></a>randomize_columns</td><td ><a href="#POD6">description</a></td><td ><a href="#CODE13">prev</a></td><td ><a href="#CODE15">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">randomize_columns</span>
{<pre>    <span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">shift</span>;
    <span id="perlKey">my</span> <span id="var">$matrix</span> = <span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'matrix'</span><span id="braces">}</span>;
    <span id="perlKey">my</span> <span id="var">$i</span> = 0;

    <span id="comment"># Schwartzian Transform to get random permutation</span><br />    <span id="perlFunc">map</span> <span id="braces">{</span> <span id="braces">(</span> <span id="perlFunc">undef</span>, $$matrix<span id="braces">[</span>0<span id="braces">]</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>, $$matrix<span id="braces">[</span>1<span id="braces">]</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>, $$matrix<span id="braces">[</span>2<span id="braces">]</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>,  $$matrix<span id="braces">[</span>3<span id="braces">]</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span> <span id="braces">)</span> = @$_; <span id="var">$i</span>++; <span id="braces">}</span> 
    <span id="perlFunc">sort</span> <span id="braces">{</span> <span id="var">$a</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span> &lt;=&gt; <span id="var">$b</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span> <span id="braces">}</span> 
    <span id="perlFunc">map</span> <span id="braces">{</span> <span id="braces">[</span> <span id="perlFunc">rand</span><span id="braces">(</span><span id="braces">)</span>, $$matrix<span id="braces">[</span>0<span id="braces">]</span><span id="braces">[</span><span id="var">$_</span><span id="braces">]</span>, $$matrix<span id="braces">[</span>1<span id="braces">]</span><span id="braces">[</span><span id="var">$_</span><span id="braces">]</span>, $$matrix<span id="braces">[</span>2<span id="braces">]</span><span id="braces">[</span><span id="var">$_</span><span id="braces">]</span>, $$matrix<span id="braces">[</span>3<span id="braces">]</span><span id="braces">[</span><span id="var">$_</span><span id="braces">]</span> <span id="braces">]</span> <span id="braces">}</span> <span id="braces">(</span> 0 .. <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="perlFunc">length</span><span id="braces">(</span><span id="braces">)</span>-1<span id="braces">)</span> <span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE15" id="CODE15"></a>rawprint</td><td ><a href="#POD7">description</a></td><td ><a href="#CODE14">prev</a></td><td ><a href="#CODE16">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">rawprint</span>
{<pre>    <span id="perlKey">my</span> <span id="var">$self</span> = <span id="perlFunc">shift</span>;
    <span id="perlKey">my</span> <span id="var">$pwmstring</span> = <span id="perlFunc">sprintf</span> <span id="braces">(</span> <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span> <span id="braces">)</span>;
    <span id="var">$pwmstring</span> =~ <span id="regExp">s/\[|\]//g</span>;                <span id="comment"># lose []</span><br />    <span id="var">$pwmstring</span> =~ <span id="regExp">s/\n /\n/g</span>;                <span id="comment"># lose leading spaces</span><br />    <span id="perlKey">my</span> <span id="var">@pwmlines</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="dqStr">"\n"</span>, <span id="var">$pwmstring</span><span id="braces">)</span>; <span id="comment"># f</span><br />    <span id="var">$pwmstring</span> = <span id="perlFunc">join</span> <span id="braces">(</span><span id="dqStr">"\n"</span>, <span id="var">@pwmlines</span><span id="braces">[</span>2..5<span id="braces">]</span><span id="braces">)</span>.<span id="dqStr">"\n"</span>;
    <span id="perlKey">return</span> <span id="var">$pwmstring</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE16" id="CODE16"></a>revcom</td><td ><a href="#POD8">description</a></td><td ><a href="#CODE15">prev</a></td><td ><a href="#CODE17">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">revcom</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="var">$revcom_matrix</span> =
	<span id="var">$self</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span>-matrix =&gt; <span id="var">$self</span>-&gt;<span id="method">pdl_matrix</span>-&gt;<span id="method">slice</span><span id="braces">(</span><span id="sqStr">'-1:0,-1:0'</span><span id="braces">)</span>,
		   <span id="comment"># the above line rotates the original matrix 180 deg,</span><br />		   -ID       =&gt; <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="braces">{</span>ID<span id="braces">}</span> or <span id="dqStr">""</span><span id="braces">)</span>,
		   -name     =&gt; <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="braces">{</span>name<span id="braces">}</span> or <span id="dqStr">""</span><span id="braces">)</span>,
		   -class =&gt; <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="braces">{</span>class<span id="braces">}</span> or <span id="dqStr">""</span><span id="braces">)</span>,
		   -strand   =&gt; <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="braces">{</span>strand<span id="braces">}</span> and <span id="var">$self</span>-&gt;<span id="braces">{</span>strand<span id="braces">}</span> <span id="perlKey">eq</span> <span id="dqStr">"-"</span><span id="braces">)</span> ? <span id="dqStr">"+"</span> : <span id="dqStr">"-"</span>,
		   -tags     =&gt; <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="braces">{</span>tags<span id="braces">}</span> or <span id="braces">{</span><span id="braces">}</span><span id="braces">)</span>  <span id="braces">)</span>;
    <span id="perlKey">return</span> <span id="var">$revcom_matrix</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE17" id="CODE17"></a>set_matrix</td><td >description</td><td ><a href="#CODE16">prev</a></td><td >next</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_matrix</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$matrixdata</span><span id="braces">)</span> = <span id="var">@_</span>;

    <span id="comment"># The input matrix (specified as -array=&gt; in the constructir call</span><br />    <span id="comment"># can either be</span><br />    <span id="comment">#      * a 2D regular perl array with 4 rows,</span><br />    <span id="comment">#      * a piddle (FIXME - check for 4 rows), or</span><br />    <span id="comment">#      * a four-line string of numbers</span><br />
    <span id="comment"># print STDERR &quot;MATRIX&gt;&gt;&gt;&quot;.$matrixdata;</span><br />    <span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$matrixdata</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="dqStr">"ARRAY"</span>
	and <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$matrixdata</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="dqStr">"ARRAY"</span>
	and <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$matrixdata</span><span id="braces">}</span><span id="braces">)</span> == 4<span id="braces">)</span>
    <span id="braces">{</span>
        <span id="comment"># it is a perl array</span><br />	<span id="var">$self</span>-&gt;<span id="braces">{</span><span id="sqStr">'matrix'</span><span id="braces">}</span> = <span id="var">$matrixdata</span>;
    <span id="braces">}</span>
    <span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$matrixdata</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="dqStr">"PDL"</span><span id="braces">)</span>
    <span id="braces">{</span>
        <span id="comment"># it's a piddle</span><br />	<span id="var">$self</span>-&gt;<span id="braces">{</span>matrix<span id="braces">}</span> = <span id="method">_pdl_to_matrixref</span><span id="braces">(</span><span id="var">$matrixdata</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">elsif</span> <span id="braces">(</span>!<span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$matrixdata</span><span id="braces">)</span><span id="braces">)</span>
	   <span id="comment">#and (scalar split &quot;\n&quot;,$matrixdata) == 4)</span><br />    <span id="braces">{</span>
	<span id="comment"># it's a string then, but what string?</span><br />	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$matrixdata</span> =~ <span id="regExp">/^DE/</span><span id="braces">)</span> <span id="braces">{</span>  
	    <span id="comment"># STAMP string</span><br />	    <span id="var">$self</span>-&gt;<span id="braces">{</span>matrix<span id="braces">}</span> = <span id="var">$self</span>-&gt;<span id="method">_matrix_from_STAMP_string</span><span id="braces">(</span><span id="var">$matrixdata</span><span id="braces">)</span>;
	<span id="braces">}</span> <span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$matrixdata</span> =~ <span id="regExp">/[ACGTURYMKWSBDHVNacgturymkwsbdhvn]{3,}/</span><span id="braces">)</span> <span id="braces">{</span>
	    <span id="var">$self</span>-&gt;<span id="braces">{</span>matrix<span id="braces">}</span> = <span id="var">$self</span>-&gt;<span id="method">_matrix_from_IUPAC_string</span><span id="braces">(</span><span id="var">$matrixdata</span><span id="braces">)</span>;
	<span id="braces">}</span> <span id="perlKey">else</span> <span id="braces">{</span>
	    <span id="comment"># Regular string</span><br />	    <span id="var">$self</span>-&gt;<span id="braces">{</span>matrix<span id="braces">}</span> = <span id="var">$self</span>-&gt;<span id="method">_matrix_from_string</span><span id="braces">(</span><span id="var">$matrixdata</span><span id="braces">)</span>;
	<span id="braces">}</span>
    <span id="braces">}</span>
    <span id="perlKey">else</span>  <span id="braces">{</span>
	<span id="var">$self</span>-&gt;<span id="method">throw</span><span id="braces">(</span><span id="dqStr">"Wrong data type/format for -matrix.\n"</span>.
		      <span id="dqStr">"Acceptable formats are Array of Arrays (4 rows),\n"</span>.
		      <span id="dqStr">"PDL Array, (4 rows),\n"</span>.
		      <span id="dqStr">"or plain string (4 lines)."</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="comment"># $self-&gt;_set_min_max_score();</span><br />
   <span id="comment"># print STDERR $self-&gt;prettyprint();</span><br />
    <span id="perlKey">return</span> 1;</pre>}</td></div>
<div id="sep"></div>
<a name="General" id="General"></a>
<div id="mainTitle">General documentation</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_FEEDBACK" id="_pod_FEEDBACK"></a>FEEDBACK</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">Please send bug reports and other comments to the author.</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_AUTHOR - Boris Lenhard" id="_pod_AUTHOR - Boris Lenhard"></a>AUTHOR - Boris Lenhard</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">Boris Lenhard &lt;Boris.Lenhard@cgb.ki.se&gt;<br />Modified by Eivind Valen <a href="mailto:eivind.valen@gmail.com" id="podEmail">eivind.valen@gmail.com</a></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_APPENDIX" id="_pod_APPENDIX"></a>APPENDIX</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">The rest of the documentation details each of the object<br />methods. Internal methods are preceded with an underscore.</div>
<div id="sep"></div>
</body>
</html>
